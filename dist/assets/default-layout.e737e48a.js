var Rs=Object.defineProperty;var Ns=(e,t,o)=>t in e?Rs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var J=(e,t,o)=>(Ns(e,typeof t!="symbol"?t+"":t,o),o);import{u as Xe,j as wo,E as c,P as ee,k as D,A as St,L as T,l as Ls,T as Ps,m as Us,K as Ds,U as xs,n as js,G as Bs,C as Z,M as Le,o as Gs,p as Fs,q as ve,r as Vs,t as Hs,w as Ws,x as qs,y as zs,H as jn,z as ye,B as Bn,D as Gn,F as Fn,I as Vn,J as Hn,N as Ks,O as Js,Q as je,v as Ee,i as Ue,R as Eo,_ as le,d as xt,S as So,V as Qs,e as Ot,W as Zs,X as Ys,Y as Xs,Z as ea,$ as ta,a0 as na,a1 as oa,a2 as jt,a3 as sa,a4 as aa,a5 as ra,a6 as ia,a7 as ca,a8 as la,a9 as ua,aa as da,ab as Mo,ac as $o,f as fa,ad as pa,ae as ha,g as Mt,af as ma,ag as ga,ah as va,ai as Pe,aj as _a,ak as G,al as lt,am as $t,a as Wn,b as qn,c as zn,an as Kn,ao as Jn,ap as ba}from"./index.dbbac9d8.js";/* empty css              */import{C as E,D as z,E as i,H as Ca,c as V,d as ie,j as N,aI as p,bm as ya,bn as Ao,h as Ia,bo as Ta,bp as wa,bq as Ea,b as dt,u as M,aN as $,aH as _,aM as ae,aW as H,bj as Sa,bc as Ma,bd as $a,aX as De,i as Aa,w as ko,aE as F,aF as Q,aK as Ke,aJ as Rt,F as Bt,Q as ka,b8 as Oo,b9 as Ro,br as No,bs as Lo,bt as Oa,bu as Ra,be as Po,a$ as Gt,b0 as Ft,b2 as Uo,b3 as Do,a0 as Na,bv as La,b4 as Pa,a2 as Ua,bw as Da,bx as xa,o as et,by as ja,bh as Ba,bz as Je,bA as Ga,bB as Fa,p as Va,G as Qn,bC as Ie,bD as Ha,aZ as Wa,bE as qa,bF as za}from"./arco.638965b6.js";import{f as tt,g as xo,i as Ka}from"./vue.125da600.js";import{i as nt,b as ot,r as ue,a as st,f as Ja,S as Zn,c as Qa,o as Za,d as Ya,e as jo,g as Xa,h as Yn}from"./icon_volume_1.148c46df.js";import{l as er,j as tr}from"./html2canvas.esm.2ee9110f.js";import{l as nr}from"./logo.fa0f260a.js";import{c as Bo}from"./icon_close.f7fee805.js";import"./chart.ffc0c533.js";function Go(){const e=tt(),t=Xe();return{logout:async s=>{await t.logout();const a=e.currentRoute.value;wo(),e.push({name:s&&typeof s=="string"?s:"login",query:{...e.currentRoute.value.query,redirect:a.name}}),window.location.reload()}}}const or={width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},sr=i("rect",{width:"56",height:"56",rx:"8",fill:"#0267FF"},null,-1),ar=i("path",{d:"m28.065 31.061-2.238 1.965a1.48 1.48 0 0 1-.121 2.102l-5.597 4.91a1.509 1.509 0 0 1-2.117-.136l-3.994-4.478a1.48 1.48 0 0 1 .12-2.102l5.597-4.91a1.51 1.51 0 0 1 2.118.136l2.239-1.964-.999-1.12c-1.103-1.236-2.999-1.36-4.235-.274l-7.835 6.876a2.96 2.96 0 0 0-.242 4.203l5.99 6.717c1.104 1.236 3 1.36 4.236.274l7.835-6.876a2.96 2.96 0 0 0 .242-4.203l-.999-1.12Zm17.719-5.69-3.344-8.368c-.615-1.54-2.355-2.306-3.887-1.71l-9.704 3.774c-1.53.596-2.273 2.327-1.658 3.867l.557 1.395 2.773-1.079a1.478 1.478 0 0 1 .83-1.933l6.93-2.696a1.511 1.511 0 0 1 1.944.855l2.229 5.579a1.477 1.477 0 0 1-.83 1.933l-6.93 2.696a1.511 1.511 0 0 1-1.944-.855l-2.773 1.078.558 1.395c.615 1.54 2.355 2.306 3.886 1.71l9.705-3.774c1.53-.596 2.273-2.327 1.658-3.867ZM21.59 32.75c.552.619 1.5.68 2.118.138l3.398-2.982-2.031-2.21-3.364 2.953a1.48 1.48 0 0 0-.12 2.102Zm11.988-5.856a1.478 1.478 0 0 0 .83-1.933 1.511 1.511 0 0 0-1.944-.856l-4.126 1.605 1.035 2.82 4.205-1.636Zm-5.287-14.252L27.012 12l-1.755 4.747 1.28.642 1.755-4.746Zm-7.508 9.286-.293-1.498-6.337 1.227.291 1.499 6.34-1.228Zm2.015-4.074-2.662-5.037-1.305.814 2.661 5.037 1.306-.814Z",fill:"#fff"},null,-1),rr=[sr,ar];function ir(e,t){return E(),z("svg",or,[...rr])}const cr={render:ir},lr={width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ur=Ca('<rect width="56" height="56" rx="8" fill="#FF3939"></rect><g fill="#fff"><path d="M28 10c9.941 0 18 8.059 18 18s-8.059 18-18 18-18-8.059-18-18 8.059-18 18-18Zm0 2.667c-8.468 0-15.333 6.865-15.333 15.333S19.532 43.333 28 43.333 43.333 36.468 43.333 28 36.468 12.667 28 12.667Z"></path><path d="M36.6 19.276c.629.629.629 1.257 0 1.886L21.162 36.6c-.629.629-1.257.629-1.886 0-.628-.628-.628-1.257 0-1.885l15.439-15.439c.628-.628 1.257-.628 1.885 0Z"></path><path d="M19.276 19.276c.629-.628 1.257-.628 1.886 0L36.6 34.715c.629.628.629 1.257 0 1.885-.628.629-1.257.629-1.885 0L19.276 21.162c-.628-.629-.628-1.257 0-1.886Z"></path></g>',2),dr=[ur];function fr(e,t){return E(),z("svg",lr,[...dr])}const pr={render:fr},hr={height:"56",viewBox:"0 0 56 56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},mr=i("circle",{cx:"28",cy:"28",r:"28",fill:"#FF1500"},null,-1),gr=i("path",{d:"M25.607 34a2.432 2.432 0 0 0 4.79 0l1.596-22a4.012 4.012 0 0 0-1.171-2.826A3.996 3.996 0 0 0 28.002 8a4.095 4.095 0 0 0-2.935 1.345A4.112 4.112 0 0 0 24.01 12.4L25.607 34Zm2.395 6a3.986 3.986 0 0 0-3.688 2.47 4.008 4.008 0 0 0 .865 4.358A3.988 3.988 0 0 0 31.993 44a3.786 3.786 0 0 0-1.098-2.9 3.77 3.77 0 0 0-2.893-1.1Z",fill:"#fff"},null,-1),vr=[mr,gr];function _r(e,t){return E(),z("svg",hr,[...vr])}const br={render:_r};class Cr{constructor(t){J(this,"websocket",null);J(this,"reconnectTimeout");J(this,"retryCount",0);J(this,"maxRetries",30);J(this,"initialReconnectDelay",3e3);J(this,"maxReconnectDelay",6e4);J(this,"wsUrl");J(this,"isConnected",!1);J(this,"isReConnect",!0);this.wsUrl=t,this.connect()}connect(){this.websocket||(console.log("222222222wsUrl>>>>",this.wsUrl),this.websocket=new WebSocket(this.wsUrl),this.websocket.binaryType="arraybuffer",this.websocket.addEventListener("open",this.onOpen.bind(this)),this.websocket.addEventListener("message",this.onMessage.bind(this)),this.websocket.addEventListener("close",this.onClose.bind(this)),this.websocket.addEventListener("error",this.onError.bind(this)))}onOpen(){console.log("\u5373\u65F6\u901A\u8BAF-WebSocket-websocketService connection open"),this.isConnected=!0,this.retryCount=0,this.clearReconnectTimeout(),c.emit("im-ws-open")}onMessage(t){const o=new Uint8Array(t.data);c.emit("im-ws-message",{data:o,_self:this})}onClose(t){console.log(`IM-Connection closed with code: ${t.code}`),this.isReConnect&&this.reconnect()}onError(t){console.error("IM-WebSocket error",t),c.emit("im-ws-error",{error:t,event:this})}reconnect(){if(!this.isReConnect){console.log("Max retries reached or reconnection is disabled.");return}if(console.log(`IM WebSocket reconnecting in ${this.initialReconnectDelay} ms... \u91CD\u8BD5\u6B21\u6570\uFF1A`,this.retryCount),this.retryCount>this.maxRetries){this.stopReconnect(),c.emit("im-ws-reconnect-failed");return}this.websocket=null,c.emit("im-ws-reconnect-start",{retryCount:this.retryCount}),this.reconnectTimeout=window.setTimeout(()=>{this.retryCount+=1,this.connect()},this.initialReconnectDelay)}stopReconnect(){console.log("IM WebSocket stop reconnect"),this.isReConnect=!1,this.retryCount=0,this.clearReconnectTimeout()}clearReconnectTimeout(){this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0)}sendMessage(t){this.websocket&&this.isConnected?this.websocket.send(t):console.warn("WebSocket is not connected. Message not sent.",t)}close(){console.log("IM WebSocket close"),this.stopReconnect(),this.websocket&&(this.websocket.close(),this.websocket=null)}}const yr=e=>new Cr(e);class Ir{constructor(t){J(this,"webSocketService",null);J(this,"wssUrl");J(this,"userId");J(this,"token");J(this,"intervalHeart",null);J(this,"lastLoginTime");J(this,"messageMap",new Map);const{wssUrl:o,userId:s,token:a}=t;this.wssUrl=o,this.userId=s,this.token=a,this.handleChatWsOpen=this.handleChatWsOpen.bind(this),this.handleChatWsMessage=this.handleChatWsMessage.bind(this),this.handleChatWsClose=this.handleChatWsClose.bind(this),this.handleChatWsError=this.handleChatWsError.bind(this)}handleChatWsOpen(){c.emit("ChatWsOpen","Chat WebSocket connection opened")}handleChatWsMessage(t){const{data:o}=t;console.log("chat-message--handleChatWsMessage",o);const s=ee.decode(o);if(D.ACK===s.type){const a=St.decode(s.event),l=this.messageMap.get(a.fp);console.log("ChatPB.EventType.ACK",l),l&&(this.messageMap.delete(a.fp),c.emit("ChatMessageStatus",{fp:a.fp,status:!0}))}if(D.ACK!==s.type&&D.HEARTBEAT_PONG!==s.type&&this.sendAckMessage({fp:s.fp,timestamp:T.fromValue(s.timestamp).toNumber()}),D.LOGIN_SUCCEED===s.type){const a=Ls.decode(s.event);this.lastLoginTime=T.fromValue(a.lastLoginTime).toNumber(),console.log("\u5373\u65F6\u901A\u8BAF-websocket-\u767B\u5F55\u6210\u529F-\u670D\u52A1\u7AEF\u8FD4\u56DE\u503C",{...a,lastLoginTime:T.fromValue(a.lastLoginTime).toNumber()}),c.emit("ChatLoginSuccess",{...a,lastLoginTime:T.fromValue(a.lastLoginTime).toNumber()}),this.heartInterval()}if(D.TOKEN_EXPIRATION_DATE===s.type){const a=Ps.decode(s.event);console.log("\u63A5\u6536\u5230Token\u4E8B\u4EF6-TOKEN_EXPIRATION_DATE",a),c.emit("ChatTokenExpirationDate",a)}if(D.LOGOUT_SUCCEED===s.type){const a=Us.decode(s.event);console.log("\u63A5\u6536\u5230\u767B\u51FA\u6210\u529F\u4E8B\u4EF6-LOGOUT_SUCCEED",a),c.emit("ChatLogoutSucceed",a)}if(D.KICK_OUT===s.type){const a=Ds.decode(s.event);console.log("\u8E22\u4E0B\u7EBF\u4E8B\u4EF6-KICK_OUT",a),c.emit("ChatKickOut",a)}if(D.CONTACT_UPDATED===s.type&&(console.log("\u901A\u8BAF\u5F55\u53D1\u751F\u53D8\u5316-CONTACT_UPDATED",s),c.emit("ChatContactUpdated")),D.CHAT_USER_ONLINE===s.type){const a=xs.decode(s.event);c.emit("ChatUserOnline",{client:a.client,userId:T.fromValue(a.userId).toNumber()})}if(D.CHAT_USER_OFFLINE===s.type){const a=js.decode(s.event);console.log("\u7528\u6237\u4E0B\u7EBF-CHAT_USER_OFFLINE",a,{client:a.client,userId:T.fromValue(a.userId).toNumber()}),c.emit("ChatUserOffline",{client:a.client,userId:T.fromValue(a.userId).toNumber()})}if(D.CHAT_GROUP_CREATED===s.type){const a=Bs.decode(s.event);console.log("\u7FA4\u7EC4\u521B\u5EFA\u4E8B\u4EF6-CHAT_GROUP_CREATED-dataContent",a);const l=[];a.userIds.forEach(m=>{l.push(T.fromValue(m).toNumber())});const d={eventType:s.type,eventData:{...a,groupId:T.fromValue(a.groupId).toNumber(),masterId:T.fromValue(a.masterId).toNumber(),timestamp:T.fromValue(a.timestamp).toNumber(),userIds:l}};c.emit("GroupCreatedEvent",{fp:s.fp,targetId:T.fromValue(a.groupId).toNumber(),chatType:Z.GROUP_CHAT,targetAvatarUrl:a.avatarUrl,targetName:a.groupName,name:"",messageType:Le.SYSTEM,content:JSON.stringify(d),sendTime:T.fromValue(a.timestamp).toNumber(),unreadCount:0})}if(D.CHAT_GROUP_INFO_UPDATED===s.type){const a=Gs.decode(s.event);console.log("\u7FA4\u7EC4\u4FE1\u606F\u66F4\u65B0\u4E8B\u4EF6-CHAT_GROUP_INFO_UPDATED",a),c.emit("GroupChatGroupInfoUpdated",{...a,groupId:T.fromValue(a.groupId).toNumber()})}if(D.CHAT_GROUP_MEMBER_REMOVED===s.type){const a=Fs.decode(s.event);console.log("\u7FA4\u7EC4\u6210\u5458\u8E22\u51FA\u4E8B\u4EF6-CHAT_GROUP_MEMBER_REMOVED-dataContent",a);const l=[];a.removedUserIds.forEach(m=>{l.push(T.fromValue(m).toNumber())});const d={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),masterId:T.fromValue(a.masterId).toNumber(),removedUserIds:l}};c.emit("ChatGroupMemberRemoved",{fingerPrint:s.fp,chatType:Z.GROUP_CHAT,content:JSON.stringify(d),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${Z.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(D.CHAT_GROUP_MEMBER_INVITED===s.type){const a=Vs.decode(s.event);console.log("\u7FA4\u7EC4\u9080\u8BF7\u6210\u5458\u4E8B\u4EF6-CHAT_GROUP_MEMBER_INVITED",a);const l=[];a.invitedUserIds.forEach(m=>{l.push(T.fromValue(m).toNumber())});const d={eventType:s.type,eventData:{...a,timestamp:T.fromValue(a.timestamp).toNumber,groupId:T.fromValue(a.groupId).toNumber(),groupName:a.groupName,inviteeUserIds:l,invitorUserId:T.fromValue(a.invitorUserId).toNumber()}};c.emit("ChatGroupMemberInvited",{fingerPrint:s.fp,chatType:Z.GROUP_CHAT,content:JSON.stringify(d),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${Z.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(D.CHAT_GROUP_MASTER_CHANGED===s.type){const a=Hs.decode(s.event);console.log("\u7FA4\u4E3B\u53D8\u66F4\u4E8B\u4EF6-CHAT_GROUP_MASTER_CHANGED",a);const l={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),newMasterId:T.fromValue(a.newMasterId).toNumber(),oldMasterId:T.fromValue(a.oldMasterId).toNumber()}};c.emit("ChatGroupMasterChanged",{fingerPrint:s.fp,chatType:Z.GROUP_CHAT,content:JSON.stringify(l),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${Z.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(D.CHAT_GROUP_DISBANDED===s.type){const a=Ws.decode(s.event);console.log("\u7FA4\u89E3\u6563\u4E8B\u4EF6-CHAT_GROUP_DISBANDED",a);const l={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),masterId:T.fromValue(a.masterId).toNumber(),timestamp:T.fromValue(a.timestamp).toNumber()}};c.emit("ChatGroupDisbanded",{fingerPrint:s.fp,chatType:Z.GROUP_CHAT,content:JSON.stringify(l),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${Z.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(D.CHAT_GROUP_MEMBER_QUIT===s.type){const a=qs.decode(s.event);console.log("\u7FA4\u7EC4\u4EBA\u5458\u9000\u51FA-CHAT_GROUP_MEMBER_QUIT-dataContent",a);const l={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),quitUserId:T.fromValue(a.quitUserId).toNumber(),timestamp:T.fromValue(a.timestamp).toNumber()}};c.emit("ChatGroupMemberQuit",{fingerPrint:s.fp,chatType:Z.GROUP_CHAT,content:JSON.stringify(l),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${Z.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(D.CHAT_MESSAGE_RECEIVED===s.type){const a=zs.decode(s.event);console.log("\u6D88\u606F\u63A5\u6536\u4E8B\u4EF6-CHAT_MESSAGE_RECEIVED",a),this.sendAckMessage({fp:s.fp,timestamp:T.fromValue(a.timestamp).toNumber()}),c.emit("ChatMessageReceive",{fingerPrint:s.fp,chatType:a.chatType,content:a.content,messageType:a.messageType,recipientId:T.fromValue(a.recipientId).toNumber(),senderId:T.fromValue(a.senderId).toNumber(),sendTime:T.fromValue(a.timestamp).toNumber()})}}handleChatWsError(t){this.clearHeartInterval(),c.emit("ChatWsError",t)}handleChatWsClose(t){console.log("ChatWebSocket \u8FDE\u63A5\u5DF2\u5173\u95ED",t,this),this.clearHeartInterval(),c.emit("ChatWsClose","Chat WebSocket connection closed")}clearHeartInterval(){this.intervalHeart&&clearInterval(this.intervalHeart)}heartInterval(){this.intervalHeart=setInterval(()=>{if(!this.webSocketService){this.clearHeartInterval();return}const t=Date.now(),o=jn.create(),s=jn.encode(o).finish(),a=ee.create({type:D.HEARTBEAT_PING,fp:ye(),event:s,timestamp:t}),l=ee.encode(a).finish();this.webSocketService.sendMessage(l)},1e3*30)}login(){var d;let t;this.lastLoginTime?t=this.lastLoginTime:t=Date.now(),console.log("Chat-login----lastLoginTime",this.lastLoginTime);const o=Bn.create({userId:this.userId,client:ve.PC,token:this.token,lastLoginTime:t}),s=Bn.encode(o).finish(),a=ee.create({type:D.LOGIN_REQUEST,fp:ye(),event:s,timestamp:t}),l=ee.encode(a).finish();(d=this.webSocketService)==null||d.sendMessage(l)}refreshToken(t){console.log("Chat-refresh-token",t);const o=Date.now(),s=Gn.create({token:t.token}),a=Gn.encode(s).finish(),l=ee.create({type:D.TOKEN_REFRESH,fp:ye(),event:a,timestamp:o}),d=ee.encode(l).finish();this.webSocketService.sendMessage(d)}sendLogoutMessage(){const t=Date.now(),o=Fn.create(),s=Fn.encode(o).finish(),a=ee.create({type:D.LOGOUT_REQUEST,fp:ye(),event:s,timestamp:t}),l=ee.encode(a).finish();this.webSocketService.sendMessage(l)}logout(){this.webSocketService&&(this.clearHeartInterval(),this.handleOffEventBus(),this.sendLogoutMessage(),this.webSocketService.close())}handleOnEventBus(){c.on("im-ws-open",this.handleChatWsOpen),c.on("im-ws-message",this.handleChatWsMessage),c.on("im-ws-close",this.handleChatWsClose),c.on("im-ws-error",this.handleChatWsError)}handleOffEventBus(){c.off("im-ws-open",this.handleChatWsOpen),c.off("im-ws-message",this.handleChatWsMessage),c.off("im-ws-close",this.handleChatWsClose),c.off("im-ws-error",this.handleChatWsError)}initChatWss(){this.webSocketService=yr(this.wssUrl),this.webSocketService.connect(),this.handleOnEventBus()}chatWssReconnect(){this.webSocketService&&(this.webSocketService.stopReconnect(),this.initChatWss())}sendMessage(t){var g;const{fingerPrint:o,recipientId:s,chatType:a,messageType:l,content:d}=t,m=Date.now(),w=o||ye(),b=Vn.create({recipientId:s,chatType:a,messageType:l,content:d}),C=Vn.encode(b).finish(),S=ee.create({type:D.CHAT_MESSAGE_SEND,fp:w,event:C,timestamp:m}),O=ee.encode(S).finish();this.messageMap.set(w,{timestamp:m,retries:0,data:O}),(g=this.webSocketService)==null||g.sendMessage(O),this.retryMessage(w)}retryMessage(t){!this.messageMap.get(t)||setTimeout(()=>{const s=this.messageMap.get(t);if(!!s){if(s.retries>=3){this.messageMap.delete(t),c.emit("ChatMessageStatus",{fp:t,status:!1});return}console.log(`\u6B63\u5728\u91CD\u8BD5\u6D88\u606F ${t}, \u5C1D\u8BD5\u6B21\u6570 ${s.retries+1}`),this.webSocketService.sendMessage(s.data),this.messageMap.set(t,{...s,retries:s.retries+1}),this.retryMessage(t)}},3e3)}sendAckMessage(t){var m;const o=Date.now(),s=St.create(t),a=St.encode(s).finish(),l=ee.create({type:D.ACK,fp:ye(),event:a,timestamp:o}),d=ee.encode(l).finish();(m=this.webSocketService)==null||m.sendMessage(d)}sendChatReceivedMessageReadEvent(t){var m;const o=Date.now(),s=Hn.create(t),a=Hn.encode(s).finish(),l=ee.create({type:D.CHAT_MESSAGE_READ,fp:ye(),event:a,timestamp:o}),d=ee.encode(l).finish();(m=this.webSocketService)==null||m.sendMessage(d)}}function Tr(){return{accessRouter(e){var t,o,s,a;return!((t=e.meta)!=null&&t.requiresAuth)||!((o=e.meta)!=null&&o.roles)||((a=(s=e.meta)==null?void 0:s.roles)==null?void 0:a.includes("*"))},findFirstPermissionRoute(e,t="admin"){var s,a;const o=[...e];for(;o.length;){const l=o.shift();if((a=(s=l==null?void 0:l.meta)==null?void 0:s.roles)!=null&&a.find(d=>d.includes("*")||d.includes(t)))return{name:l.name};l!=null&&l.children&&o.push(...l.children)}return null}}}const wr=[...Ks,...Js],Er=wr.map(e=>{const{name:t,path:o,meta:s,redirect:a,children:l}=e;return{name:t,path:o,meta:s,redirect:a,children:l}}),Sr=Er;var Mr=Array.isArray;const Vt=Mr;var $r="[object AsyncFunction]",Ar="[object Function]",kr="[object GeneratorFunction]",Or="[object Proxy]";function Fo(e){if(!nt(e))return!1;var t=ot(e);return t==Ar||t==kr||t==$r||t==Or}var Rr=ue["__core-js_shared__"];const At=Rr;var Xn=function(){var e=/[^.]+$/.exec(At&&At.keys&&At.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Nr(e){return!!Xn&&Xn in e}var Lr=Function.prototype,Pr=Lr.toString;function Se(e){if(e!=null){try{return Pr.call(e)}catch{}try{return e+""}catch{}}return""}var Ur=/[\\^$.*+?()[\]{}|]/g,Dr=/^\[object .+?Constructor\]$/,xr=Function.prototype,jr=Object.prototype,Br=xr.toString,Gr=jr.hasOwnProperty,Fr=RegExp("^"+Br.call(Gr).replace(Ur,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Vr(e){if(!nt(e)||Nr(e))return!1;var t=Fo(e)?Fr:Dr;return t.test(Se(e))}function Hr(e,t){return e==null?void 0:e[t]}function Me(e,t){var o=Hr(e,t);return Vr(o)?o:void 0}var Wr=Me(ue,"WeakMap");const Nt=Wr;var eo=Object.create,qr=function(){function e(){}return function(t){if(!nt(t))return{};if(eo)return eo(t);e.prototype=t;var o=new e;return e.prototype=void 0,o}}();const zr=qr;function Kr(e,t){var o=-1,s=e.length;for(t||(t=Array(s));++o<s;)t[o]=e[o];return t}var Jr=function(){try{var e=Me(Object,"defineProperty");return e({},"",{}),e}catch{}}();const to=Jr;function Qr(e,t){for(var o=-1,s=e==null?0:e.length;++o<s&&t(e[o],o,e)!==!1;);return e}var Zr=9007199254740991,Yr=/^(?:0|[1-9]\d*)$/;function Xr(e,t){var o=typeof e;return t=t==null?Zr:t,!!t&&(o=="number"||o!="symbol"&&Yr.test(e))&&e>-1&&e%1==0&&e<t}function Vo(e,t,o){t=="__proto__"&&to?to(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}function Ho(e,t){return e===t||e!==e&&t!==t}var ei=Object.prototype,ti=ei.hasOwnProperty;function Wo(e,t,o){var s=e[t];(!(ti.call(e,t)&&Ho(s,o))||o===void 0&&!(t in e))&&Vo(e,t,o)}function ft(e,t,o,s){var a=!o;o||(o={});for(var l=-1,d=t.length;++l<d;){var m=t[l],w=s?s(o[m],e[m],m,o,e):void 0;w===void 0&&(w=e[m]),a?Vo(o,m,w):Wo(o,m,w)}return o}var ni=9007199254740991;function qo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=ni}function zo(e){return e!=null&&qo(e.length)&&!Fo(e)}var oi=Object.prototype;function Ht(e){var t=e&&e.constructor,o=typeof t=="function"&&t.prototype||oi;return e===o}function si(e,t){for(var o=-1,s=Array(e);++o<e;)s[o]=t(o);return s}var ai="[object Arguments]";function no(e){return st(e)&&ot(e)==ai}var Ko=Object.prototype,ri=Ko.hasOwnProperty,ii=Ko.propertyIsEnumerable,ci=no(function(){return arguments}())?no:function(e){return st(e)&&ri.call(e,"callee")&&!ii.call(e,"callee")};const li=ci;function ui(){return!1}var Jo=typeof exports=="object"&&exports&&!exports.nodeType&&exports,oo=Jo&&typeof module=="object"&&module&&!module.nodeType&&module,di=oo&&oo.exports===Jo,so=di?ue.Buffer:void 0,fi=so?so.isBuffer:void 0,pi=fi||ui;const Qo=pi;var hi="[object Arguments]",mi="[object Array]",gi="[object Boolean]",vi="[object Date]",_i="[object Error]",bi="[object Function]",Ci="[object Map]",yi="[object Number]",Ii="[object Object]",Ti="[object RegExp]",wi="[object Set]",Ei="[object String]",Si="[object WeakMap]",Mi="[object ArrayBuffer]",$i="[object DataView]",Ai="[object Float32Array]",ki="[object Float64Array]",Oi="[object Int8Array]",Ri="[object Int16Array]",Ni="[object Int32Array]",Li="[object Uint8Array]",Pi="[object Uint8ClampedArray]",Ui="[object Uint16Array]",Di="[object Uint32Array]",x={};x[Ai]=x[ki]=x[Oi]=x[Ri]=x[Ni]=x[Li]=x[Pi]=x[Ui]=x[Di]=!0;x[hi]=x[mi]=x[Mi]=x[gi]=x[$i]=x[vi]=x[_i]=x[bi]=x[Ci]=x[yi]=x[Ii]=x[Ti]=x[wi]=x[Ei]=x[Si]=!1;function xi(e){return st(e)&&qo(e.length)&&!!x[ot(e)]}function Wt(e){return function(t){return e(t)}}var Zo=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Qe=Zo&&typeof module=="object"&&module&&!module.nodeType&&module,ji=Qe&&Qe.exports===Zo,kt=ji&&Ja.process,Bi=function(){try{var e=Qe&&Qe.require&&Qe.require("util").types;return e||kt&&kt.binding&&kt.binding("util")}catch{}}();const xe=Bi;var ao=xe&&xe.isTypedArray,Gi=ao?Wt(ao):xi;const Fi=Gi;var Vi=Object.prototype,Hi=Vi.hasOwnProperty;function Yo(e,t){var o=Vt(e),s=!o&&li(e),a=!o&&!s&&Qo(e),l=!o&&!s&&!a&&Fi(e),d=o||s||a||l,m=d?si(e.length,String):[],w=m.length;for(var b in e)(t||Hi.call(e,b))&&!(d&&(b=="length"||a&&(b=="offset"||b=="parent")||l&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||Xr(b,w)))&&m.push(b);return m}function Xo(e,t){return function(o){return e(t(o))}}var Wi=Xo(Object.keys,Object);const qi=Wi;var zi=Object.prototype,Ki=zi.hasOwnProperty;function Ji(e){if(!Ht(e))return qi(e);var t=[];for(var o in Object(e))Ki.call(e,o)&&o!="constructor"&&t.push(o);return t}function qt(e){return zo(e)?Yo(e):Ji(e)}function Qi(e){var t=[];if(e!=null)for(var o in Object(e))t.push(o);return t}var Zi=Object.prototype,Yi=Zi.hasOwnProperty;function Xi(e){if(!nt(e))return Qi(e);var t=Ht(e),o=[];for(var s in e)s=="constructor"&&(t||!Yi.call(e,s))||o.push(s);return o}function zt(e){return zo(e)?Yo(e,!0):Xi(e)}var ec=Me(Object,"create");const Ze=ec;function tc(){this.__data__=Ze?Ze(null):{},this.size=0}function nc(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var oc="__lodash_hash_undefined__",sc=Object.prototype,ac=sc.hasOwnProperty;function rc(e){var t=this.__data__;if(Ze){var o=t[e];return o===oc?void 0:o}return ac.call(t,e)?t[e]:void 0}var ic=Object.prototype,cc=ic.hasOwnProperty;function lc(e){var t=this.__data__;return Ze?t[e]!==void 0:cc.call(t,e)}var uc="__lodash_hash_undefined__";function dc(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Ze&&t===void 0?uc:t,this}function we(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var s=e[t];this.set(s[0],s[1])}}we.prototype.clear=tc;we.prototype.delete=nc;we.prototype.get=rc;we.prototype.has=lc;we.prototype.set=dc;function fc(){this.__data__=[],this.size=0}function pt(e,t){for(var o=e.length;o--;)if(Ho(e[o][0],t))return o;return-1}var pc=Array.prototype,hc=pc.splice;function mc(e){var t=this.__data__,o=pt(t,e);if(o<0)return!1;var s=t.length-1;return o==s?t.pop():hc.call(t,o,1),--this.size,!0}function gc(e){var t=this.__data__,o=pt(t,e);return o<0?void 0:t[o][1]}function vc(e){return pt(this.__data__,e)>-1}function _c(e,t){var o=this.__data__,s=pt(o,e);return s<0?(++this.size,o.push([e,t])):o[s][1]=t,this}function de(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var s=e[t];this.set(s[0],s[1])}}de.prototype.clear=fc;de.prototype.delete=mc;de.prototype.get=gc;de.prototype.has=vc;de.prototype.set=_c;var bc=Me(ue,"Map");const Ye=bc;function Cc(){this.size=0,this.__data__={hash:new we,map:new(Ye||de),string:new we}}function yc(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function ht(e,t){var o=e.__data__;return yc(t)?o[typeof t=="string"?"string":"hash"]:o.map}function Ic(e){var t=ht(this,e).delete(e);return this.size-=t?1:0,t}function Tc(e){return ht(this,e).get(e)}function wc(e){return ht(this,e).has(e)}function Ec(e,t){var o=ht(this,e),s=o.size;return o.set(e,t),this.size+=o.size==s?0:1,this}function Be(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var s=e[t];this.set(s[0],s[1])}}Be.prototype.clear=Cc;Be.prototype.delete=Ic;Be.prototype.get=Tc;Be.prototype.has=wc;Be.prototype.set=Ec;function es(e,t){for(var o=-1,s=t.length,a=e.length;++o<s;)e[a+o]=t[o];return e}var Sc=Xo(Object.getPrototypeOf,Object);const ts=Sc;function Mc(){this.__data__=new de,this.size=0}function $c(e){var t=this.__data__,o=t.delete(e);return this.size=t.size,o}function Ac(e){return this.__data__.get(e)}function kc(e){return this.__data__.has(e)}var Oc=200;function Rc(e,t){var o=this.__data__;if(o instanceof de){var s=o.__data__;if(!Ye||s.length<Oc-1)return s.push([e,t]),this.size=++o.size,this;o=this.__data__=new Be(s)}return o.set(e,t),this.size=o.size,this}function Ge(e){var t=this.__data__=new de(e);this.size=t.size}Ge.prototype.clear=Mc;Ge.prototype.delete=$c;Ge.prototype.get=Ac;Ge.prototype.has=kc;Ge.prototype.set=Rc;function Nc(e,t){return e&&ft(t,qt(t),e)}function Lc(e,t){return e&&ft(t,zt(t),e)}var ns=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ro=ns&&typeof module=="object"&&module&&!module.nodeType&&module,Pc=ro&&ro.exports===ns,io=Pc?ue.Buffer:void 0,co=io?io.allocUnsafe:void 0;function Uc(e,t){if(t)return e.slice();var o=e.length,s=co?co(o):new e.constructor(o);return e.copy(s),s}function Dc(e,t){for(var o=-1,s=e==null?0:e.length,a=0,l=[];++o<s;){var d=e[o];t(d,o,e)&&(l[a++]=d)}return l}function os(){return[]}var xc=Object.prototype,jc=xc.propertyIsEnumerable,lo=Object.getOwnPropertySymbols,Bc=lo?function(e){return e==null?[]:(e=Object(e),Dc(lo(e),function(t){return jc.call(e,t)}))}:os;const Kt=Bc;function Gc(e,t){return ft(e,Kt(e),t)}var Fc=Object.getOwnPropertySymbols,Vc=Fc?function(e){for(var t=[];e;)es(t,Kt(e)),e=ts(e);return t}:os;const ss=Vc;function Hc(e,t){return ft(e,ss(e),t)}function as(e,t,o){var s=t(e);return Vt(e)?s:es(s,o(e))}function Wc(e){return as(e,qt,Kt)}function qc(e){return as(e,zt,ss)}var zc=Me(ue,"DataView");const Lt=zc;var Kc=Me(ue,"Promise");const Pt=Kc;var Jc=Me(ue,"Set");const Ut=Jc;var uo="[object Map]",Qc="[object Object]",fo="[object Promise]",po="[object Set]",ho="[object WeakMap]",mo="[object DataView]",Zc=Se(Lt),Yc=Se(Ye),Xc=Se(Pt),el=Se(Ut),tl=Se(Nt),Te=ot;(Lt&&Te(new Lt(new ArrayBuffer(1)))!=mo||Ye&&Te(new Ye)!=uo||Pt&&Te(Pt.resolve())!=fo||Ut&&Te(new Ut)!=po||Nt&&Te(new Nt)!=ho)&&(Te=function(e){var t=ot(e),o=t==Qc?e.constructor:void 0,s=o?Se(o):"";if(s)switch(s){case Zc:return mo;case Yc:return uo;case Xc:return fo;case el:return po;case tl:return ho}return t});const Jt=Te;var nl=Object.prototype,ol=nl.hasOwnProperty;function sl(e){var t=e.length,o=new e.constructor(t);return t&&typeof e[0]=="string"&&ol.call(e,"index")&&(o.index=e.index,o.input=e.input),o}var al=ue.Uint8Array;const go=al;function Qt(e){var t=new e.constructor(e.byteLength);return new go(t).set(new go(e)),t}function rl(e,t){var o=t?Qt(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}var il=/\w*$/;function cl(e){var t=new e.constructor(e.source,il.exec(e));return t.lastIndex=e.lastIndex,t}var vo=Zn?Zn.prototype:void 0,_o=vo?vo.valueOf:void 0;function ll(e){return _o?Object(_o.call(e)):{}}function ul(e,t){var o=t?Qt(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}var dl="[object Boolean]",fl="[object Date]",pl="[object Map]",hl="[object Number]",ml="[object RegExp]",gl="[object Set]",vl="[object String]",_l="[object Symbol]",bl="[object ArrayBuffer]",Cl="[object DataView]",yl="[object Float32Array]",Il="[object Float64Array]",Tl="[object Int8Array]",wl="[object Int16Array]",El="[object Int32Array]",Sl="[object Uint8Array]",Ml="[object Uint8ClampedArray]",$l="[object Uint16Array]",Al="[object Uint32Array]";function kl(e,t,o){var s=e.constructor;switch(t){case bl:return Qt(e);case dl:case fl:return new s(+e);case Cl:return rl(e,o);case yl:case Il:case Tl:case wl:case El:case Sl:case Ml:case $l:case Al:return ul(e,o);case pl:return new s;case hl:case vl:return new s(e);case ml:return cl(e);case gl:return new s;case _l:return ll(e)}}function Ol(e){return typeof e.constructor=="function"&&!Ht(e)?zr(ts(e)):{}}var Rl="[object Map]";function Nl(e){return st(e)&&Jt(e)==Rl}var bo=xe&&xe.isMap,Ll=bo?Wt(bo):Nl;const Pl=Ll;var Ul="[object Set]";function Dl(e){return st(e)&&Jt(e)==Ul}var Co=xe&&xe.isSet,xl=Co?Wt(Co):Dl;const jl=xl;var Bl=1,Gl=2,Fl=4,rs="[object Arguments]",Vl="[object Array]",Hl="[object Boolean]",Wl="[object Date]",ql="[object Error]",is="[object Function]",zl="[object GeneratorFunction]",Kl="[object Map]",Jl="[object Number]",cs="[object Object]",Ql="[object RegExp]",Zl="[object Set]",Yl="[object String]",Xl="[object Symbol]",eu="[object WeakMap]",tu="[object ArrayBuffer]",nu="[object DataView]",ou="[object Float32Array]",su="[object Float64Array]",au="[object Int8Array]",ru="[object Int16Array]",iu="[object Int32Array]",cu="[object Uint8Array]",lu="[object Uint8ClampedArray]",uu="[object Uint16Array]",du="[object Uint32Array]",P={};P[rs]=P[Vl]=P[tu]=P[nu]=P[Hl]=P[Wl]=P[ou]=P[su]=P[au]=P[ru]=P[iu]=P[Kl]=P[Jl]=P[cs]=P[Ql]=P[Zl]=P[Yl]=P[Xl]=P[cu]=P[lu]=P[uu]=P[du]=!0;P[ql]=P[is]=P[eu]=!1;function ut(e,t,o,s,a,l){var d,m=t&Bl,w=t&Gl,b=t&Fl;if(o&&(d=a?o(e,s,a,l):o(e)),d!==void 0)return d;if(!nt(e))return e;var C=Vt(e);if(C){if(d=sl(e),!m)return Kr(e,d)}else{var S=Jt(e),O=S==is||S==zl;if(Qo(e))return Uc(e,m);if(S==cs||S==rs||O&&!a){if(d=w||O?{}:Ol(e),!m)return w?Hc(e,Lc(d,e)):Gc(e,Nc(d,e))}else{if(!P[S])return a?e:{};d=kl(e,S,m)}}l||(l=new Ge);var g=l.get(e);if(g)return g;l.set(e,d),jl(e)?e.forEach(function(u){d.add(ut(u,t,o,u,e,l))}):Pl(e)&&e.forEach(function(u,y){d.set(y,ut(u,t,o,y,e,l))});var I=b?w?qc:Wc:w?zt:qt,h=C?void 0:I(e);return Qr(h||e,function(u,y){h&&(y=u,u=e[y]),Wo(d,y,ut(u,t,o,y,e,l))}),d}var fu=1,pu=4;function hu(e){return ut(e,fu|pu)}function mu(){const e=Tr(),t=je(),o=V(()=>t.menuFromServer?t.appAsyncMenus:Sr);return{menuTree:V(()=>{const a=hu(o.value);a.sort((d,m)=>(d.meta.order||0)-(m.meta.order||0));function l(d,m){return d?d.map(b=>{var S,O;if(!e.accessRouter(b))return null;if(((S=b.meta)==null?void 0:S.hideChildrenInMenu)||!b.children)return b.children=[],b;b.children=b.children.filter(g=>{var I;return((I=g.meta)==null?void 0:I.hideInMenu)!==!0});const C=l(b.children,m+1);return C.length||m>1?(b.children=C,b):((O=b.meta)==null?void 0:O.hideInMenu)===!1?b:null}).filter(Boolean):null}return l(a,0)})}}function gu(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ao(e)}const vu=ie({emit:["collapse"],setup(){const{t:e}=Ee.exports.useI18n(),t=je(),o=tt(),s=xo(),{menuTree:a}=mu(),l=V({get(){return Ue()||t.device==="desktop"?t.menuCollapse:!1},set(g){t.updateSettings({menuCollapse:g})}}),d=V(()=>t.topMenu),m=N([]),w=N([]),b=g=>{if(Qa.test(g.path)){Za(g.path),w.value=[g.name];return}const{hideInMenu:I,activeMenu:h}=g.meta;if(s.name===g.name&&!I&&!h){w.value=[g.name];return}o.push({name:g.name})},C=g=>{const I=[];let h=!1;const u=(y,f)=>{var j;if(y.name===g){h=!0,I.push(...f);return}(j=y.children)!=null&&j.length&&y.children.forEach(K=>{u(K,[...f,K.name])})};return a.value.forEach(y=>{h||u(y,[y.name])}),I};Eo(g=>{const{requiresAuth:I,activeMenu:h,hideInMenu:u}=g.meta;if(I&&(!u||h)){const y=C(h||g.name),f=new Set([...y,...m.value]);m.value=[...f],w.value=[h||y[y.length-1]]}},!0);const S=g=>{Ue()&&t.updateSettings({menuCollapse:g}),t.device==="desktop"&&t.updateSettings({menuCollapse:g})},O=()=>{function g(I,h=[]){return I&&I.forEach(u=>{var j,K;const y=(j=u==null?void 0:u.meta)!=null&&j.icon?(K=u==null?void 0:u.meta)==null?void 0:K.icon:"",f=(u==null?void 0:u.children)&&(u==null?void 0:u.children.length)!==0?p(wa,{key:u==null?void 0:u.name},{default:()=>[g(u==null?void 0:u.children)],icon:()=>p("i",{class:`iconfont ${y}`},null),title:()=>{var se;return Ia(Ta(e(((se=u==null?void 0:u.meta)==null?void 0:se.locale)||"")))}}):p(Ea,{key:u==null?void 0:u.name,onClick:()=>b(u)},{default:()=>{var se;return[e(((se=u==null?void 0:u.meta)==null?void 0:se.locale)||"")]},icon:()=>p("i",{class:`iconfont ${y}`},null)});h.push(f)}),h}return g(a.value)};return()=>{let g;return p(ya,{mode:d.value?"horizontal":"vertical",collapsed:l.value,"onUpdate:collapsed":I=>l.value=I,"open-keys":m.value,"onUpdate:open-keys":I=>m.value=I,"show-collapse-button":Ue()?!0:t.device!=="mobile","auto-open":!1,"selected-keys":w.value,"auto-open-selected":!0,"level-indent":34,style:"height: 100%;width:100%;",onCollapse:S},gu(g=O())?g:{default:()=>[g]})}}});const Dt=le(vu,[["__scopeId","data-v-7bbdf8b6"]]),_u={class:"change-password-container modal-container"},bu=["src"],Cu={class:"modal-title"},yu={class:"modal-main wsl-scroll"},Iu={class:"modal-bot"},Tu=ie({__name:"chang",emits:["handleClose","handleConfirmation"],setup(e,{emit:t}){const{t:o}=Ee.exports.useI18n(),s=t,a=Xe(),l=N({password:"",surePassword:""}),d=()=>{l.value={password:"",surePassword:""}},m=()=>{d(),s("handleClose")},w=async()=>{if(!l.value.password){H.warning(o("password.modal.placeholder.new"));return}if(!l.value.surePassword){H.warning(o("password.modal.placeholder.sure"));return}if(l.value.password!==l.value.surePassword){H.warning(o("password.form.btn.inconformity"));return}const b=await a.revampPassword({newPassword:l.value.password});if(b.code!==200&&b.code!==401){H.error(b.msg);return}H.success(o("password.form.btn.success")),m(),s("handleConfirmation")};return dt(()=>{d()}),(b,C)=>{const S=Sa,O=Ma,g=$a,I=De;return E(),z("div",_u,[i("div",{class:"modal-fixed",onClick:m},[i("img",{src:M(Bo),alt:""},null,8,bu)]),i("div",Cu,$(b.$t("password.modal.title")),1),i("div",yu,[p(g,{model:l.value,layout:"vertical"},{default:_(()=>[p(O,{field:"password",label:b.$t("password.modal.new")},{default:_(()=>[p(S,{modelValue:l.value.password,"onUpdate:modelValue":C[0]||(C[0]=h=>l.value.password=h),placeholder:b.$t("password.modal.placeholder.new"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p(O,{field:"surePassword",label:b.$t("password.modal.sure")},{default:_(()=>[p(S,{modelValue:l.value.surePassword,"onUpdate:modelValue":C[1]||(C[1]=h=>l.value.surePassword=h),placeholder:b.$t("password.modal.placeholder.sure"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),i("div",Iu,[p(I,{class:"modal-btn-item",onClick:m},{default:_(()=>[ae($(b.$t("password.form.btn.cancel")),1)]),_:1}),p(I,{class:"modal-btn-item",disabled:!l.value.password||!l.value.surePassword,type:"primary",onClick:w},{default:_(()=>[ae($(b.$t("password.form.btn.sure")),1)]),_:1},8,["disabled"])])])}}});const wu=le(Tu,[["__scopeId","data-v-a9f3d9bb"]]),Eu={width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Su=i("g",{"fill-rule":"evenodd","clip-rule":"evenodd",fill:"#4E5969"},[i("path",{d:"M12.834 3.167a4.546 4.546 0 0 0-7.556 4.565.5.5 0 0 1-.124.501l-3.13 3.13a.766.766 0 0 0-.146.27.718.718 0 0 0-.043.301v.004l.2 1.449a.719.719 0 0 0 .207.375c.12.12.255.186.367.202l1.457.2c.066.01.179.003.305-.038a.662.662 0 0 0 .257-.141l.006-.006 3.14-3.133a.5.5 0 0 1 .502-.124A4.55 4.55 0 0 0 12.841 9.6a4.552 4.552 0 0 0-.007-6.432Zm-7.133-.708a5.55 5.55 0 0 1 7.846 7.847v.001a5.55 5.55 0 0 1-5.274 1.453l-2.93 2.924c-.186.19-.432.318-.663.393a1.719 1.719 0 0 1-.758.077l-1.45-.2a1.674 1.674 0 0 1-.938-.487 1.712 1.712 0 0 1-.488-.932l-.001-.007-.2-1.45v-.002c-.037-.259.008-.53.084-.76.077-.23.203-.47.38-.651l.004-.006 2.928-2.927A5.541 5.541 0 0 1 5.7 2.46Z"}),i("path",{d:"M4.24 11.307a.5.5 0 0 1 .707 0l1.534 1.533a.5.5 0 1 1-.707.707L4.24 12.014a.5.5 0 0 1 0-.707ZM9.668 5.834a.5.5 0 1 0 0 1 .5.5 0 0 0 0-1Zm-1.5.5a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"})],-1),Mu=[Su];function $u(e,t){return E(),z("svg",Eu,[...Mu])}const Au={render:$u},ls=e=>(Gt("data-v-44879333"),e=e(),Ft(),e),ku={class:"navbar"},Ou={class:"left-side"},Ru=ls(()=>i("img",{alt:"logo",src:nr},null,-1)),Nu={class:"center-side"},Lu={class:"right-side"},Pu={class:"quick_access_main"},Uu=["onClick"],Du={class:"quick_access_main_item_main"},xu=["src"],ju={class:"quick_access_main_item_m_label"},Bu=["src"],Gu={class:"user-info"},Fu={class:"user-info-name"},Vu={class:"user-info-bot"},Hu={class:"user-info-bot-l"},Wu=ls(()=>i("div",{class:"user-info-bot-i outline"},null,-1)),qu={class:"user-info-bot-l"},zu=["src"],yo="ChatDB",Ku=ie({__name:"index",setup(e){const t=je(),o=Xe(),s=xt(),a=So(),l=Qs(),d=tt(),{t:m,locale:w}=Ee.exports.useI18n(),{getAllConversations:b}=Ot(yo),{clearAll:C}=Ot(yo),{logout:S}=Go(),{changeLocale:O,currentLocale:g}=Zs(),I=[...oa],h=V(()=>o.avatarUrl),u=V(()=>o.name),y=V(()=>s.socketStatus===1?m("socket.status1"):s.socketStatus===2?m("socket.status2"):""),f=V(()=>t.topMenu&&t.menu),j=N(),K=async()=>{await S(),C()},se=()=>{const R=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});j.value.dispatchEvent(R)},$e=Aa("toggleDrawerMenu"),Y=N(!1),_e=()=>{Y.value=!0},fe=()=>{Y.value=!1},pe=()=>{fe()},Ve=()=>{c.emit("navbar-show-ar-login-qr-code")},ne=N(0),be=N([]),at=async()=>{ne.value=0,be.value=await b(),be.value?be.value.forEach(R=>{ne.value+=R.unreadCount}):ne.value=0},he=R=>JSON.parse(R.entryName)[w.value],B=async R=>{if(console.log("handleInitQuitList",R),R){const q=await l.getQuickList();if(q.code!==200&&q.code!==401){if(q.code===20408)return;H.error(q.msg);return}l.updateQuickEnters(q.data)}},k=async R=>{if(R.isOwnApp===0)window.open(R.entryUri,"_blank");else{const q=await o.getApplicationCode({client_id:R.appId,redirect_uri:R.entryUri,scope:"snsapi_base"});if(q.code!==200&&q.code!==401)return q.code===20408||H.error(q.msg),!1;window.open(`${R.entryUri}?code=${q.data.code}`,"_blank")}return!1},Ae=R=>{d.push({path:R})};return ko(()=>a.conversationList,R=>{R&&at()},{deep:!0,immediate:!0}),(R,q)=>{const He=ka,Ce=Oo,mt=Ys,ke=De,We=Ro,Oe=Na,Re=No,Ne=Lo,me=Xs,rt=ea,gt=Oa,it=ta,qe=Ra,vt=La,_t=na,ze=Po;return E(),z("div",ku,[i("div",Ou,[p(Ce,null,{default:_(()=>[Ru,!f.value&&M(t).device==="mobile"?(E(),F(He,{key:0,style:{"font-size":"22px",cursor:"pointer"},onClick:M($e)},null,8,["onClick"])):Q("",!0)]),_:1})]),i("div",Nu,[f.value?(E(),F(Dt,{key:0})):Q("",!0)]),i("ul",Lu,[i("li",null,[p(We,{content:R.$t("settings.language")},{default:_(()=>[p(ke,{class:"nav-btn",type:"outline",shape:"circle",onClick:se},{icon:_(()=>[p(mt)]),_:1})]),_:1},8,["content"]),p(Ne,{trigger:"click",onSelect:M(O)},{content:_(()=>[(E(),z(Ke,null,Rt(I,oe=>p(Re,{key:oe.value,value:oe.value},{icon:_(()=>[Uo(p(Oe,null,null,512),[[Do,oe.value===M(g)]])]),default:_(()=>[ae(" "+$(oe.label),1)]),_:2},1032,["value"])),64))]),default:_(()=>[i("div",{ref_key:"triggerBtn",ref:j,class:"trigger-btn"},null,512)]),_:1},8,["onSelect"])]),i("li",null,[p(Ne,{onPopupVisibleChange:B},{content:_(()=>[i("div",Pu,[(E(!0),z(Ke,null,Rt(M(l).quickEnters,(oe,ct)=>(E(),z("div",{key:`quick_${ct}`,class:"quick_access_main_item",onClick:ge=>k(oe)},[i("div",Du,[i("img",{class:"quick_access_main_item_m_icon",src:oe.iconUrl,alt:""},null,8,xu),i("div",ju,[i("span",null,$(he(oe)),1)])])],8,Uu))),128))])]),default:_(()=>[p(We,{content:R.$t("settings.application")},{default:_(()=>[p(ke,{class:"nav-btn",type:"outline",shape:"circle"},{icon:_(()=>[p(me)]),_:1})]),_:1},8,["content"])]),_:1})]),i("li",null,[p(gt,{count:ne.value,dot:""},{default:_(()=>[p(ke,{class:"nav-btn",type:"outline",shape:"circle",onClick:q[0]||(q[0]=oe=>Ae("/Message-List"))},{default:_(()=>[p(rt)]),_:1})]),_:1},8,["count"])]),i("li",null,[p(We,{content:R.$t("messageBox.ar.logo.title")},{default:_(()=>[p(ke,{class:"nav-btn",type:"outline",shape:"circle",onClick:Ve},{icon:_(()=>[p(it)]),_:1})]),_:1},8,["content"])]),i("li",null,[p(qe,{size:32,style:{marginRight:"8px",cursor:"pointer"}},{default:_(()=>[i("img",{alt:"avatar",src:h.value},null,8,Bu)]),_:1}),p(Ne,{trigger:"click",position:"br"},{content:_(()=>[p(Re,null,{default:_(()=>[p(Ce,null,{default:_(()=>[i("img",{style:{width:"14px",height:"14px",borderRadius:"50%"},src:h.value,alt:""},null,8,zu),i("span",null,$(u.value),1)]),_:1})]),_:1}),p(Re,{onClick:_e},{default:_(()=>[p(Ce,null,{default:_(()=>[p(M(Au)),i("span",null,$(R.$t("messageBox.change.password")),1)]),_:1})]),_:1}),p(Re,{onClick:K},{default:_(()=>[p(Ce,null,{default:_(()=>[p(_t),i("span",null,$(R.$t("messageBox.logout")),1)]),_:1})]),_:1})]),default:_(()=>[i("div",Gu,[i("div",Fu,[i("span",null,$(u.value),1)]),i("div",Vu,[M(s).networkStatus?(E(),z(Ke,{key:0},[M(s).socketStatus==3?(E(),z("div",{key:0,class:Bt(["user-info-bot-i",M(s).networkStatus?"online":"outline"])},null,2)):Q("",!0),M(s).socketStatus===2?(E(),F(vt,{key:1,size:12})):Q("",!0),i("div",Hu,$(M(s).socketStatus===2?y.value:R.$t("meeting.invite.line.status.online")),1)],64)):(E(),z(Ke,{key:1},[Wu,i("div",qu,$(R.$t("meeting.invite.line.status.outline")),1)],64))])])]),_:1})])]),Y.value?(E(),F(ze,{key:0,visible:Y.value,"onUpdate:visible":q[1]||(q[1]=oe=>Y.value=oe),footer:!1,closable:!1,class:"customModal"},{default:_(()=>[p(wu,{onHandleClose:fe,onHandleConfirmation:pe})]),_:1},8,["visible"])):Q("",!0)])}}});const Ju=le(Ku,[["__scopeId","data-v-44879333"]]);const Fe=e=>(Gt("data-v-17257cfa"),e=e(),Ft(),e),Qu={class:"tag-link"},Zu=Fe(()=>i("span",null,"\u91CD\u65B0\u52A0\u8F7D",-1)),Yu=Fe(()=>i("span",null,"\u5173\u95ED\u5F53\u524D\u6807\u7B7E\u9875",-1)),Xu=Fe(()=>i("span",null,"\u5173\u95ED\u5DE6\u4FA7\u6807\u7B7E\u9875",-1)),ed=Fe(()=>i("span",null,"\u5173\u95ED\u53F3\u4FA7\u6807\u7B7E\u9875",-1)),td=Fe(()=>i("span",null,"\u5173\u95ED\u5176\u5B83\u6807\u7B7E\u9875",-1)),nd=Fe(()=>i("span",null,"\u5173\u95ED\u5168\u90E8\u6807\u7B7E\u9875",-1)),od=ie({__name:"tab-item",props:{itemData:{type:Object,default(){return[]}},index:{type:Number,default:0}},setup(e){const t=e,o=tt(),s=xo(),a=jt(),l=I=>{o.push({...I})},d=V(()=>a.getTabList),m=V(()=>t.itemData.fullPath!==s.fullPath),w=V(()=>t.index===0),b=V(()=>[0,1].includes(t.index)),C=V(()=>t.index===d.value.length-1),S=(I,h)=>{if(a.deleteTag(h,I),t.itemData.fullPath===s.fullPath){const u=d.value[h-1];o.push({name:u.name})}},O=()=>d.value.findIndex(I=>I.fullPath===s.fullPath),g=async I=>{const{itemData:h,index:u}=t,y=[...d.value];if(I==="current")S(h,u);else if(I==="left"){const f=O();y.splice(1,t.index-1),a.freshTabList(y),f<u&&o.push({name:h.name})}else if(I==="right"){const f=O();y.splice(t.index+1),a.freshTabList(y),f>u&&o.push({name:h.name})}else if(I==="others"){const f=d.value.filter((j,K)=>K===0||K===t.index);a.freshTabList(f),o.push({name:h.name})}else I==="reload"?(a.deleteCache(h),await o.push({name:sa,params:{path:s.fullPath}}),a.addCache(h.name)):(a.resetTabList(),o.push({name:aa}))};return(I,h)=>{const u=Ua,y=ra,f=No,j=ia,K=ca,se=la,$e=ua,Y=Lo;return E(),F(Y,{trigger:"contextMenu","popup-max-height":!1,onSelect:g},{content:_(()=>[p(f,{disabled:m.value,value:"reload"},{default:_(()=>[p(y),Zu]),_:1},8,["disabled","value"]),p(f,{class:"sperate-line",disabled:w.value,value:"current"},{default:_(()=>[p(u),Yu]),_:1},8,["disabled","value"]),p(f,{disabled:b.value,value:"left"},{default:_(()=>[p(j),Xu]),_:1},8,["disabled","value"]),p(f,{class:"sperate-line",disabled:C.value,value:"right"},{default:_(()=>[p(K),ed]),_:1},8,["disabled","value"]),p(f,{value:"others"},{default:_(()=>[p(se),td]),_:1},8,["value"]),p(f,{value:"all"},{default:_(()=>[p($e),nd]),_:1},8,["value"])]),default:_(()=>[i("span",{class:Bt(["arco-tag arco-tag-size-medium arco-tag-checked",{"link-activated":e.itemData.fullPath===I.$route.fullPath}]),onClick:h[1]||(h[1]=_e=>l(e.itemData))},[i("span",Qu,$(I.$t(e.itemData.title)),1),i("span",{class:"arco-icon-hover arco-tag-icon-hover arco-icon-hover-size-medium arco-tag-close-btn",onClick:h[0]||(h[0]=Pa(_e=>S(e.itemData,e.index),["stop"]))},[p(u)])],2)]),_:1})}}});const sd=le(od,[["__scopeId","data-v-17257cfa"]]),ad=e=>(Gt("data-v-509db106"),e=e(),Ft(),e),rd={class:"tab-bar-container"},id={class:"tab-bar-box"},cd={class:"tab-bar-scroll"},ld={class:"tags-wrap"},ud=ad(()=>i("div",{class:"tag-bar-operation"},null,-1)),dd=ie({__name:"index",setup(e){const t=je(),o=jt(),s=N(),a=V(()=>o.getTabList),l=V(()=>t.navbar?60:0);return ko(()=>t.navbar,()=>{s.value.updatePosition()}),Eo(d=>{!d.meta.noAffix&&!a.value.some(m=>m.fullPath===d.fullPath)&&o.updateTabList(d)},!0),Da(()=>{da()}),(d,m)=>{const w=xa;return E(),z("div",rd,[p(w,{ref_key:"affixRef",ref:s,"offset-top":l.value},{default:_(()=>[i("div",id,[i("div",cd,[i("div",ld,[(E(!0),z(Ke,null,Rt(a.value,(b,C)=>(E(),F(sd,{key:b.fullPath,index:C,"item-data":b},null,8,["index","item-data"]))),128))])]),ud])]),_:1},8,["offset-top"])])}}});const fd=le(dd,[["__scopeId","data-v-509db106"]]),pd={class:"room-options-container"},hd=["src"],md={class:"link-m-t borderB"},gd={class:"room-options-main"},vd={class:"link-m-b"},_d={class:"link-m-b-btn"},bd=ie({__name:"force_entry",emits:["handleClose","handleJoinMeeting"],setup(e,{emit:t}){const o=t,{t:s}=Ee.exports.useI18n(),a=()=>{o("handleClose")},d=Ya(async()=>{o("handleJoinMeeting")},1e3);return(m,w)=>(E(),z("div",pd,[i("div",{class:"room-fixed",onClick:a},[i("img",{src:M(jo),alt:""},null,8,hd)]),i("div",md,[i("span",null,$(M(s)("meeting.modal.title")),1)]),i("div",gd,[i("span",null,$(M(s)("meeting.modal.force.desc")),1)]),i("div",vd,[i("div",_d,[i("div",{class:"link-m-b-btn-i btn-border",onClick:a},[i("span",null,$(M(s)("meeting.modal.btn.cancel")),1)]),i("div",{class:"link-m-b-btn-i btn-bg",onClick:w[0]||(w[0]=(...b)=>M(d)&&M(d)(...b))},[i("span",null,$(M(s)("meeting.modal.btn.sure")),1)])])])]))}});const Cd=le(bd,[["__scopeId","data-v-beb61611"]]),yd={class:"upcoming-container"},Id={class:"upcoming-container-top"},Td={class:"upcoming-container-top-l"},wd=["src"],Ed={class:"upcoming-container-top-l-r"},Sd=["src"],Md={class:"upcoming-container-main"},$d={class:"upcoming-container-main-top textEllipsis"},Ad={class:"upcoming-container-main-bot"},kd={class:"upcoming-container-main-bot-i one"},Od={class:"upcoming-container-main-bot-i"},Rd={class:"upcoming-container-menu"},Nd=ie({__name:"index",setup(e,{expose:t}){const{t:o}=Ee.exports.useI18n(),s=Mo(),a=$o(),l=N(""),d=C=>C?Xa(C,"HH:mm"):"",m=async C=>{if(C){const S=await a.filterMemberInfoByUserId(C);l.value=S.name}},w=()=>{s.removeUpcomingMeetingList(s.upcomingMeetingInfo),s.upcomingMeetingList.length>0?s.updateUpcomingMeetingInfo(s.upcomingMeetingList[0]):(s.updateUpcomingMeetingInfo(null),s.updateUpcomingMeetingVisible(!1))},b=async()=>{c.emit("meeting-notification-close"),c.emit("Chat-upcoming-meeting-join")};return et(()=>{m(s.upcomingMeetingInfo.master)}),t({handleClose:w}),(C,S)=>{var I,h,u;const O=Ro,g=De;return E(),z("div",yd,[i("div",Id,[i("div",Td,[i("img",{src:M(er),alt:""},null,8,wd),i("div",Ed,[i("span",null,$(M(o)("meeting.modal.upcoming.title")),1)])]),i("div",{class:"upcoming-container-top-r",onClick:w},[i("img",{src:M(Bo),alt:""},null,8,Sd)])]),i("div",Md,[p(O,{content:(I=M(s).upcomingMeetingInfo)==null?void 0:I.subject},{default:_(()=>{var y;return[i("div",$d,$((y=M(s).upcomingMeetingInfo)==null?void 0:y.subject),1)]}),_:1},8,["content"]),i("div",Ad,[i("div",kd,[i("span",null,$(M(o)("meeting.modal.upcoming.content2"))+":",1),ae(" \xA0 "),i("span",null,$(l.value),1)]),i("div",Od,[i("span",null,$(M(o)("meeting.modal.upcoming.content1"))+":",1),ae(" \xA0 "),i("span",null,$(d((h=M(s).upcomingMeetingInfo)==null?void 0:h.startTime))+" - "+$(d((u=M(s).upcomingMeetingInfo)==null?void 0:u.endTime)),1)])])]),i("div",Rd,[p(g,{long:"",class:"modal-btn-item",onClick:w},{default:_(()=>[ae($(C.$t("meeting.modal.upcoming.btn1")),1)]),_:1}),p(g,{long:"",class:"modal-btn-item",type:"primary",onClick:b},{default:_(()=>[ae($(C.$t("meeting.modal.upcoming.btn2")),1)]),_:1})])])}}});const Ld=le(Nd,[["__scopeId","data-v-204ae469"]]),Pd={class:"ar-qr-code-modal-container"},Ud=["src"],Dd={class:"ar-qr-code-main"},xd={class:"ar-qr-code-main-top"},jd={class:"ar-qr-code-main-mid-body"},Bd={class:"ar-qr-code-main-bot"},Gd={class:"ar-qr-code-main-bot-desc"},Fd=ie({__name:"index",emits:["handleClose"],setup(e,{emit:t}){const o=N(null),s=t,{t:a}=Ee.exports.useI18n();N(!0);const l=()=>{s("handleClose")},d=Xe(),m=xt(),w=N(""),b=async()=>{const S=await d.getArLoginQrCode({command:0});if(S.code!==200&&S.code!==401){H.error(S.msg);return}w.value=S.data},C=async()=>{o.value&&(await b(),o.value.innerHTML="",fa.toCanvas(w.value,{errorCorrectionLevel:"H",width:180,margin:2},(S,O)=>{var I;if(S){console.error(S);return}o.value&&o.value.appendChild(O);const g=O.getContext("2d");if(g){const u=(O.width-30)/2,y=(O.height-30)/2;g.beginPath(),g.moveTo(u+5,y),g.lineTo(u+30-5,y),g.quadraticCurveTo(u+30,y,u+30,y+5),g.lineTo(u+30,y+30-5),g.quadraticCurveTo(u+30,y+30,u+30-5,y+30),g.lineTo(u+5,y+30),g.quadraticCurveTo(u,y+30,u,y+30-5),g.lineTo(u,y+5),g.quadraticCurveTo(u,y,u+5,y),g.closePath(),g.fillStyle="#ffffff",g.fill(),g.strokeStyle="#000000",g.lineWidth=2,g.stroke();const f=new Image;f.src=(I=m.platformConfig)==null?void 0:I.oneToOneLogo,f.onload=()=>{g.drawImage(f,u+2.5,y+2.5,30-5,30-5)}}if(o.value){const h=document.createElement("div");h.textContent=d.name?d.name:"",h.style.textAlign="center",o.value.appendChild(h)}}))};return et(()=>{C()}),dt(()=>{w.value=""}),(S,O)=>(E(),z("div",Pd,[i("div",{class:"ar-qr-code-fixed",onClick:l},[i("img",{src:M(jo),alt:""},null,8,Ud)]),i("div",Dd,[i("div",xd,[i("span",null,$(M(a)("ar.qr.code.modal.title")),1)]),i("div",jd,[i("div",{ref_key:"qrCodeContainer",ref:o,class:"ar-qr-code-container"},null,512)])]),i("div",Bd,[i("div",Gd,[i("span",null,$(M(a)("ar.qr.code.modal.desc1")),1)])])]))}});const Vd=le(Fd,[["__scopeId","data-v-145f1761"]]);function Hd(e,t,o,s=!1){e.addEventListener&&typeof e.addEventListener=="function"&&e.addEventListener(t,o,s)}function Wd(e,t,o,s=!1){e.removeEventListener&&typeof e.removeEventListener=="function"&&e.removeEventListener(t,o,s)}const qd=992;function zd(){return document.body.getBoundingClientRect().width-1<qd}function Kd(e){const t=je();function o(){if(!document.hidden){const a=zd();t.toggleDevice(a?"mobile":"desktop"),t.toggleMenu(a)}}const s=Ka(o,100);et(()=>{e&&s()}),ja(()=>{Hd(window,"resize",s)}),dt(()=>{Wd(window,"resize",s)})}const Jd={width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Qd=i("circle",{cx:"28",cy:"28",r:"28",fill:"#FF7D00"},null,-1),Zd=i("path",{d:"M25.607 34a2.432 2.432 0 0 0 4.79 0l1.596-22a4.012 4.012 0 0 0-1.171-2.826A3.996 3.996 0 0 0 28.002 8a4.095 4.095 0 0 0-2.935 1.345A4.112 4.112 0 0 0 24.01 12.4L25.607 34Zm2.395 6a3.986 3.986 0 0 0-3.688 2.47 4.008 4.008 0 0 0 .865 4.358A3.988 3.988 0 0 0 31.993 44a3.786 3.786 0 0 0-1.098-2.9 3.77 3.77 0 0 0-2.893-1.1Z",fill:"#fff"},null,-1),Yd=[Qd,Zd];function Xd(e,t){return E(),z("svg",Jd,[...Yd])}const Io={render:Xd};function ef(){const e=N("default");return et(()=>{"Notification"in window&&(e.value=Notification.permission)}),{permission:e,requestPermission:async()=>{if(!("Notification"in window)){console.warn("Browser does not support notifications");return}try{const s=await Notification.requestPermission();e.value=s,console.log("\u8BF7\u6C42\u901A\u77E5\u6743\u9650",e.value)}catch(s){console.error("Error requesting permission:",s)}},notify:s=>{if(e.value!=="granted"){console.warn("Notification permission not granted");return}console.log("\u53D1\u9001\u7CFB\u7EDF\u901A\u77E5",s.title,s);const a=new Notification(s.title,s);a.onclick=()=>{window.focus(),console.log("Notification clicked")},console.log("\u53D1\u9001\u7CFB\u7EDF\u901A\u77E5-notification",a)}}}const tf=ie({__name:"page-layout",setup(e){const t=jt(),o=V(()=>t.getCacheList);return(s,a)=>{const l=Ba("router-view");return E(),F(l,null,{default:_(({Component:d,route:m})=>[p(Fa,{name:"fade",mode:"out-in",appear:""},{default:_(()=>[m.meta.ignoreCache?(E(),F(Je(d),{key:m.fullPath})):(E(),F(Ga,{key:1,include:o.value},[(E(),F(Je(d),{key:m.fullPath}))],1032,["include"]))]),_:2},1024)]),_:1})}}}),nf={key:0,class:"layout-navbar"},of={class:"menu-wrapper"},sf={class:"modal-content"},af={class:"modal-content-top"},rf={class:"modal-content-desc"},cf={class:"modal-content-desc-b"},lf={class:"errorMessage xxxx"},uf={class:"modal-content-bot"},df={class:"modal-content"},ff={class:"modal-content-top"},pf={class:"modal-content-desc"},hf={class:"modal-content-desc-b"},mf={class:"errorMessage"},gf={class:"modal-content-bot"},vf={class:"modal-content-bot-i"},_f={class:"modal-content-bot-i"},bf={class:"modal-content"},Cf={class:"modal-content-top"},yf={class:"modal-content-desc"},If={class:"modal-content-desc-b"},Tf={class:"modal-content-bot"},wf={class:"modal-content-bot-i"},Ef={class:"modal-content-bot-i"},Sf={key:2,class:"upcoming-modal"};function To(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ao(e)}const Mf="ChatDB",$f="60px",Af=ie({__name:"default-layout",setup(e){const{requestPermission:t,notify:o}=ef(),s=N(null),{t:a}=Ee.exports.useI18n(),{logout:l}=Go(),{addConversation:d,addMessage:m,getAllConversations:w,clearAll:b}=Ot(Mf),C=$o(),S=N(!1),O=N(0),g=je(),I=Xe(),h=So(),u=xt(),y=tt(),f=Mo(),j=N(!1),K=N(!1),se=N(""),$e=N(""),Y=N(!1),_e=N(0),fe=N(!1),pe=N(!1),Ve=N(),ne=N(!1);let be,at;const he=(n,r)=>{se.value=n,$e.value=r};let B;const k=N(null);Kd(!0);const Ae=V(()=>Ue()),R=V(()=>g.navbar),q=V(()=>g.menu&&!g.topMenu),He=V(()=>Ae.value?!1:g.hideMenu),Ce=V(()=>g.menuCollapse?48:g.menuWidth),mt=V(()=>g.menuCollapse),ke=V(()=>{const n=q.value&&!He.value?{paddingLeft:`${Ce.value}px`}:{},r=R.value?{paddingTop:Ae.value?0:$f}:{};return{...n,...r}}),We=n=>{!S.value||g.updateSettings({menuCollapse:n})},Oe=N(!1),Re=()=>{Oe.value=!1};Va("toggleDrawerMenu",()=>{Oe.value=!Oe.value});const Ne=(n,r,v)=>{o({title:n,body:r,icon:v})},me=N(!1),rt=()=>{me.value=!0},gt=()=>{me.value=!1},it=async()=>{var v;console.log("\u5237\u65B0\u4E1A\u52A1\u7CFB\u7EDFtoken-----------");const n=$t(),r=await I.userResetLogin({refresh_token:n});if(r.code!==200&&r.code!==401){H.error(r.msg);return}if(r.code===10909&&!j.value){he(a("error.logout.title1"),a("error.logout.tips2")),j.value=!0;return}Wn(r.data.tokenType),qn(r.data.token),zn(r.data.refreshToken),B==null||B.refreshToken({token:r.data.token}),(v=k.value)==null||v.refreshToken({token:r.data.token})},qe=async()=>{j.value=!1,K.value=!1,await l(),b()},vt=()=>{Y.value=!1,fe.value=!1},_t=()=>{Y.value=!1};let ze;const oe=n=>{k.value.sendAssistInviteeTimeoutEvent({meetingNo:n.meetingNo,invitor:n.invitor}),f.updateAnswerInfo(null),f.updateAnswerVisible(!1)},ct=n=>{if(f.answerInfo&&f.answerInfo.meetingNo||k.value&&k.value.meetingInfo&&k.value.meetingInfo.meetingNo){console.log("\u63A5\u6536\u5230\u88AB\u9080\u8BF7\u4E1A\u52A1-\u5DF2\u7ECF\u5728\u88AB\u547C\u53EB\u4E2D",n),k.value.sendAssistInviteeBusyEvent({meetingNo:n.meetingNo,invitor:n.invitor});return}const r=C.filterMemberInfoByUserId(n.invitor);f.updateAnswerInfo({...r,meetingNo:n.meetingNo}),f.updateAnswerVisible(!0),ze=setTimeout(()=>{oe(n)},1e3*f.answerTimeoutTime),Ne(a("notification.title"),a("notification.assist.title"),f.answerInfo.avatarUrl)},ge=()=>{ze&&clearTimeout(ze)},Zt=async n=>{const r=await C.filterMemberInfoByUserId(n.invitee);console.log("\u88AB\u9080\u8BF7\u4EBA\u5FD9\u788C\u4E2D-",r,r==null?void 0:r.name,n),r?H.warning(`${r.name} ${a("meeting.invite.line.msg1")}`):H.warning(`${n.invitee} ${a("meeting.invite.line.msg1")}`)},Yt=n=>{console.log("\u88AB\u9080\u8BF7\u4EBA\u8D85\u65F6\u672A\u63A5\u542C-",n);const r=C.filterMemberInfoByUserId(n.invitee);r?H.warning(`${r.name} ${a("meeting.invite.line.msg2")}`):H.warning(`${n.invitee} ${a("meeting.invite.line.msg2")}`)},Xt=()=>{H.warning(`${a("meeting.answer.msg1")}`),ge(),f.updateAnswerInfo(null),f.updateAnswerVisible(!1)},en=()=>{H.warning(`${a("meeting.answer.msg2")}`),ge(),f.updateAnswerInfo(null),f.updateAnswerVisible(!1)},tn=n=>{f.answerVisible&&n.meetingNo===f.answerInfo.meetingNo&&(H.warning(a("meeting.message.over")),f.updateAnswerInfo(null),f.updateAnswerVisible(!1))},us=()=>{pe.value=!0},nn=n=>{pe.value=!1,u.notificationId&&Ie.remove(u.notificationId),n||localStorage.removeItem("meetingInfo")},ds=async()=>{var r;nn(!0);const n=await k.value.agreeJoinMeeting({meetingNo:f.forceEntryMeetingInfo.meetingNo,invitor:f.forceEntryMeetingInfo.userId,forceEntryStatus:1});if(n.code!==200&&n.code!==401){H.error(n.msg);return}ce.updateRoomTranslateInfo({...ce.roomTranslateInfo,...n.data,open:!!((r=n.data)!=null&&r.enableTranslation)}),k.value.setRoomOnlineListPsn(C.memberList),k.value.setRoomOnlineGroupPsn(C.memberGroupList),f.updateAnswerVisible(!1),f.updateAnswerInfo(null),f.updateForceEntryMeetingInfo(null),f.updateAssistVisible(!0)},on=()=>{ge(),us()},sn=n=>{f.addUpcomingMeetingList(n),f.updateUpcomingMeetingInfo(n),f.updateUpcomingMeetingVisible(!0)},an=async()=>{if(f.answerInfo&&f.answerInfo.meetingNo){H.error(a("meeting.call.message.tips"));return}const n=f.upcomingMeetingInfo,r=C.filterMemberInfoByUserId(n.master);f.updateRoomOptions({meetingName:n==null?void 0:n.subject,meetingNo:n==null?void 0:n.meetingNo,organizer:r==null?void 0:r.name,cloudRecord:(n==null?void 0:n.recordStatus)===1,abstract:(n==null?void 0:n.aiStatus)===1,escaping:n.escaping===1,video:!1,audio:!0,loudspeaker:!0}),ne.value=!0,Ve.value&&Ve.value.handleClose()},bt=()=>{ne.value=!1},Ct=async n=>{var v,A,L,W;const r=await k.value.joinMeeting({meetingNo:n.meetingNo,forceEntryStatus:0,inviters:[]});if(r.code!==200&&r.code!==401){r.code===Pe.OTHER_CLIENT_JOINED_MEETING||r.code===Pe.OTHER_CLIENT_IN_MEETING?(f.updateForceEntryMeetingInfo({meetingNo:n.meetingNo,invitor:[]}),ce.updateRoomTranslateInfo({...ce.roomTranslateInfo,...r.data,open:!!((v=r.data)!=null&&v.enableTranslation)}),c.emit("Chat-Other-Client-Joined-Meeting")):H.error(r.msg);return}k.value.roomMenuOptions={video:(A=f.roomOptions)==null?void 0:A.video,audio:(L=f.roomOptions)==null?void 0:L.audio,loudspeaker:(W=f.roomOptions)==null?void 0:W.loudspeaker},k.value.setRoomOnlineListPsn(C.memberList),k.value.setRoomOnlineGroupPsn(C.memberGroupList),ne.value&&bt(),ne.value&&bt(),f.updateAssistVisible(!0)},rn=()=>{c.emit("meeting-list-update")},yt=async n=>{if(console.log("\u6536\u5230 invitation-join-meeting \u4E8B\u4EF6\uFF0C\u6570\u636E:",n),n.meetingToken)try{const{joinMeeting:r}=await _a(()=>import("./invitation.e2ee23f2.js"),["assets/invitation.e2ee23f2.js","assets/index.dbbac9d8.js","assets/arco.638965b6.js","assets/chart.ffc0c533.js","assets/vue.125da600.js","assets/index.63d95e4b.css"]),v=await r({meetingToken:n.meetingToken});if(v.data.code===200){const A={meetingNo:v.data.data.meetingNo};await Ct(A)}else H.error(v.data.msg||"\u52A0\u5165\u4F1A\u8BAE\u5931\u8D25")}catch(r){console.error("\u52A0\u5165\u4F1A\u8BAE\u5931\u8D25:",r),H.error("\u52A0\u5165\u4F1A\u8BAE\u5931\u8D25")}else n.meetingNo&&await Ct(n)},ce=pa(),cn=n=>{n.reason===8&&(s.value=Io,he(a("error.logout.tips3"),a("error.logout.tips6")),j.value=!0),ce.updateRoomMenuOptionsVideo(!1),G.emit("th-self-menu-camera-close")},fs=async()=>{var r,v,A;const n=localStorage.getItem("meetingInfo");if(n){const L=JSON.parse(n),W=await k.value.joinMeeting({meetingNo:L.meetingNo,forceEntryStatus:0,inviters:[]});if(W.code!==200&&W.code!==401){W.code===Pe.OTHER_CLIENT_JOINED_MEETING||W.code===Pe.OTHER_CLIENT_IN_MEETING?(f.updateForceEntryMeetingInfo({meetingNo:L.meetingNo,invitor:[]}),c.emit("Chat-Other-Client-Joined-Meeting")):(Ie.remove(u.notificationId),localStorage.removeItem("meetingInfo"),G.emit("th-assist-closed"));return}k.value.roomMenuOptions={video:(r=f.roomOptions)==null?void 0:r.video,audio:(v=f.roomOptions)==null?void 0:v.audio,loudspeaker:(A=f.roomOptions)==null?void 0:A.loudspeaker},k.value.setRoomOnlineListPsn(C.memberList),k.value.setRoomOnlineGroupPsn(C.memberGroupList),k.value.sendAssistMeetingStatusSyncEvent({meetingNo:L.meetingNo})}},ps=async()=>{var r,v,A,L,W,te,U;const n=localStorage.getItem("meetingInfo");if(n){const X=JSON.parse(n),re=await k.value.joinMeeting({meetingNo:X.meetingNo,forceEntryStatus:0,inviters:[]});if(re.code!==200&&re.code!==401){re.code===Pe.OTHER_CLIENT_JOINED_MEETING||re.code===Pe.OTHER_CLIENT_IN_MEETING?(f.updateForceEntryMeetingInfo({meetingNo:X.meetingNo,invitor:[]}),c.emit("Chat-Other-Client-Joined-Meeting"),ce.updateRoomTranslateInfo({...ce.roomTranslateInfo,...X,open:!!((r=re.data)!=null&&r.enableTranslation)})):(H.error(re.msg),Ie.remove(u.notificationId),localStorage.removeItem("meetingInfo"));return}ce.updateRoomTranslateInfo({...ce.roomTranslateInfo,languageType:(v=re.data)==null?void 0:v.languageType,industryType:(A=re.data)==null?void 0:A.industryType,...re.data,open:!!((L=re.data)!=null&&L.enableTranslation)}),k.value.roomMenuOptions={video:(W=f.roomOptions)==null?void 0:W.video,audio:(te=f.roomOptions)==null?void 0:te.audio,loudspeaker:(U=f.roomOptions)==null?void 0:U.loudspeaker},k.value.setRoomOnlineListPsn(C.memberList),k.value.setRoomOnlineGroupPsn(C.memberGroupList),Ie.remove(u.notificationId),f.updateAssistVisible(!0)}},hs=()=>{if(f.assistVisible){fs();return}u.updateNotificationId(`${Date.now()}`);const n=localStorage.getItem("meetingInfo");if(n){const r=JSON.parse(n);Ie.info({id:u.notificationId,title:a("notification.assist.join.hint"),content:`${a("notification.assist.join.title")} ${r.subject}, ${a("notification.assist.join.title1")}`,duration:0,footer:()=>{let v,A;return p(Oo,null,{default:()=>[p(De,{type:"secondary",size:"small",onClick:()=>{localStorage.removeItem("meetingInfo"),Ie.remove(u.notificationId)}},To(v=a("notification.assist.join.label1"))?v:{default:()=>[v]}),p(De,{type:"primary",size:"small",onClick:ps},To(A=a("notification.assist.join.label2"))?A:{default:()=>[A]})]})}})}},ln=async()=>{const n=await C.getContactsData();return n.code!==200&&n.code!==401||C.addMemberList(n.data),n},un=async()=>{const n=await C.getContactsGroupData();return n.code!==200&&n.code!==401||C.addGroupMemberList(n.data),n},ms=async n=>{const r=await h.getChatMessageList(n);return r.code!==200&&r.code!==401||(console.log("\u52A0\u8F7D\u6B21\u8981\u6570\u636E--\u6700\u8FD1\u6D88\u606F-res",r),r.data&&r.data.length>0&&r.data.forEach(async(v,A)=>{if(v.messageType===5){v.content="";return}if(v.chatType===Z.GROUP_CHAT){const L={...v,parentId:`${v.chatType}_${n.groupId}`};await m(L,!1)}else{const L={...v,parentId:`${v.chatType}_${n.userId}`};await m(L,!1)}}),console.log("\u52A0\u8F7D\u6B21\u8981\u6570\u636E--\u6700\u8FD1\u6D88\u606F-res-after",r)),r},gs=async()=>{const n=await h.getChatConversationList();if(n.code!==200&&n.code!==401)return n;if(console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E--\u4F1A\u8BDD\u5217\u8868-api-res",n),n.data&&n.data.length>0){await n.data.forEach(async v=>{await d({...v,conversationId:`${v.chatType}_${v.targetId}`,status:1}),console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E--\u4F1A\u8BDD\u5217\u8868-conversation",v),await ms({...v.chatType===0&&{userId:v.targetId},...v.chatType===1&&{groupId:v.targetId},pageNo:1,pageSize:v.unreadCount?v.unreadCount:10})});const r=await w();console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E--\u4F1A\u8BDD\u5217\u8868-db-conversationList",r),h.updateConversationList(r)}return n},vs=async()=>{const n={groupId:"",userId:""},r=await h.getChatOffLineMessageList(n);return r.code!==200&&r.code!==401||(console.log("\u52A0\u8F7D\u6B21\u8981\u6570\u636E--\u79BB\u7EBF\u6D88\u606F-res",r),r.data&&r.data.length>0&&await r.data.forEach(async v=>{const A={...v,parentId:`${v.chatType}_${v.chatType===Z.GROUP_CHAT?v.recipientId:v.senderId}`};await m(A,!0)})),r},dn=()=>{console.log("\u8FDC\u7A0B\u534F\u52A9-Websocket\u8FDE\u63A5\u6253\u5F00:Th-im-open-success"),k.value.login()},fn=n=>{console.log("\u8FDC\u7A0B\u534F\u52A9Websocket\u767B\u5F55\u6210\u529F:Th-login-success",n.lastLoginTime),u.updateSocketStatus(3);const r=localStorage.getItem("meetingInfo");r&&(JSON.parse(r).selfUserId===I.userId?hs():localStorage.removeItem("meetingInfo"))},pn=n=>{console.log("Socket\u5F02\u5E38\u8FDE\u63A5\u5173\u95ED\u89E6\u53D1-\u91CD\u65B0\u8FDE\u63A5\u4E2D-layout...",n),_e.value=n.retryCount,_e.value===0&&(Y.value=!0)},hn=n=>{Y.value&&(Y.value=!1),console.log("Socket\u5F02\u5E38\u8FDE\u63A5\u5173\u95ED-\u4E1A\u52A1\u903B\u8F91",n),fe.value=!0,B==null||B.logout()},_s=()=>{fe.value=!1,B.chatWssReconnect()},bs=()=>{G.on("ThAssistImWsOpen",dn),G.on("ThAssistLoginSuccess",fn),G.on("ThAssistInvited",ct),G.on("ThAssistInviteeBeBusy",Zt),G.on("ThAssistInviteeBeTimeout",Yt),G.on("ThAssistOtherClientAccepted",Xt),G.on("ThAssistOtherClientRejected",en),G.on("ThAssistClosed",tn),G.on("ThAssistAboutToBegin",sn),G.on("ThAssistPlanStatusUpdated",rn),G.on("ThAssistKickOut",cn)},Cs=()=>{G.off("ThAssistImWsOpen",dn),G.off("ThAssistLoginSuccess",fn),G.off("ThAssistInvited",ct),G.off("ThAssistInviteeBeBusy",Zt),G.off("ThAssistInviteeBeTimeout",Yt),G.off("ThAssistOtherClientAccepted",Xt),G.off("ThAssistOtherClientRejected",en),G.off("ThAssistClosed",tn),G.off("ThAssistAboutToBegin",sn),G.off("ThAssistPlanStatusUpdated",rn),G.off("ThAssistKickOut",cn)};ha();const ys=async()=>{let n="";Ue()?n=`wss://${lt()}/socket`:n=`wss://${lt()}/socket`,k.value=new ba({wssUrl:n,userId:I.userId,token:Mt()}),f.updateThImEvent(k.value),k.value.initWss(),bs()},mn=()=>{console.log("\u5373\u65F6\u901A\u8BAF-websocket-\u8FDE\u63A5\u6253\u5F00:handleChatWsOpen"),u.updateSocketStatus(2),B.login()},gn=async n=>{await be(),u.updateLastLoginTime(n.lastLoginTime),vt(),ys()},vn=n=>{console.log("\u63A5\u6536\u5230\u767B\u51FA\u6210\u529F\u4E8B\u4EF6-\u4E1A\u52A1\u903B\u8F91",n)},_n=n=>{j.value||(console.log("\u63A5\u6536\u5230\u88AB\u8E22\u4E0B\u7EBF\u4E8B\u4EF6-\u4E1A\u52A1\u903B\u8F91",n,Kn.DUPLICATE_LOGIN),n.reason===Kn.DUPLICATE_LOGIN?(s.value=Io,he(a("error.logout.tips3"),a("error.logout.tips3")),K.value=!0):(he(a("error.logout.title"),a("error.logout.tips5")),K.value=!0),j.value=!0,B==null||B.logout())},bn=()=>{u.updateSocketStatus(1)},Cn=async n=>{var W,te;const r={conversationId:`${n.chatType}_${n.targetId}`,...n,status:1,unreadCount:0},{targetAvatarUrl:v}=n;if(v&&Yn(v))try{const U=await Jn({objectKeys:[v]});(te=(W=U==null?void 0:U.data)==null?void 0:W[v])!=null&&te.previewUrl&&(r.targetAvatarUrl=U.data[v].previewUrl)}catch(U){console.error("\u8F6C\u6362\u5B58\u50A8\u6876key\u4E3A\u9884\u89C8URL\u5931\u8D25:",U)}await d(r);const A=`${n.chatType}_${n.chatType===Z.GROUP_CHAT?n.targetId:n.senderId}`;await m({chatType:n.chatType,recipientId:n.targetId,content:n.content,fingerPrint:n.fp,messageType:n.messageType,sendTime:n.sendTime,senderId:ve.SERVER,parentId:A,status:0,name:"",avatarUrl:""},!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==A);const L=await w();h.updateConversationList(L)},yn=async n=>{var W,te;console.log("\u7FA4\u7EC4\u4FE1\u606F\u66F4\u65B0\u4E8B\u4EF6",n,h.conversationList);const r=h.conversationList.find(U=>U.conversationId===`${Z.GROUP_CHAT}_${n.groupId}`);console.log("\u7FA4\u7EC4\u4FE1\u606F\u66F4\u65B0\u4E8B\u4EF6-conversation",r);const{avatarUrl:v,groupName:A}=n;let L=v;if(L&&Yn(L))try{const U=await Jn({objectKeys:[L]});(te=(W=U==null?void 0:U.data)==null?void 0:W[L])!=null&&te.previewUrl&&(L=U.data[L].previewUrl)}catch(U){console.error("\u8F6C\u6362\u5B58\u50A8\u6876key\u4E3A\u9884\u89C8URL\u5931\u8D25:",U)}h.updateConversations({...r,targetAvatarUrl:L,targetName:A}),c.emit("group-info-change")},Is=async n=>{const r=await C.filterMemberInfoByUserId(n.senderId);Ne(a("notification.title"),n.content,r==null?void 0:r.avatarUrl)},In=async n=>{let r;if(n.chatType===Z.GROUP_CHAT)console.log("\u63A5\u6536\u804A\u5929\u4FE1\u606F-\u7FA4\u804A",n),r={...n,parentId:`${n.chatType}_${n.recipientId}`};else if(n.chatType===Z.PRIVATE_CHAT){console.log("\u63A5\u6536\u804A\u5929\u4FE1\u606F-\u5355\u804A");const A=await C.filterMemberInfoByUserId(n.senderId);r={...n,parentId:`${n.chatType}_${n.senderId}`,sendId:n.senderId,name:A==null?void 0:A.name,avatarUrl:A==null?void 0:A.avatarUrl}}m(r,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==r.parentId);const v=await w();h.updateConversationList(v),c.emit("group-info-change"),Is(n)},Tn=n=>{C.updateMemberStatus(n,!0)},wn=n=>{C.updateMemberStatus(n,!1)},En=()=>{ln(),un()},Sn=n=>{console.log("\u7FA4\u6210\u5458\u8E22\u51FA\u4E8B\u4EF6-handleChatGroupMemberRemoved",n),m(n,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==n.parentId),c.emit("group-info-change",n)},Mn=async n=>{console.log("\u7FA4\u6210\u5458\u9080\u8BF7\u4E8B\u4EF6\uFF1AhandleChatGroupMemberInvited",n),await m(n,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==n.parentId),c.emit("group-info-change",n)},$n=n=>{console.log("\u7FA4\u4E3B\u53D8\u66F4\u4E8B\u4EF6\uFF1AhandleChatGroupMasterChanged",n),m(n,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==n.parentId),c.emit("group-info-change",n)},An=n=>{console.log("\u7FA4\u5931\u6548\u4E8B\u4EF6\uFF1AhandleChatGroupDisbanded",n),m(n,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==n.parentId),c.emit("group-info-change",n)},kn=n=>{m(n,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==n.parentId),c.emit("group-info-change",n)},On=n=>{B.sendAckMessage(n)},Rn=n=>{console.log("\u53D1\u9001\u804A\u5929\u6D88\u606F",n),B.sendMessage(n)},Nn=n=>{B.sendChatReceivedMessageReadEvent({targetId:n.targetId,chatType:n.chatType})},Ln=()=>{u.updateSocketStatus(1)},It=()=>{u.notificationId&&Ie.remove(u.notificationId)},Ts=async()=>{c.on("ChatWsOpen",mn),c.on("ChatLoginSuccess",gn),c.on("ChatWsClose",Ln),c.on("im-ws-reconnect-start",pn),c.on("im-ws-reconnect-failed",hn),c.on("ChatWsError",bn),c.on("ChatTokenExpirationDate",it),c.on("ChatLogoutSucceed",vn),c.on("ChatKickOut",_n),c.on("GroupCreatedEvent",Cn),c.on("GroupChatGroupInfoUpdated",yn),c.on("ChatImSendAckMessage",On),c.on("ChatSendMessage",Rn),c.on("ChatConversationRead",Nn),c.on("ChatMessageReceive",In),c.on("ChatGroupMemberRemoved",Sn),c.on("ChatGroupMemberInvited",Mn),c.on("ChatGroupMasterChanged",$n),c.on("ChatGroupDisbanded",An),c.on("ChatGroupMemberQuit",kn),c.on("ChatUserOnline",Tn),c.on("ChatUserOffline",wn),c.on("ChatContactUpdated",En),c.on("Chat-answer-agree",ge),c.on("Chat-answer-hangup",ge),c.on("Chat-Other-Client-Joined-Meeting",on),c.on("Chat-upcoming-meeting-join",an),c.on("navbar-show-ar-login-qr-code",rt),c.on("meeting-notification-close",It)},ws=async()=>{c.off("ChatWsOpen",mn),c.off("ChatLoginSuccess",gn),c.off("ChatWsClose",Ln),c.off("im-ws-reconnect-start",pn),c.off("im-ws-reconnect-failed",hn),c.off("ChatWsError",bn),c.off("ChatTokenExpirationDate",it),c.off("ChatLogoutSucceed",vn),c.off("ChatKickOut",_n),c.off("GroupCreatedEvent",Cn),c.off("GroupChatGroupInfoUpdated",yn),c.off("ChatImSendAckMessage",On),c.off("ChatSendMessage",Rn),c.off("ChatConversationRead",Nn),c.off("ChatMessageReceive",In),c.off("ChatGroupMemberRemoved",Sn),c.off("ChatGroupMemberInvited",Mn),c.off("ChatGroupMasterChanged",$n),c.off("ChatGroupDisbanded",An),c.off("ChatGroupMemberQuit",kn),c.off("ChatUserOnline",Tn),c.off("ChatUserOffline",wn),c.off("ChatContactUpdated",En),c.off("Chat-answer-agree",ge),c.off("Chat-answer-hangup",ge),c.off("Chat-Other-Client-Joined-Meeting",on),c.off("Chat-upcoming-meeting-join",an),c.off("navbar-show-ar-login-qr-code",rt),c.off("meeting-notification-close",It),c.off("invitation-join-meeting",yt)},Es=async()=>{console.log("\u5373\u65F6\u901A\u8BAF-\u521D\u59CB\u5316\u5EFA-websocket"),u.updateSocketStatus(2);let n="";Ue()?n=`wss://${lt()}/chat-socket`:n=`wss://${lt()}/chat-socket`,B=new Ir({wssUrl:n,userId:I.userId,token:Mt()}),B.initChatWss(),Ts()},Ss=()=>{be(),at()};be=async()=>{Cs(),k.value&&await k.value.logout(),f.updateThImEvent(null)},at=()=>{ws(),B&&B.logout(),h.updateChatImEvent(null)};const Tt=()=>{window.open("/assist/#/NoPermission","_self")},wt=async()=>{if(u.updateSocketStatus(2),O.value+=1,O.value>3){if(he(a("error.logout.title1"),a("error.logout.tips4")),j.value)return;j.value=!0;return}const[n,r]=await Promise.all([await ln(),await un()]);if(console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E-memberRes&groupListRes",n,r),n.code===403||r.code===403){Tt();return}if(n.code===200&&r.code===200){const v=await gs();console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E-conversationRes",v),v.code===200?(await vs(),Es(),O.value=0):wt()}else(n.code!==401||r.code!==401)&&wt()},Et=()=>{console.log("handleNetworkStatusChange",navigator.onLine),u.updateNetworkStatus(navigator.onLine),C.updateMemberStatus({client:ve.PC,userId:I.userId},navigator.onLine)},Pn=()=>{Et()},Un=()=>{Et()},Ms=()=>{window.addEventListener("online",Pn),window.addEventListener("offline",Un)},$s=()=>{window.removeEventListener("online",Pn),window.removeEventListener("offline",Un)},Dn=async()=>{var n;if(console.log(sessionStorage.getItem("refreshTokenStatus")),sessionStorage.getItem("refreshTokenStatus")!=="1"){sessionStorage.setItem("refreshTokenStatus","1");const r=await I.userResetLogin({refresh_token:$t()?$t():""});sessionStorage.setItem("refreshTokenStatus","0"),r.code===200?(Wn(r.data.tokenType),qn(r.data.token),zn(r.data.refreshToken),B&&k.value?(B==null||B.refreshToken({token:r.data.token}),(n=k.value)==null||n.refreshToken({token:r.data.token})):window.location.reload()):(wo(),y.push({path:"/login"}))}},xn=()=>{j.value||(he(a("error.logout.title1"),a("error.logout.tips6")),j.value=!0)},As=()=>{c.on("sys-user-reset-login",Dn),c.on("sys-application-disabled",xn),c.on("sys-no-permission-access",Tt)},ks=()=>{c.off("sys-user-reset-login",Dn),c.off("sys-application-disabled",xn),c.off("sys-no-permission-access",Tt)};window.addEventListener("storage",n=>{if(window.location.hash.includes("#/invitation"))return;const v=N(Mt()),A=ma(),L=ga();n.key==="token"&&(A!==L?y.push({name:"login"}):(v.value=n.newValue,window.location.reload())),n.key==="ASSIST_APP"&&A!==L&&y.push({name:"login"})});async function Os(){const n=await f.getLanguageList(),r=await f.getIndustryList();n.code===200&&r.code===200&&(f.updateLanguageList(n.data),f.updateIndustryList(r.data))}return et(async()=>{t(),As(),Et(),Ms(),c.on("invitation-join-meeting",yt),console.log("\u5DF2\u6CE8\u518C invitation-join-meeting \u4E8B\u4EF6\u76D1\u542C\u5668"),S.value||(console.log("\u9996\u6B21\u52A0\u8F7D\u91CD\u8981\u6570\u636E"),await b(),await wt()),S.value=!0,Os()}),dt(()=>{ks(),Ss(),It(),$s(),c.off("invitation-join-meeting",yt),O.value=0,S.value=!1,K.value=!1}),va(),(n,r)=>{const v=Ha,A=Wa,L=qa,W=za,te=De,U=Po;return E(),F(W,{class:Bt({layout:!0,mobile:M(g).hideMenu,"remote-micro-app-layout":Ae.value})},{default:_(()=>[R.value&&!Ae.value?(E(),z("div",nf,[p(Ju)])):Q("",!0),p(W,null,{default:_(()=>[p(W,null,{default:_(()=>[q.value?Uo((E(),F(v,{key:0,class:"layout-sider",breakpoint:"xl",collapsed:mt.value,collapsible:!0,width:Ce.value,style:Qn({paddingTop:R.value?"60px":""}),"hide-trigger":!0,onCollapse:We},{default:_(()=>[i("div",of,[p(Dt)])]),_:1},8,["collapsed","width","style"])),[[Do,!He.value]]):Q("",!0),He.value?(E(),F(A,{key:1,visible:Oe.value,placement:"left",footer:!1,"mask-closable":"",closable:!1,onCancel:Re},{default:_(()=>[p(Dt)]),_:1},8,["visible"])):Q("",!0),p(W,{class:"layout-content",style:Qn(ke.value)},{default:_(()=>[M(g).tabBar?(E(),F(fd,{key:0})):Q("",!0),p(L,null,{default:_(()=>[p(tf)]),_:1})]),_:1},8,["style"])]),_:1})]),_:1}),p(U,{visible:j.value,"onUpdate:visible":r[0]||(r[0]=X=>j.value=X),closable:!1,"esc-to-close":!1,"hide-cancel":!0,"mask-closable":!1,footer:!1},{default:_(()=>[i("div",sf,[i("div",af,[(E(),F(Je(M(br))))]),i("div",rf,[i("div",cf,[i("span",null,$(se.value),1)])]),i("div",lf,$($e.value),1),i("div",uf,[p(te,{type:"primary",onClick:qe},{default:_(()=>[ae($(n.$t("error.logout.btn.label1")),1)]),_:1})])])]),_:1},8,["visible"]),p(U,{visible:Y.value,"onUpdate:visible":r[1]||(r[1]=X=>Y.value=X),"modal-class":"custom-modal",width:"398px",closable:!1,"esc-to-close":!1,"hide-cancel":!0,"mask-closable":!1,footer:!1},{default:_(()=>[i("div",df,[i("div",ff,[(E(),F(Je(M(cr))))]),i("div",pf,[i("div",hf,[i("span",null,$(n.$t("error.logout.tip10")),1)])]),i("div",mf,$(n.$t("error.logout.tip9"))+" ("+$(_e.value)+"/30)",1),i("div",gf,[i("div",vf,[p(te,{type:"outline",onClick:_t},{default:_(()=>[ae($(n.$t("error.logout.btn.label2")),1)]),_:1})]),i("div",_f,[p(te,{type:"primary",onClick:qe},{default:_(()=>[ae($(n.$t("error.logout.btn.label3")),1)]),_:1})])])])]),_:1},8,["visible"]),p(U,{visible:fe.value,"onUpdate:visible":r[2]||(r[2]=X=>fe.value=X),"modal-class":"custom-modal",width:"398px",closable:!1,"esc-to-close":!1,"hide-cancel":!0,"mask-closable":!1,footer:!1},{default:_(()=>[i("div",bf,[i("div",Cf,[(E(),F(Je(M(pr))))]),i("div",yf,[i("div",If,[i("span",null,$(n.$t("error.logout.tip11")),1)])]),i("div",Tf,[i("div",wf,[p(te,{type:"outline",onClick:_s},{default:_(()=>[ae($(n.$t("error.logout.btn.label4")),1)]),_:1})]),i("div",Ef,[p(te,{type:"primary",onClick:qe},{default:_(()=>[ae($(n.$t("error.logout.btn.label3")),1)]),_:1})])])])]),_:1},8,["visible"]),pe.value?(E(),F(U,{key:1,visible:pe.value,"onUpdate:visible":r[3]||(r[3]=X=>pe.value=X),footer:!1,closable:!1,class:"customModal"},{default:_(()=>[pe.value?(E(),F(Cd,{key:0,onHandleClose:nn,onHandleJoinMeeting:ds})):Q("",!0)]),_:1},8,["visible"])):Q("",!0),M(f).upcomingMeetingVisible?(E(),z("div",Sf,[M(f).upcomingMeetingVisible?(E(),F(Ld,{key:0,ref_key:"upcomingModalRef",ref:Ve},null,512)):Q("",!0)])):Q("",!0),ne.value?(E(),F(U,{key:3,visible:ne.value,"onUpdate:visible":r[4]||(r[4]=X=>ne.value=X),footer:!1,closable:!1,class:"customModal"},{default:_(()=>[ne.value?(E(),F(tr,{key:0,onHandleClose:bt,onHandleJoinMeeting:Ct})):Q("",!0)]),_:1},8,["visible"])):Q("",!0),me.value?(E(),F(U,{key:4,visible:me.value,"onUpdate:visible":r[5]||(r[5]=X=>me.value=X),footer:!1,closable:!1,class:"customModal"},{default:_(()=>[me.value?(E(),F(Vd,{key:0,onHandleClose:gt})):Q("",!0)]),_:1},8,["visible"])):Q("",!0)]),_:1},8,["class"])}}});const Bf=le(Af,[["__scopeId","data-v-b7a0ac39"]]);export{Bf as default};
