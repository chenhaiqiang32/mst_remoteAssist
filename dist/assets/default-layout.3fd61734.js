var As=Object.defineProperty;var Os=(e,t,n)=>t in e?As(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var q=(e,t,n)=>(Os(e,typeof t!="symbol"?t+"":t,n),n);import{u as Xe,f as Co,E as c,P as Y,h as P,A as Tt,L as T,j as ks,T as Rs,k as Ns,K as Ls,U as Ps,l as Us,G as Ds,C as J,M as Le,m as xs,n as js,o as ve,p as Bs,q as Gs,r as Fs,t as Vs,w as Hs,H as Dn,x as ye,y as xn,z as jn,B as Bn,D as Gn,F as Fn,I as Ws,J as qs,N as je,v as Ee,i as Ue,O as yo,_ as ce,d as Pt,Q as Io,R as zs,e as $t,S as Js,V as Ks,W as Qs,X as Zs,Y as Ys,Z as Xs,$ as ea,a0 as Ut,a1 as ta,a2 as na,a3 as oa,a4 as sa,a5 as aa,a6 as ra,a7 as ia,a8 as ca,a9 as To,aa as wo,ab as la,ac as ua,ad as da,g as wt,ae as pa,af as fa,ag as ha,ah as Pe,ai as j,aj as Et,a as Vn,b as Hn,c as Wn,ak as qn,al as ma}from"./index.351d8474.js";/* empty css              */import{C as E,D as H,E as i,H as ga,c as G,d as ae,j as N,aI as f,bm as va,bn as Eo,h as _a,bo as ba,bp as Ca,bq as ya,b as ut,u as M,aN as $,aH as v,aM as ne,aW as V,bj as Ia,bc as Ta,bd as wa,aX as De,i as Ea,w as So,aE as B,aF as z,aK as Je,aJ as At,F as Dt,Q as Sa,b8 as Mo,b9 as $o,br as Ao,bs as Oo,bt as Ma,bu as $a,be as ko,a$ as xt,b0 as jt,b2 as Ro,b3 as No,a0 as Aa,bv as Oa,b4 as ka,a2 as Ra,bw as Na,bx as La,o as et,by as Pa,bh as Ua,bz as Ke,bA as Da,bB as xa,p as ja,G as zn,bC as Ie,bD as Ba,aZ as Ga,bE as Fa,bF as Va}from"./arco.638965b6.js";import{f as tt,h as Lo,i as Ha}from"./vue.6265044a.js";import{i as nt,b as ot,r as le,a as st,f as Wa,S as Jn,c as qa,o as za,d as Ja,e as Po,g as Ka}from"./icon_volume_1.fb774a2c.js";import{l as Qa,j as Za}from"./html2canvas.esm.31d03083.js";import{l as Ya}from"./logo.fa0f260a.js";import{c as Uo}from"./icon_close.f7fee805.js";import"./chart.ffc0c533.js";function Do(){const e=tt(),t=Xe();return{logout:async s=>{await t.logout();const a=e.currentRoute.value;Co(),e.push({name:s&&typeof s=="string"?s:"login",query:{...e.currentRoute.value.query,redirect:a.name}}),window.location.reload()}}}const Xa={width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},er=i("rect",{width:"56",height:"56",rx:"8",fill:"#0267FF"},null,-1),tr=i("path",{d:"m28.065 31.061-2.238 1.965a1.48 1.48 0 0 1-.121 2.102l-5.597 4.91a1.509 1.509 0 0 1-2.117-.136l-3.994-4.478a1.48 1.48 0 0 1 .12-2.102l5.597-4.91a1.51 1.51 0 0 1 2.118.136l2.239-1.964-.999-1.12c-1.103-1.236-2.999-1.36-4.235-.274l-7.835 6.876a2.96 2.96 0 0 0-.242 4.203l5.99 6.717c1.104 1.236 3 1.36 4.236.274l7.835-6.876a2.96 2.96 0 0 0 .242-4.203l-.999-1.12Zm17.719-5.69-3.344-8.368c-.615-1.54-2.355-2.306-3.887-1.71l-9.704 3.774c-1.53.596-2.273 2.327-1.658 3.867l.557 1.395 2.773-1.079a1.478 1.478 0 0 1 .83-1.933l6.93-2.696a1.511 1.511 0 0 1 1.944.855l2.229 5.579a1.477 1.477 0 0 1-.83 1.933l-6.93 2.696a1.511 1.511 0 0 1-1.944-.855l-2.773 1.078.558 1.395c.615 1.54 2.355 2.306 3.886 1.71l9.705-3.774c1.53-.596 2.273-2.327 1.658-3.867ZM21.59 32.75c.552.619 1.5.68 2.118.138l3.398-2.982-2.031-2.21-3.364 2.953a1.48 1.48 0 0 0-.12 2.102Zm11.988-5.856a1.478 1.478 0 0 0 .83-1.933 1.511 1.511 0 0 0-1.944-.856l-4.126 1.605 1.035 2.82 4.205-1.636Zm-5.287-14.252L27.012 12l-1.755 4.747 1.28.642 1.755-4.746Zm-7.508 9.286-.293-1.498-6.337 1.227.291 1.499 6.34-1.228Zm2.015-4.074-2.662-5.037-1.305.814 2.661 5.037 1.306-.814Z",fill:"#fff"},null,-1),nr=[er,tr];function or(e,t){return E(),H("svg",Xa,[...nr])}const sr={render:or},ar={width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},rr=ga('<rect width="56" height="56" rx="8" fill="#FF3939"></rect><g fill="#fff"><path d="M28 10c9.941 0 18 8.059 18 18s-8.059 18-18 18-18-8.059-18-18 8.059-18 18-18Zm0 2.667c-8.468 0-15.333 6.865-15.333 15.333S19.532 43.333 28 43.333 43.333 36.468 43.333 28 36.468 12.667 28 12.667Z"></path><path d="M36.6 19.276c.629.629.629 1.257 0 1.886L21.162 36.6c-.629.629-1.257.629-1.886 0-.628-.628-.628-1.257 0-1.885l15.439-15.439c.628-.628 1.257-.628 1.885 0Z"></path><path d="M19.276 19.276c.629-.628 1.257-.628 1.886 0L36.6 34.715c.629.628.629 1.257 0 1.885-.628.629-1.257.629-1.885 0L19.276 21.162c-.628-.629-.628-1.257 0-1.886Z"></path></g>',2),ir=[rr];function cr(e,t){return E(),H("svg",ar,[...ir])}const lr={render:cr},ur={height:"56",viewBox:"0 0 56 56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},dr=i("circle",{cx:"28",cy:"28",r:"28",fill:"#FF1500"},null,-1),pr=i("path",{d:"M25.607 34a2.432 2.432 0 0 0 4.79 0l1.596-22a4.012 4.012 0 0 0-1.171-2.826A3.996 3.996 0 0 0 28.002 8a4.095 4.095 0 0 0-2.935 1.345A4.112 4.112 0 0 0 24.01 12.4L25.607 34Zm2.395 6a3.986 3.986 0 0 0-3.688 2.47 4.008 4.008 0 0 0 .865 4.358A3.988 3.988 0 0 0 31.993 44a3.786 3.786 0 0 0-1.098-2.9 3.77 3.77 0 0 0-2.893-1.1Z",fill:"#fff"},null,-1),fr=[dr,pr];function hr(e,t){return E(),H("svg",ur,[...fr])}const mr={render:hr};class gr{constructor(t){q(this,"websocket",null);q(this,"reconnectTimeout");q(this,"retryCount",0);q(this,"maxRetries",30);q(this,"initialReconnectDelay",3e3);q(this,"maxReconnectDelay",6e4);q(this,"wsUrl");q(this,"isConnected",!1);q(this,"isReConnect",!0);this.wsUrl=t,this.connect()}connect(){this.websocket||(console.log("222222222wsUrl>>>>",this.wsUrl),this.websocket=new WebSocket(this.wsUrl),this.websocket.binaryType="arraybuffer",this.websocket.addEventListener("open",this.onOpen.bind(this)),this.websocket.addEventListener("message",this.onMessage.bind(this)),this.websocket.addEventListener("close",this.onClose.bind(this)),this.websocket.addEventListener("error",this.onError.bind(this)))}onOpen(){console.log("\u5373\u65F6\u901A\u8BAF-WebSocket-websocketService connection open"),this.isConnected=!0,this.retryCount=0,this.clearReconnectTimeout(),c.emit("im-ws-open")}onMessage(t){const n=new Uint8Array(t.data);c.emit("im-ws-message",{data:n,_self:this})}onClose(t){console.log(`IM-Connection closed with code: ${t.code}`),this.isReConnect&&this.reconnect()}onError(t){console.error("IM-WebSocket error",t),c.emit("im-ws-error",{error:t,event:this})}reconnect(){if(!this.isReConnect){console.log("Max retries reached or reconnection is disabled.");return}if(console.log(`IM WebSocket reconnecting in ${this.initialReconnectDelay} ms... \u91CD\u8BD5\u6B21\u6570\uFF1A`,this.retryCount),this.retryCount>this.maxRetries){this.stopReconnect(),c.emit("im-ws-reconnect-failed");return}this.websocket=null,c.emit("im-ws-reconnect-start",{retryCount:this.retryCount}),this.reconnectTimeout=window.setTimeout(()=>{this.retryCount+=1,this.connect()},this.initialReconnectDelay)}stopReconnect(){console.log("IM WebSocket stop reconnect"),this.isReConnect=!1,this.retryCount=0,this.clearReconnectTimeout()}clearReconnectTimeout(){this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0)}sendMessage(t){this.websocket&&this.isConnected?this.websocket.send(t):console.warn("WebSocket is not connected. Message not sent.",t)}close(){console.log("IM WebSocket close"),this.stopReconnect(),this.websocket&&(this.websocket.close(),this.websocket=null)}}const vr=e=>new gr(e);class _r{constructor(t){q(this,"webSocketService",null);q(this,"wssUrl");q(this,"userId");q(this,"token");q(this,"intervalHeart",null);q(this,"lastLoginTime");q(this,"messageMap",new Map);const{wssUrl:n,userId:s,token:a}=t;this.wssUrl=n,this.userId=s,this.token=a,this.handleChatWsOpen=this.handleChatWsOpen.bind(this),this.handleChatWsMessage=this.handleChatWsMessage.bind(this),this.handleChatWsClose=this.handleChatWsClose.bind(this),this.handleChatWsError=this.handleChatWsError.bind(this)}handleChatWsOpen(){c.emit("ChatWsOpen","Chat WebSocket connection opened")}handleChatWsMessage(t){const{data:n}=t;console.log("chat-message--handleChatWsMessage",n);const s=Y.decode(n);if(P.ACK===s.type){const a=Tt.decode(s.event),l=this.messageMap.get(a.fp);console.log("ChatPB.EventType.ACK",l),l&&(this.messageMap.delete(a.fp),c.emit("ChatMessageStatus",{fp:a.fp,status:!0}))}if(P.ACK!==s.type&&P.HEARTBEAT_PONG!==s.type&&this.sendAckMessage({fp:s.fp,timestamp:T.fromValue(s.timestamp).toNumber()}),P.LOGIN_SUCCEED===s.type){const a=ks.decode(s.event);this.lastLoginTime=T.fromValue(a.lastLoginTime).toNumber(),console.log("\u5373\u65F6\u901A\u8BAF-websocket-\u767B\u5F55\u6210\u529F-\u670D\u52A1\u7AEF\u8FD4\u56DE\u503C",{...a,lastLoginTime:T.fromValue(a.lastLoginTime).toNumber()}),c.emit("ChatLoginSuccess",{...a,lastLoginTime:T.fromValue(a.lastLoginTime).toNumber()}),this.heartInterval()}if(P.TOKEN_EXPIRATION_DATE===s.type){const a=Rs.decode(s.event);console.log("\u63A5\u6536\u5230Token\u4E8B\u4EF6-TOKEN_EXPIRATION_DATE",a),c.emit("ChatTokenExpirationDate",a)}if(P.LOGOUT_SUCCEED===s.type){const a=Ns.decode(s.event);console.log("\u63A5\u6536\u5230\u767B\u51FA\u6210\u529F\u4E8B\u4EF6-LOGOUT_SUCCEED",a),c.emit("ChatLogoutSucceed",a)}if(P.KICK_OUT===s.type){const a=Ls.decode(s.event);console.log("\u8E22\u4E0B\u7EBF\u4E8B\u4EF6-KICK_OUT",a),c.emit("ChatKickOut",a)}if(P.CONTACT_UPDATED===s.type&&(console.log("\u901A\u8BAF\u5F55\u53D1\u751F\u53D8\u5316-CONTACT_UPDATED",s),c.emit("ChatContactUpdated")),P.CHAT_USER_ONLINE===s.type){const a=Ps.decode(s.event);c.emit("ChatUserOnline",{client:a.client,userId:T.fromValue(a.userId).toNumber()})}if(P.CHAT_USER_OFFLINE===s.type){const a=Us.decode(s.event);console.log("\u7528\u6237\u4E0B\u7EBF-CHAT_USER_OFFLINE",a,{client:a.client,userId:T.fromValue(a.userId).toNumber()}),c.emit("ChatUserOffline",{client:a.client,userId:T.fromValue(a.userId).toNumber()})}if(P.CHAT_GROUP_CREATED===s.type){const a=Ds.decode(s.event);console.log("\u7FA4\u7EC4\u521B\u5EFA\u4E8B\u4EF6-CHAT_GROUP_CREATED-dataContent",a);const l=[];a.userIds.forEach(m=>{l.push(T.fromValue(m).toNumber())});const d={eventType:s.type,eventData:{...a,groupId:T.fromValue(a.groupId).toNumber(),masterId:T.fromValue(a.masterId).toNumber(),timestamp:T.fromValue(a.timestamp).toNumber(),userIds:l}};c.emit("GroupCreatedEvent",{fp:s.fp,targetId:T.fromValue(a.groupId).toNumber(),chatType:J.GROUP_CHAT,targetAvatarUrl:a.avatarUrl,targetName:a.groupName,name:"",messageType:Le.SYSTEM,content:JSON.stringify(d),sendTime:T.fromValue(a.timestamp).toNumber(),unreadCount:0})}if(P.CHAT_GROUP_INFO_UPDATED===s.type){const a=xs.decode(s.event);console.log("\u7FA4\u7EC4\u4FE1\u606F\u66F4\u65B0\u4E8B\u4EF6-CHAT_GROUP_INFO_UPDATED",a),c.emit("GroupChatGroupInfoUpdated",{...a,groupId:T.fromValue(a.groupId).toNumber()})}if(P.CHAT_GROUP_MEMBER_REMOVED===s.type){const a=js.decode(s.event);console.log("\u7FA4\u7EC4\u6210\u5458\u8E22\u51FA\u4E8B\u4EF6-CHAT_GROUP_MEMBER_REMOVED-dataContent",a);const l=[];a.removedUserIds.forEach(m=>{l.push(T.fromValue(m).toNumber())});const d={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),masterId:T.fromValue(a.masterId).toNumber(),removedUserIds:l}};c.emit("ChatGroupMemberRemoved",{fingerPrint:s.fp,chatType:J.GROUP_CHAT,content:JSON.stringify(d),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${J.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(P.CHAT_GROUP_MEMBER_INVITED===s.type){const a=Bs.decode(s.event);console.log("\u7FA4\u7EC4\u9080\u8BF7\u6210\u5458\u4E8B\u4EF6-CHAT_GROUP_MEMBER_INVITED",a);const l=[];a.invitedUserIds.forEach(m=>{l.push(T.fromValue(m).toNumber())});const d={eventType:s.type,eventData:{...a,timestamp:T.fromValue(a.timestamp).toNumber,groupId:T.fromValue(a.groupId).toNumber(),groupName:a.groupName,inviteeUserIds:l,invitorUserId:T.fromValue(a.invitorUserId).toNumber()}};c.emit("ChatGroupMemberInvited",{fingerPrint:s.fp,chatType:J.GROUP_CHAT,content:JSON.stringify(d),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${J.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(P.CHAT_GROUP_MASTER_CHANGED===s.type){const a=Gs.decode(s.event);console.log("\u7FA4\u4E3B\u53D8\u66F4\u4E8B\u4EF6-CHAT_GROUP_MASTER_CHANGED",a);const l={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),newMasterId:T.fromValue(a.newMasterId).toNumber(),oldMasterId:T.fromValue(a.oldMasterId).toNumber()}};c.emit("ChatGroupMasterChanged",{fingerPrint:s.fp,chatType:J.GROUP_CHAT,content:JSON.stringify(l),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${J.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(P.CHAT_GROUP_DISBANDED===s.type){const a=Fs.decode(s.event);console.log("\u7FA4\u89E3\u6563\u4E8B\u4EF6-CHAT_GROUP_DISBANDED",a);const l={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),masterId:T.fromValue(a.masterId).toNumber(),timestamp:T.fromValue(a.timestamp).toNumber()}};c.emit("ChatGroupDisbanded",{fingerPrint:s.fp,chatType:J.GROUP_CHAT,content:JSON.stringify(l),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${J.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(P.CHAT_GROUP_MEMBER_QUIT===s.type){const a=Vs.decode(s.event);console.log("\u7FA4\u7EC4\u4EBA\u5458\u9000\u51FA-CHAT_GROUP_MEMBER_QUIT-dataContent",a);const l={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),quitUserId:T.fromValue(a.quitUserId).toNumber(),timestamp:T.fromValue(a.timestamp).toNumber()}};c.emit("ChatGroupMemberQuit",{fingerPrint:s.fp,chatType:J.GROUP_CHAT,content:JSON.stringify(l),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${J.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(P.CHAT_MESSAGE_RECEIVED===s.type){const a=Hs.decode(s.event);console.log("\u6D88\u606F\u63A5\u6536\u4E8B\u4EF6-CHAT_MESSAGE_RECEIVED",a),this.sendAckMessage({fp:s.fp,timestamp:T.fromValue(a.timestamp).toNumber()}),c.emit("ChatMessageReceive",{fingerPrint:s.fp,chatType:a.chatType,content:a.content,messageType:a.messageType,recipientId:T.fromValue(a.recipientId).toNumber(),senderId:T.fromValue(a.senderId).toNumber(),sendTime:T.fromValue(a.timestamp).toNumber()})}}handleChatWsError(t){this.clearHeartInterval(),c.emit("ChatWsError",t)}handleChatWsClose(t){console.log("ChatWebSocket \u8FDE\u63A5\u5DF2\u5173\u95ED",t,this),this.clearHeartInterval(),c.emit("ChatWsClose","Chat WebSocket connection closed")}clearHeartInterval(){this.intervalHeart&&clearInterval(this.intervalHeart)}heartInterval(){this.intervalHeart=setInterval(()=>{if(!this.webSocketService){this.clearHeartInterval();return}const t=Date.now(),n=Dn.create(),s=Dn.encode(n).finish(),a=Y.create({type:P.HEARTBEAT_PING,fp:ye(),event:s,timestamp:t}),l=Y.encode(a).finish();this.webSocketService.sendMessage(l)},1e3*30)}login(){var d;let t;this.lastLoginTime?t=this.lastLoginTime:t=Date.now(),console.log("Chat-login----lastLoginTime",this.lastLoginTime);const n=xn.create({userId:this.userId,client:ve.PC,token:this.token,lastLoginTime:t}),s=xn.encode(n).finish(),a=Y.create({type:P.LOGIN_REQUEST,fp:ye(),event:s,timestamp:t}),l=Y.encode(a).finish();(d=this.webSocketService)==null||d.sendMessage(l)}refreshToken(t){console.log("Chat-refresh-token",t);const n=Date.now(),s=jn.create({token:t.token}),a=jn.encode(s).finish(),l=Y.create({type:P.TOKEN_REFRESH,fp:ye(),event:a,timestamp:n}),d=Y.encode(l).finish();this.webSocketService.sendMessage(d)}sendLogoutMessage(){const t=Date.now(),n=Bn.create(),s=Bn.encode(n).finish(),a=Y.create({type:P.LOGOUT_REQUEST,fp:ye(),event:s,timestamp:t}),l=Y.encode(a).finish();this.webSocketService.sendMessage(l)}logout(){this.webSocketService&&(this.clearHeartInterval(),this.handleOffEventBus(),this.sendLogoutMessage(),this.webSocketService.close())}handleOnEventBus(){c.on("im-ws-open",this.handleChatWsOpen),c.on("im-ws-message",this.handleChatWsMessage),c.on("im-ws-close",this.handleChatWsClose),c.on("im-ws-error",this.handleChatWsError)}handleOffEventBus(){c.off("im-ws-open",this.handleChatWsOpen),c.off("im-ws-message",this.handleChatWsMessage),c.off("im-ws-close",this.handleChatWsClose),c.off("im-ws-error",this.handleChatWsError)}initChatWss(){this.webSocketService=vr(this.wssUrl),this.webSocketService.connect(),this.handleOnEventBus()}chatWssReconnect(){this.webSocketService&&(this.webSocketService.stopReconnect(),this.initChatWss())}sendMessage(t){var g;const{fingerPrint:n,recipientId:s,chatType:a,messageType:l,content:d}=t,m=Date.now(),w=n||ye(),_=Gn.create({recipientId:s,chatType:a,messageType:l,content:d}),b=Gn.encode(_).finish(),S=Y.create({type:P.CHAT_MESSAGE_SEND,fp:w,event:b,timestamp:m}),O=Y.encode(S).finish();this.messageMap.set(w,{timestamp:m,retries:0,data:O}),(g=this.webSocketService)==null||g.sendMessage(O),this.retryMessage(w)}retryMessage(t){!this.messageMap.get(t)||setTimeout(()=>{const s=this.messageMap.get(t);if(!!s){if(s.retries>=3){this.messageMap.delete(t),c.emit("ChatMessageStatus",{fp:t,status:!1});return}console.log(`\u6B63\u5728\u91CD\u8BD5\u6D88\u606F ${t}, \u5C1D\u8BD5\u6B21\u6570 ${s.retries+1}`),this.webSocketService.sendMessage(s.data),this.messageMap.set(t,{...s,retries:s.retries+1}),this.retryMessage(t)}},3e3)}sendAckMessage(t){var m;const n=Date.now(),s=Tt.create(t),a=Tt.encode(s).finish(),l=Y.create({type:P.ACK,fp:ye(),event:a,timestamp:n}),d=Y.encode(l).finish();(m=this.webSocketService)==null||m.sendMessage(d)}sendChatReceivedMessageReadEvent(t){var m;const n=Date.now(),s=Fn.create(t),a=Fn.encode(s).finish(),l=Y.create({type:P.CHAT_MESSAGE_READ,fp:ye(),event:a,timestamp:n}),d=Y.encode(l).finish();(m=this.webSocketService)==null||m.sendMessage(d)}}function br(){return{accessRouter(e){var t,n,s,a;return!((t=e.meta)!=null&&t.requiresAuth)||!((n=e.meta)!=null&&n.roles)||((a=(s=e.meta)==null?void 0:s.roles)==null?void 0:a.includes("*"))},findFirstPermissionRoute(e,t="admin"){var s,a;const n=[...e];for(;n.length;){const l=n.shift();if((a=(s=l==null?void 0:l.meta)==null?void 0:s.roles)!=null&&a.find(d=>d.includes("*")||d.includes(t)))return{name:l.name};l!=null&&l.children&&n.push(...l.children)}return null}}}const Cr=[...Ws,...qs],yr=Cr.map(e=>{const{name:t,path:n,meta:s,redirect:a,children:l}=e;return{name:t,path:n,meta:s,redirect:a,children:l}}),Ir=yr;var Tr=Array.isArray;const Bt=Tr;var wr="[object AsyncFunction]",Er="[object Function]",Sr="[object GeneratorFunction]",Mr="[object Proxy]";function xo(e){if(!nt(e))return!1;var t=ot(e);return t==Er||t==Sr||t==wr||t==Mr}var $r=le["__core-js_shared__"];const St=$r;var Kn=function(){var e=/[^.]+$/.exec(St&&St.keys&&St.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Ar(e){return!!Kn&&Kn in e}var Or=Function.prototype,kr=Or.toString;function Se(e){if(e!=null){try{return kr.call(e)}catch{}try{return e+""}catch{}}return""}var Rr=/[\\^$.*+?()[\]{}|]/g,Nr=/^\[object .+?Constructor\]$/,Lr=Function.prototype,Pr=Object.prototype,Ur=Lr.toString,Dr=Pr.hasOwnProperty,xr=RegExp("^"+Ur.call(Dr).replace(Rr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function jr(e){if(!nt(e)||Ar(e))return!1;var t=xo(e)?xr:Nr;return t.test(Se(e))}function Br(e,t){return e==null?void 0:e[t]}function Me(e,t){var n=Br(e,t);return jr(n)?n:void 0}var Gr=Me(le,"WeakMap");const Ot=Gr;var Qn=Object.create,Fr=function(){function e(){}return function(t){if(!nt(t))return{};if(Qn)return Qn(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();const Vr=Fr;function Hr(e,t){var n=-1,s=e.length;for(t||(t=Array(s));++n<s;)t[n]=e[n];return t}var Wr=function(){try{var e=Me(Object,"defineProperty");return e({},"",{}),e}catch{}}();const Zn=Wr;function qr(e,t){for(var n=-1,s=e==null?0:e.length;++n<s&&t(e[n],n,e)!==!1;);return e}var zr=9007199254740991,Jr=/^(?:0|[1-9]\d*)$/;function Kr(e,t){var n=typeof e;return t=t==null?zr:t,!!t&&(n=="number"||n!="symbol"&&Jr.test(e))&&e>-1&&e%1==0&&e<t}function jo(e,t,n){t=="__proto__"&&Zn?Zn(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Bo(e,t){return e===t||e!==e&&t!==t}var Qr=Object.prototype,Zr=Qr.hasOwnProperty;function Go(e,t,n){var s=e[t];(!(Zr.call(e,t)&&Bo(s,n))||n===void 0&&!(t in e))&&jo(e,t,n)}function dt(e,t,n,s){var a=!n;n||(n={});for(var l=-1,d=t.length;++l<d;){var m=t[l],w=s?s(n[m],e[m],m,n,e):void 0;w===void 0&&(w=e[m]),a?jo(n,m,w):Go(n,m,w)}return n}var Yr=9007199254740991;function Fo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Yr}function Vo(e){return e!=null&&Fo(e.length)&&!xo(e)}var Xr=Object.prototype;function Gt(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Xr;return e===n}function ei(e,t){for(var n=-1,s=Array(e);++n<e;)s[n]=t(n);return s}var ti="[object Arguments]";function Yn(e){return st(e)&&ot(e)==ti}var Ho=Object.prototype,ni=Ho.hasOwnProperty,oi=Ho.propertyIsEnumerable,si=Yn(function(){return arguments}())?Yn:function(e){return st(e)&&ni.call(e,"callee")&&!oi.call(e,"callee")};const ai=si;function ri(){return!1}var Wo=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Xn=Wo&&typeof module=="object"&&module&&!module.nodeType&&module,ii=Xn&&Xn.exports===Wo,eo=ii?le.Buffer:void 0,ci=eo?eo.isBuffer:void 0,li=ci||ri;const qo=li;var ui="[object Arguments]",di="[object Array]",pi="[object Boolean]",fi="[object Date]",hi="[object Error]",mi="[object Function]",gi="[object Map]",vi="[object Number]",_i="[object Object]",bi="[object RegExp]",Ci="[object Set]",yi="[object String]",Ii="[object WeakMap]",Ti="[object ArrayBuffer]",wi="[object DataView]",Ei="[object Float32Array]",Si="[object Float64Array]",Mi="[object Int8Array]",$i="[object Int16Array]",Ai="[object Int32Array]",Oi="[object Uint8Array]",ki="[object Uint8ClampedArray]",Ri="[object Uint16Array]",Ni="[object Uint32Array]",U={};U[Ei]=U[Si]=U[Mi]=U[$i]=U[Ai]=U[Oi]=U[ki]=U[Ri]=U[Ni]=!0;U[ui]=U[di]=U[Ti]=U[pi]=U[wi]=U[fi]=U[hi]=U[mi]=U[gi]=U[vi]=U[_i]=U[bi]=U[Ci]=U[yi]=U[Ii]=!1;function Li(e){return st(e)&&Fo(e.length)&&!!U[ot(e)]}function Ft(e){return function(t){return e(t)}}var zo=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Qe=zo&&typeof module=="object"&&module&&!module.nodeType&&module,Pi=Qe&&Qe.exports===zo,Mt=Pi&&Wa.process,Ui=function(){try{var e=Qe&&Qe.require&&Qe.require("util").types;return e||Mt&&Mt.binding&&Mt.binding("util")}catch{}}();const xe=Ui;var to=xe&&xe.isTypedArray,Di=to?Ft(to):Li;const xi=Di;var ji=Object.prototype,Bi=ji.hasOwnProperty;function Jo(e,t){var n=Bt(e),s=!n&&ai(e),a=!n&&!s&&qo(e),l=!n&&!s&&!a&&xi(e),d=n||s||a||l,m=d?ei(e.length,String):[],w=m.length;for(var _ in e)(t||Bi.call(e,_))&&!(d&&(_=="length"||a&&(_=="offset"||_=="parent")||l&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||Kr(_,w)))&&m.push(_);return m}function Ko(e,t){return function(n){return e(t(n))}}var Gi=Ko(Object.keys,Object);const Fi=Gi;var Vi=Object.prototype,Hi=Vi.hasOwnProperty;function Wi(e){if(!Gt(e))return Fi(e);var t=[];for(var n in Object(e))Hi.call(e,n)&&n!="constructor"&&t.push(n);return t}function Vt(e){return Vo(e)?Jo(e):Wi(e)}function qi(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var zi=Object.prototype,Ji=zi.hasOwnProperty;function Ki(e){if(!nt(e))return qi(e);var t=Gt(e),n=[];for(var s in e)s=="constructor"&&(t||!Ji.call(e,s))||n.push(s);return n}function Ht(e){return Vo(e)?Jo(e,!0):Ki(e)}var Qi=Me(Object,"create");const Ze=Qi;function Zi(){this.__data__=Ze?Ze(null):{},this.size=0}function Yi(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Xi="__lodash_hash_undefined__",ec=Object.prototype,tc=ec.hasOwnProperty;function nc(e){var t=this.__data__;if(Ze){var n=t[e];return n===Xi?void 0:n}return tc.call(t,e)?t[e]:void 0}var oc=Object.prototype,sc=oc.hasOwnProperty;function ac(e){var t=this.__data__;return Ze?t[e]!==void 0:sc.call(t,e)}var rc="__lodash_hash_undefined__";function ic(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Ze&&t===void 0?rc:t,this}function we(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}we.prototype.clear=Zi;we.prototype.delete=Yi;we.prototype.get=nc;we.prototype.has=ac;we.prototype.set=ic;function cc(){this.__data__=[],this.size=0}function pt(e,t){for(var n=e.length;n--;)if(Bo(e[n][0],t))return n;return-1}var lc=Array.prototype,uc=lc.splice;function dc(e){var t=this.__data__,n=pt(t,e);if(n<0)return!1;var s=t.length-1;return n==s?t.pop():uc.call(t,n,1),--this.size,!0}function pc(e){var t=this.__data__,n=pt(t,e);return n<0?void 0:t[n][1]}function fc(e){return pt(this.__data__,e)>-1}function hc(e,t){var n=this.__data__,s=pt(n,e);return s<0?(++this.size,n.push([e,t])):n[s][1]=t,this}function ue(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}ue.prototype.clear=cc;ue.prototype.delete=dc;ue.prototype.get=pc;ue.prototype.has=fc;ue.prototype.set=hc;var mc=Me(le,"Map");const Ye=mc;function gc(){this.size=0,this.__data__={hash:new we,map:new(Ye||ue),string:new we}}function vc(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function ft(e,t){var n=e.__data__;return vc(t)?n[typeof t=="string"?"string":"hash"]:n.map}function _c(e){var t=ft(this,e).delete(e);return this.size-=t?1:0,t}function bc(e){return ft(this,e).get(e)}function Cc(e){return ft(this,e).has(e)}function yc(e,t){var n=ft(this,e),s=n.size;return n.set(e,t),this.size+=n.size==s?0:1,this}function Be(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}Be.prototype.clear=gc;Be.prototype.delete=_c;Be.prototype.get=bc;Be.prototype.has=Cc;Be.prototype.set=yc;function Qo(e,t){for(var n=-1,s=t.length,a=e.length;++n<s;)e[a+n]=t[n];return e}var Ic=Ko(Object.getPrototypeOf,Object);const Zo=Ic;function Tc(){this.__data__=new ue,this.size=0}function wc(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Ec(e){return this.__data__.get(e)}function Sc(e){return this.__data__.has(e)}var Mc=200;function $c(e,t){var n=this.__data__;if(n instanceof ue){var s=n.__data__;if(!Ye||s.length<Mc-1)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new Be(s)}return n.set(e,t),this.size=n.size,this}function Ge(e){var t=this.__data__=new ue(e);this.size=t.size}Ge.prototype.clear=Tc;Ge.prototype.delete=wc;Ge.prototype.get=Ec;Ge.prototype.has=Sc;Ge.prototype.set=$c;function Ac(e,t){return e&&dt(t,Vt(t),e)}function Oc(e,t){return e&&dt(t,Ht(t),e)}var Yo=typeof exports=="object"&&exports&&!exports.nodeType&&exports,no=Yo&&typeof module=="object"&&module&&!module.nodeType&&module,kc=no&&no.exports===Yo,oo=kc?le.Buffer:void 0,so=oo?oo.allocUnsafe:void 0;function Rc(e,t){if(t)return e.slice();var n=e.length,s=so?so(n):new e.constructor(n);return e.copy(s),s}function Nc(e,t){for(var n=-1,s=e==null?0:e.length,a=0,l=[];++n<s;){var d=e[n];t(d,n,e)&&(l[a++]=d)}return l}function Xo(){return[]}var Lc=Object.prototype,Pc=Lc.propertyIsEnumerable,ao=Object.getOwnPropertySymbols,Uc=ao?function(e){return e==null?[]:(e=Object(e),Nc(ao(e),function(t){return Pc.call(e,t)}))}:Xo;const Wt=Uc;function Dc(e,t){return dt(e,Wt(e),t)}var xc=Object.getOwnPropertySymbols,jc=xc?function(e){for(var t=[];e;)Qo(t,Wt(e)),e=Zo(e);return t}:Xo;const es=jc;function Bc(e,t){return dt(e,es(e),t)}function ts(e,t,n){var s=t(e);return Bt(e)?s:Qo(s,n(e))}function Gc(e){return ts(e,Vt,Wt)}function Fc(e){return ts(e,Ht,es)}var Vc=Me(le,"DataView");const kt=Vc;var Hc=Me(le,"Promise");const Rt=Hc;var Wc=Me(le,"Set");const Nt=Wc;var ro="[object Map]",qc="[object Object]",io="[object Promise]",co="[object Set]",lo="[object WeakMap]",uo="[object DataView]",zc=Se(kt),Jc=Se(Ye),Kc=Se(Rt),Qc=Se(Nt),Zc=Se(Ot),Te=ot;(kt&&Te(new kt(new ArrayBuffer(1)))!=uo||Ye&&Te(new Ye)!=ro||Rt&&Te(Rt.resolve())!=io||Nt&&Te(new Nt)!=co||Ot&&Te(new Ot)!=lo)&&(Te=function(e){var t=ot(e),n=t==qc?e.constructor:void 0,s=n?Se(n):"";if(s)switch(s){case zc:return uo;case Jc:return ro;case Kc:return io;case Qc:return co;case Zc:return lo}return t});const qt=Te;var Yc=Object.prototype,Xc=Yc.hasOwnProperty;function el(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&Xc.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var tl=le.Uint8Array;const po=tl;function zt(e){var t=new e.constructor(e.byteLength);return new po(t).set(new po(e)),t}function nl(e,t){var n=t?zt(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var ol=/\w*$/;function sl(e){var t=new e.constructor(e.source,ol.exec(e));return t.lastIndex=e.lastIndex,t}var fo=Jn?Jn.prototype:void 0,ho=fo?fo.valueOf:void 0;function al(e){return ho?Object(ho.call(e)):{}}function rl(e,t){var n=t?zt(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var il="[object Boolean]",cl="[object Date]",ll="[object Map]",ul="[object Number]",dl="[object RegExp]",pl="[object Set]",fl="[object String]",hl="[object Symbol]",ml="[object ArrayBuffer]",gl="[object DataView]",vl="[object Float32Array]",_l="[object Float64Array]",bl="[object Int8Array]",Cl="[object Int16Array]",yl="[object Int32Array]",Il="[object Uint8Array]",Tl="[object Uint8ClampedArray]",wl="[object Uint16Array]",El="[object Uint32Array]";function Sl(e,t,n){var s=e.constructor;switch(t){case ml:return zt(e);case il:case cl:return new s(+e);case gl:return nl(e,n);case vl:case _l:case bl:case Cl:case yl:case Il:case Tl:case wl:case El:return rl(e,n);case ll:return new s;case ul:case fl:return new s(e);case dl:return sl(e);case pl:return new s;case hl:return al(e)}}function Ml(e){return typeof e.constructor=="function"&&!Gt(e)?Vr(Zo(e)):{}}var $l="[object Map]";function Al(e){return st(e)&&qt(e)==$l}var mo=xe&&xe.isMap,Ol=mo?Ft(mo):Al;const kl=Ol;var Rl="[object Set]";function Nl(e){return st(e)&&qt(e)==Rl}var go=xe&&xe.isSet,Ll=go?Ft(go):Nl;const Pl=Ll;var Ul=1,Dl=2,xl=4,ns="[object Arguments]",jl="[object Array]",Bl="[object Boolean]",Gl="[object Date]",Fl="[object Error]",os="[object Function]",Vl="[object GeneratorFunction]",Hl="[object Map]",Wl="[object Number]",ss="[object Object]",ql="[object RegExp]",zl="[object Set]",Jl="[object String]",Kl="[object Symbol]",Ql="[object WeakMap]",Zl="[object ArrayBuffer]",Yl="[object DataView]",Xl="[object Float32Array]",eu="[object Float64Array]",tu="[object Int8Array]",nu="[object Int16Array]",ou="[object Int32Array]",su="[object Uint8Array]",au="[object Uint8ClampedArray]",ru="[object Uint16Array]",iu="[object Uint32Array]",L={};L[ns]=L[jl]=L[Zl]=L[Yl]=L[Bl]=L[Gl]=L[Xl]=L[eu]=L[tu]=L[nu]=L[ou]=L[Hl]=L[Wl]=L[ss]=L[ql]=L[zl]=L[Jl]=L[Kl]=L[su]=L[au]=L[ru]=L[iu]=!0;L[Fl]=L[os]=L[Ql]=!1;function lt(e,t,n,s,a,l){var d,m=t&Ul,w=t&Dl,_=t&xl;if(n&&(d=a?n(e,s,a,l):n(e)),d!==void 0)return d;if(!nt(e))return e;var b=Bt(e);if(b){if(d=el(e),!m)return Hr(e,d)}else{var S=qt(e),O=S==os||S==Vl;if(qo(e))return Rc(e,m);if(S==ss||S==ns||O&&!a){if(d=w||O?{}:Ml(e),!m)return w?Bc(e,Oc(d,e)):Dc(e,Ac(d,e))}else{if(!L[S])return a?e:{};d=Sl(e,S,m)}}l||(l=new Ge);var g=l.get(e);if(g)return g;l.set(e,d),Pl(e)?e.forEach(function(u){d.add(lt(u,t,n,u,e,l))}):kl(e)&&e.forEach(function(u,C){d.set(C,lt(u,t,n,C,e,l))});var y=_?w?Fc:Gc:w?Ht:Vt,h=b?void 0:y(e);return qr(h||e,function(u,C){h&&(C=u,u=e[C]),Go(d,C,lt(u,t,n,C,e,l))}),d}var cu=1,lu=4;function uu(e){return lt(e,cu|lu)}function du(){const e=br(),t=je(),n=G(()=>t.menuFromServer?t.appAsyncMenus:Ir);return{menuTree:G(()=>{const a=uu(n.value);a.sort((d,m)=>(d.meta.order||0)-(m.meta.order||0));function l(d,m){return d?d.map(_=>{var S,O;if(!e.accessRouter(_))return null;if(((S=_.meta)==null?void 0:S.hideChildrenInMenu)||!_.children)return _.children=[],_;_.children=_.children.filter(g=>{var y;return((y=g.meta)==null?void 0:y.hideInMenu)!==!0});const b=l(_.children,m+1);return b.length||m>1?(_.children=b,_):((O=_.meta)==null?void 0:O.hideInMenu)===!1?_:null}).filter(Boolean):null}return l(a,0)})}}function pu(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Eo(e)}const fu=ae({emit:["collapse"],setup(){const{t:e}=Ee.exports.useI18n(),t=je(),n=tt(),s=Lo(),{menuTree:a}=du(),l=G({get(){return Ue()||t.device==="desktop"?t.menuCollapse:!1},set(g){t.updateSettings({menuCollapse:g})}}),d=G(()=>t.topMenu),m=N([]),w=N([]),_=g=>{if(qa.test(g.path)){za(g.path),w.value=[g.name];return}const{hideInMenu:y,activeMenu:h}=g.meta;if(s.name===g.name&&!y&&!h){w.value=[g.name];return}n.push({name:g.name})},b=g=>{const y=[];let h=!1;const u=(C,p)=>{var D;if(C.name===g){h=!0,y.push(...p);return}(D=C.children)!=null&&D.length&&C.children.forEach(W=>{u(W,[...p,W.name])})};return a.value.forEach(C=>{h||u(C,[C.name])}),y};yo(g=>{const{requiresAuth:y,activeMenu:h,hideInMenu:u}=g.meta;if(y&&(!u||h)){const C=b(h||g.name),p=new Set([...C,...m.value]);m.value=[...p],w.value=[h||C[C.length-1]]}},!0);const S=g=>{Ue()&&t.updateSettings({menuCollapse:g}),t.device==="desktop"&&t.updateSettings({menuCollapse:g})},O=()=>{function g(y,h=[]){return y&&y.forEach(u=>{var D,W;const C=(D=u==null?void 0:u.meta)!=null&&D.icon?(W=u==null?void 0:u.meta)==null?void 0:W.icon:"",p=(u==null?void 0:u.children)&&(u==null?void 0:u.children.length)!==0?f(Ca,{key:u==null?void 0:u.name},{default:()=>[g(u==null?void 0:u.children)],icon:()=>f("i",{class:`iconfont ${C}`},null),title:()=>{var te;return _a(ba(e(((te=u==null?void 0:u.meta)==null?void 0:te.locale)||"")))}}):f(ya,{key:u==null?void 0:u.name,onClick:()=>_(u)},{default:()=>{var te;return[e(((te=u==null?void 0:u.meta)==null?void 0:te.locale)||"")]},icon:()=>f("i",{class:`iconfont ${C}`},null)});h.push(p)}),h}return g(a.value)};return()=>{let g;return f(va,{mode:d.value?"horizontal":"vertical",collapsed:l.value,"onUpdate:collapsed":y=>l.value=y,"open-keys":m.value,"onUpdate:open-keys":y=>m.value=y,"show-collapse-button":Ue()?!0:t.device!=="mobile","auto-open":!1,"selected-keys":w.value,"auto-open-selected":!0,"level-indent":34,style:"height: 100%;width:100%;",onCollapse:S},pu(g=O())?g:{default:()=>[g]})}}});const Lt=ce(fu,[["__scopeId","data-v-7bbdf8b6"]]),hu={class:"change-password-container modal-container"},mu=["src"],gu={class:"modal-title"},vu={class:"modal-main wsl-scroll"},_u={class:"modal-bot"},bu=ae({__name:"chang",emits:["handleClose","handleConfirmation"],setup(e,{emit:t}){const{t:n}=Ee.exports.useI18n(),s=t,a=Xe(),l=N({password:"",surePassword:""}),d=()=>{l.value={password:"",surePassword:""}},m=()=>{d(),s("handleClose")},w=async()=>{if(!l.value.password){V.warning(n("password.modal.placeholder.new"));return}if(!l.value.surePassword){V.warning(n("password.modal.placeholder.sure"));return}if(l.value.password!==l.value.surePassword){V.warning(n("password.form.btn.inconformity"));return}const _=await a.revampPassword({newPassword:l.value.password});if(_.code!==200&&_.code!==401){V.error(_.msg);return}V.success(n("password.form.btn.success")),m(),s("handleConfirmation")};return ut(()=>{d()}),(_,b)=>{const S=Ia,O=Ta,g=wa,y=De;return E(),H("div",hu,[i("div",{class:"modal-fixed",onClick:m},[i("img",{src:M(Uo),alt:""},null,8,mu)]),i("div",gu,$(_.$t("password.modal.title")),1),i("div",vu,[f(g,{model:l.value,layout:"vertical"},{default:v(()=>[f(O,{field:"password",label:_.$t("password.modal.new")},{default:v(()=>[f(S,{modelValue:l.value.password,"onUpdate:modelValue":b[0]||(b[0]=h=>l.value.password=h),placeholder:_.$t("password.modal.placeholder.new"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),f(O,{field:"surePassword",label:_.$t("password.modal.sure")},{default:v(()=>[f(S,{modelValue:l.value.surePassword,"onUpdate:modelValue":b[1]||(b[1]=h=>l.value.surePassword=h),placeholder:_.$t("password.modal.placeholder.sure"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),i("div",_u,[f(y,{class:"modal-btn-item",onClick:m},{default:v(()=>[ne($(_.$t("password.form.btn.cancel")),1)]),_:1}),f(y,{class:"modal-btn-item",disabled:!l.value.password||!l.value.surePassword,type:"primary",onClick:w},{default:v(()=>[ne($(_.$t("password.form.btn.sure")),1)]),_:1},8,["disabled"])])])}}});const Cu=ce(bu,[["__scopeId","data-v-a9f3d9bb"]]),yu={width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Iu=i("g",{"fill-rule":"evenodd","clip-rule":"evenodd",fill:"#4E5969"},[i("path",{d:"M12.834 3.167a4.546 4.546 0 0 0-7.556 4.565.5.5 0 0 1-.124.501l-3.13 3.13a.766.766 0 0 0-.146.27.718.718 0 0 0-.043.301v.004l.2 1.449a.719.719 0 0 0 .207.375c.12.12.255.186.367.202l1.457.2c.066.01.179.003.305-.038a.662.662 0 0 0 .257-.141l.006-.006 3.14-3.133a.5.5 0 0 1 .502-.124A4.55 4.55 0 0 0 12.841 9.6a4.552 4.552 0 0 0-.007-6.432Zm-7.133-.708a5.55 5.55 0 0 1 7.846 7.847v.001a5.55 5.55 0 0 1-5.274 1.453l-2.93 2.924c-.186.19-.432.318-.663.393a1.719 1.719 0 0 1-.758.077l-1.45-.2a1.674 1.674 0 0 1-.938-.487 1.712 1.712 0 0 1-.488-.932l-.001-.007-.2-1.45v-.002c-.037-.259.008-.53.084-.76.077-.23.203-.47.38-.651l.004-.006 2.928-2.927A5.541 5.541 0 0 1 5.7 2.46Z"}),i("path",{d:"M4.24 11.307a.5.5 0 0 1 .707 0l1.534 1.533a.5.5 0 1 1-.707.707L4.24 12.014a.5.5 0 0 1 0-.707ZM9.668 5.834a.5.5 0 1 0 0 1 .5.5 0 0 0 0-1Zm-1.5.5a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"})],-1),Tu=[Iu];function wu(e,t){return E(),H("svg",yu,[...Tu])}const Eu={render:wu},as=e=>(xt("data-v-44879333"),e=e(),jt(),e),Su={class:"navbar"},Mu={class:"left-side"},$u=as(()=>i("img",{alt:"logo",src:Ya},null,-1)),Au={class:"center-side"},Ou={class:"right-side"},ku={class:"quick_access_main"},Ru=["onClick"],Nu={class:"quick_access_main_item_main"},Lu=["src"],Pu={class:"quick_access_main_item_m_label"},Uu=["src"],Du={class:"user-info"},xu={class:"user-info-name"},ju={class:"user-info-bot"},Bu={class:"user-info-bot-l"},Gu=as(()=>i("div",{class:"user-info-bot-i outline"},null,-1)),Fu={class:"user-info-bot-l"},Vu=["src"],vo="ChatDB",Hu=ae({__name:"index",setup(e){const t=je(),n=Xe(),s=Pt(),a=Io(),l=zs(),d=tt(),{t:m,locale:w}=Ee.exports.useI18n(),{getAllConversations:_}=$t(vo),{clearAll:b}=$t(vo),{logout:S}=Do(),{changeLocale:O,currentLocale:g}=Js(),y=[...ea],h=G(()=>n.avatarUrl),u=G(()=>n.name),C=G(()=>s.socketStatus===1?m("socket.status1"):s.socketStatus===2?m("socket.status2"):""),p=G(()=>t.topMenu&&t.menu),D=N(),W=async()=>{await S(),b()},te=()=>{const k=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});D.value.dispatchEvent(k)},$e=Ea("toggleDrawerMenu"),K=N(!1),_e=()=>{K.value=!0},de=()=>{K.value=!1},pe=()=>{de()},Ve=()=>{c.emit("navbar-show-ar-login-qr-code")},X=N(0),be=N([]),at=async()=>{X.value=0,be.value=await _(),be.value?be.value.forEach(k=>{X.value+=k.unreadCount}):X.value=0},fe=k=>JSON.parse(k.entryName)[w.value],x=async k=>{if(console.log("handleInitQuitList",k),k){const F=await l.getQuickList();if(F.code!==200&&F.code!==401){if(F.code===20408)return;V.error(F.msg);return}l.updateQuickEnters(F.data)}},A=async k=>{if(k.isOwnApp===0)window.open(k.entryUri,"_blank");else{const F=await n.getApplicationCode({client_id:k.appId,redirect_uri:k.entryUri,scope:"snsapi_base"});if(F.code!==200&&F.code!==401)return F.code===20408||V.error(F.msg),!1;window.open(`${k.entryUri}?code=${F.data.code}`,"_blank")}return!1},Ae=k=>{d.push({path:k})};return So(()=>a.conversationList,k=>{k&&at()},{deep:!0,immediate:!0}),(k,F)=>{const He=Sa,Ce=Mo,ht=Ks,Oe=De,We=$o,ke=Aa,Re=Ao,Ne=Oo,he=Qs,rt=Zs,mt=Ma,it=Ys,qe=$a,gt=Oa,vt=Xs,ze=ko;return E(),H("div",Su,[i("div",Mu,[f(Ce,null,{default:v(()=>[$u,!p.value&&M(t).device==="mobile"?(E(),B(He,{key:0,style:{"font-size":"22px",cursor:"pointer"},onClick:M($e)},null,8,["onClick"])):z("",!0)]),_:1})]),i("div",Au,[p.value?(E(),B(Lt,{key:0})):z("",!0)]),i("ul",Ou,[i("li",null,[f(We,{content:k.$t("settings.language")},{default:v(()=>[f(Oe,{class:"nav-btn",type:"outline",shape:"circle",onClick:te},{icon:v(()=>[f(ht)]),_:1})]),_:1},8,["content"]),f(Ne,{trigger:"click",onSelect:M(O)},{content:v(()=>[(E(),H(Je,null,At(y,ee=>f(Re,{key:ee.value,value:ee.value},{icon:v(()=>[Ro(f(ke,null,null,512),[[No,ee.value===M(g)]])]),default:v(()=>[ne(" "+$(ee.label),1)]),_:2},1032,["value"])),64))]),default:v(()=>[i("div",{ref_key:"triggerBtn",ref:D,class:"trigger-btn"},null,512)]),_:1},8,["onSelect"])]),i("li",null,[f(Ne,{onPopupVisibleChange:x},{content:v(()=>[i("div",ku,[(E(!0),H(Je,null,At(M(l).quickEnters,(ee,ct)=>(E(),H("div",{key:`quick_${ct}`,class:"quick_access_main_item",onClick:me=>A(ee)},[i("div",Nu,[i("img",{class:"quick_access_main_item_m_icon",src:ee.iconUrl,alt:""},null,8,Lu),i("div",Pu,[i("span",null,$(fe(ee)),1)])])],8,Ru))),128))])]),default:v(()=>[f(We,{content:k.$t("settings.application")},{default:v(()=>[f(Oe,{class:"nav-btn",type:"outline",shape:"circle"},{icon:v(()=>[f(he)]),_:1})]),_:1},8,["content"])]),_:1})]),i("li",null,[f(mt,{count:X.value,dot:""},{default:v(()=>[f(Oe,{class:"nav-btn",type:"outline",shape:"circle",onClick:F[0]||(F[0]=ee=>Ae("/Message-List"))},{default:v(()=>[f(rt)]),_:1})]),_:1},8,["count"])]),i("li",null,[f(We,{content:k.$t("messageBox.ar.logo.title")},{default:v(()=>[f(Oe,{class:"nav-btn",type:"outline",shape:"circle",onClick:Ve},{icon:v(()=>[f(it)]),_:1})]),_:1},8,["content"])]),i("li",null,[f(qe,{size:32,style:{marginRight:"8px",cursor:"pointer"}},{default:v(()=>[i("img",{alt:"avatar",src:h.value},null,8,Uu)]),_:1}),f(Ne,{trigger:"click",position:"br"},{content:v(()=>[f(Re,null,{default:v(()=>[f(Ce,null,{default:v(()=>[i("img",{style:{width:"14px",height:"14px",borderRadius:"50%"},src:h.value,alt:""},null,8,Vu),i("span",null,$(u.value),1)]),_:1})]),_:1}),f(Re,{onClick:_e},{default:v(()=>[f(Ce,null,{default:v(()=>[f(M(Eu)),i("span",null,$(k.$t("messageBox.change.password")),1)]),_:1})]),_:1}),f(Re,{onClick:W},{default:v(()=>[f(Ce,null,{default:v(()=>[f(vt),i("span",null,$(k.$t("messageBox.logout")),1)]),_:1})]),_:1})]),default:v(()=>[i("div",Du,[i("div",xu,[i("span",null,$(u.value),1)]),i("div",ju,[M(s).networkStatus?(E(),H(Je,{key:0},[M(s).socketStatus==3?(E(),H("div",{key:0,class:Dt(["user-info-bot-i",M(s).networkStatus?"online":"outline"])},null,2)):z("",!0),M(s).socketStatus===2?(E(),B(gt,{key:1,size:12})):z("",!0),i("div",Bu,$(M(s).socketStatus===2?C.value:k.$t("meeting.invite.line.status.online")),1)],64)):(E(),H(Je,{key:1},[Gu,i("div",Fu,$(k.$t("meeting.invite.line.status.outline")),1)],64))])])]),_:1})])]),K.value?(E(),B(ze,{key:0,visible:K.value,"onUpdate:visible":F[1]||(F[1]=ee=>K.value=ee),footer:!1,closable:!1,class:"customModal"},{default:v(()=>[f(Cu,{onHandleClose:de,onHandleConfirmation:pe})]),_:1},8,["visible"])):z("",!0)])}}});const Wu=ce(Hu,[["__scopeId","data-v-44879333"]]);const Fe=e=>(xt("data-v-17257cfa"),e=e(),jt(),e),qu={class:"tag-link"},zu=Fe(()=>i("span",null,"\u91CD\u65B0\u52A0\u8F7D",-1)),Ju=Fe(()=>i("span",null,"\u5173\u95ED\u5F53\u524D\u6807\u7B7E\u9875",-1)),Ku=Fe(()=>i("span",null,"\u5173\u95ED\u5DE6\u4FA7\u6807\u7B7E\u9875",-1)),Qu=Fe(()=>i("span",null,"\u5173\u95ED\u53F3\u4FA7\u6807\u7B7E\u9875",-1)),Zu=Fe(()=>i("span",null,"\u5173\u95ED\u5176\u5B83\u6807\u7B7E\u9875",-1)),Yu=Fe(()=>i("span",null,"\u5173\u95ED\u5168\u90E8\u6807\u7B7E\u9875",-1)),Xu=ae({__name:"tab-item",props:{itemData:{type:Object,default(){return[]}},index:{type:Number,default:0}},setup(e){const t=e,n=tt(),s=Lo(),a=Ut(),l=y=>{n.push({...y})},d=G(()=>a.getTabList),m=G(()=>t.itemData.fullPath!==s.fullPath),w=G(()=>t.index===0),_=G(()=>[0,1].includes(t.index)),b=G(()=>t.index===d.value.length-1),S=(y,h)=>{if(a.deleteTag(h,y),t.itemData.fullPath===s.fullPath){const u=d.value[h-1];n.push({name:u.name})}},O=()=>d.value.findIndex(y=>y.fullPath===s.fullPath),g=async y=>{const{itemData:h,index:u}=t,C=[...d.value];if(y==="current")S(h,u);else if(y==="left"){const p=O();C.splice(1,t.index-1),a.freshTabList(C),p<u&&n.push({name:h.name})}else if(y==="right"){const p=O();C.splice(t.index+1),a.freshTabList(C),p>u&&n.push({name:h.name})}else if(y==="others"){const p=d.value.filter((D,W)=>W===0||W===t.index);a.freshTabList(p),n.push({name:h.name})}else y==="reload"?(a.deleteCache(h),await n.push({name:ta,params:{path:s.fullPath}}),a.addCache(h.name)):(a.resetTabList(),n.push({name:na}))};return(y,h)=>{const u=Ra,C=oa,p=Ao,D=sa,W=aa,te=ra,$e=ia,K=Oo;return E(),B(K,{trigger:"contextMenu","popup-max-height":!1,onSelect:g},{content:v(()=>[f(p,{disabled:m.value,value:"reload"},{default:v(()=>[f(C),zu]),_:1},8,["disabled","value"]),f(p,{class:"sperate-line",disabled:w.value,value:"current"},{default:v(()=>[f(u),Ju]),_:1},8,["disabled","value"]),f(p,{disabled:_.value,value:"left"},{default:v(()=>[f(D),Ku]),_:1},8,["disabled","value"]),f(p,{class:"sperate-line",disabled:b.value,value:"right"},{default:v(()=>[f(W),Qu]),_:1},8,["disabled","value"]),f(p,{value:"others"},{default:v(()=>[f(te),Zu]),_:1},8,["value"]),f(p,{value:"all"},{default:v(()=>[f($e),Yu]),_:1},8,["value"])]),default:v(()=>[i("span",{class:Dt(["arco-tag arco-tag-size-medium arco-tag-checked",{"link-activated":e.itemData.fullPath===y.$route.fullPath}]),onClick:h[1]||(h[1]=_e=>l(e.itemData))},[i("span",qu,$(y.$t(e.itemData.title)),1),i("span",{class:"arco-icon-hover arco-tag-icon-hover arco-icon-hover-size-medium arco-tag-close-btn",onClick:h[0]||(h[0]=ka(_e=>S(e.itemData,e.index),["stop"]))},[f(u)])],2)]),_:1})}}});const ed=ce(Xu,[["__scopeId","data-v-17257cfa"]]),td=e=>(xt("data-v-509db106"),e=e(),jt(),e),nd={class:"tab-bar-container"},od={class:"tab-bar-box"},sd={class:"tab-bar-scroll"},ad={class:"tags-wrap"},rd=td(()=>i("div",{class:"tag-bar-operation"},null,-1)),id=ae({__name:"index",setup(e){const t=je(),n=Ut(),s=N(),a=G(()=>n.getTabList),l=G(()=>t.navbar?60:0);return So(()=>t.navbar,()=>{s.value.updatePosition()}),yo(d=>{!d.meta.noAffix&&!a.value.some(m=>m.fullPath===d.fullPath)&&n.updateTabList(d)},!0),Na(()=>{ca()}),(d,m)=>{const w=La;return E(),H("div",nd,[f(w,{ref_key:"affixRef",ref:s,"offset-top":l.value},{default:v(()=>[i("div",od,[i("div",sd,[i("div",ad,[(E(!0),H(Je,null,At(a.value,(_,b)=>(E(),B(ed,{key:_.fullPath,index:b,"item-data":_},null,8,["index","item-data"]))),128))])]),rd])]),_:1},8,["offset-top"])])}}});const cd=ce(id,[["__scopeId","data-v-509db106"]]),ld={class:"room-options-container"},ud=["src"],dd={class:"link-m-t borderB"},pd={class:"room-options-main"},fd={class:"link-m-b"},hd={class:"link-m-b-btn"},md=ae({__name:"force_entry",emits:["handleClose","handleJoinMeeting"],setup(e,{emit:t}){const n=t,{t:s}=Ee.exports.useI18n(),a=()=>{n("handleClose")},d=Ja(async()=>{n("handleJoinMeeting")},1e3);return(m,w)=>(E(),H("div",ld,[i("div",{class:"room-fixed",onClick:a},[i("img",{src:M(Po),alt:""},null,8,ud)]),i("div",dd,[i("span",null,$(M(s)("meeting.modal.title")),1)]),i("div",pd,[i("span",null,$(M(s)("meeting.modal.force.desc")),1)]),i("div",fd,[i("div",hd,[i("div",{class:"link-m-b-btn-i btn-border",onClick:a},[i("span",null,$(M(s)("meeting.modal.btn.cancel")),1)]),i("div",{class:"link-m-b-btn-i btn-bg",onClick:w[0]||(w[0]=(..._)=>M(d)&&M(d)(..._))},[i("span",null,$(M(s)("meeting.modal.btn.sure")),1)])])])]))}});const gd=ce(md,[["__scopeId","data-v-beb61611"]]),vd={class:"upcoming-container"},_d={class:"upcoming-container-top"},bd={class:"upcoming-container-top-l"},Cd=["src"],yd={class:"upcoming-container-top-l-r"},Id=["src"],Td={class:"upcoming-container-main"},wd={class:"upcoming-container-main-top textEllipsis"},Ed={class:"upcoming-container-main-bot"},Sd={class:"upcoming-container-main-bot-i one"},Md={class:"upcoming-container-main-bot-i"},$d={class:"upcoming-container-menu"},Ad=ae({__name:"index",setup(e,{expose:t}){const{t:n}=Ee.exports.useI18n(),s=To(),a=wo(),l=N(""),d=b=>b?Ka(b,"HH:mm"):"",m=async b=>{if(b){const S=await a.filterMemberInfoByUserId(b);l.value=S.name}},w=()=>{s.removeUpcomingMeetingList(s.upcomingMeetingInfo),s.upcomingMeetingList.length>0?s.updateUpcomingMeetingInfo(s.upcomingMeetingList[0]):(s.updateUpcomingMeetingInfo(null),s.updateUpcomingMeetingVisible(!1))},_=async()=>{c.emit("meeting-notification-close"),c.emit("Chat-upcoming-meeting-join")};return et(()=>{m(s.upcomingMeetingInfo.master)}),t({handleClose:w}),(b,S)=>{var y,h,u;const O=$o,g=De;return E(),H("div",vd,[i("div",_d,[i("div",bd,[i("img",{src:M(Qa),alt:""},null,8,Cd),i("div",yd,[i("span",null,$(M(n)("meeting.modal.upcoming.title")),1)])]),i("div",{class:"upcoming-container-top-r",onClick:w},[i("img",{src:M(Uo),alt:""},null,8,Id)])]),i("div",Td,[f(O,{content:(y=M(s).upcomingMeetingInfo)==null?void 0:y.subject},{default:v(()=>{var C;return[i("div",wd,$((C=M(s).upcomingMeetingInfo)==null?void 0:C.subject),1)]}),_:1},8,["content"]),i("div",Ed,[i("div",Sd,[i("span",null,$(M(n)("meeting.modal.upcoming.content2"))+":",1),ne(" \xA0 "),i("span",null,$(l.value),1)]),i("div",Md,[i("span",null,$(M(n)("meeting.modal.upcoming.content1"))+":",1),ne(" \xA0 "),i("span",null,$(d((h=M(s).upcomingMeetingInfo)==null?void 0:h.startTime))+" - "+$(d((u=M(s).upcomingMeetingInfo)==null?void 0:u.endTime)),1)])])]),i("div",$d,[f(g,{long:"",class:"modal-btn-item",onClick:w},{default:v(()=>[ne($(b.$t("meeting.modal.upcoming.btn1")),1)]),_:1}),f(g,{long:"",class:"modal-btn-item",type:"primary",onClick:_},{default:v(()=>[ne($(b.$t("meeting.modal.upcoming.btn2")),1)]),_:1})])])}}});const Od=ce(Ad,[["__scopeId","data-v-204ae469"]]),kd={class:"ar-qr-code-modal-container"},Rd=["src"],Nd={class:"ar-qr-code-main"},Ld={class:"ar-qr-code-main-top"},Pd={class:"ar-qr-code-main-mid-body"},Ud={class:"ar-qr-code-main-bot"},Dd={class:"ar-qr-code-main-bot-desc"},xd=ae({__name:"index",emits:["handleClose"],setup(e,{emit:t}){const n=N(null),s=t,{t:a}=Ee.exports.useI18n();N(!0);const l=()=>{s("handleClose")},d=Xe(),m=Pt(),w=N(""),_=async()=>{const S=await d.getArLoginQrCode({command:0});if(S.code!==200&&S.code!==401){V.error(S.msg);return}w.value=S.data},b=async()=>{n.value&&(await _(),n.value.innerHTML="",la.toCanvas(w.value,{errorCorrectionLevel:"H",width:180,margin:2},(S,O)=>{var y;if(S){console.error(S);return}n.value&&n.value.appendChild(O);const g=O.getContext("2d");if(g){const u=(O.width-30)/2,C=(O.height-30)/2;g.beginPath(),g.moveTo(u+5,C),g.lineTo(u+30-5,C),g.quadraticCurveTo(u+30,C,u+30,C+5),g.lineTo(u+30,C+30-5),g.quadraticCurveTo(u+30,C+30,u+30-5,C+30),g.lineTo(u+5,C+30),g.quadraticCurveTo(u,C+30,u,C+30-5),g.lineTo(u,C+5),g.quadraticCurveTo(u,C,u+5,C),g.closePath(),g.fillStyle="#ffffff",g.fill(),g.strokeStyle="#000000",g.lineWidth=2,g.stroke();const p=new Image;p.src=(y=m.platformConfig)==null?void 0:y.oneToOneLogo,p.onload=()=>{g.drawImage(p,u+2.5,C+2.5,30-5,30-5)}}if(n.value){const h=document.createElement("div");h.textContent=d.name?d.name:"",h.style.textAlign="center",n.value.appendChild(h)}}))};return et(()=>{b()}),ut(()=>{w.value=""}),(S,O)=>(E(),H("div",kd,[i("div",{class:"ar-qr-code-fixed",onClick:l},[i("img",{src:M(Po),alt:""},null,8,Rd)]),i("div",Nd,[i("div",Ld,[i("span",null,$(M(a)("ar.qr.code.modal.title")),1)]),i("div",Pd,[i("div",{ref_key:"qrCodeContainer",ref:n,class:"ar-qr-code-container"},null,512)])]),i("div",Ud,[i("div",Dd,[i("span",null,$(M(a)("ar.qr.code.modal.desc1")),1)])])]))}});const jd=ce(xd,[["__scopeId","data-v-145f1761"]]);function Bd(e,t,n,s=!1){e.addEventListener&&typeof e.addEventListener=="function"&&e.addEventListener(t,n,s)}function Gd(e,t,n,s=!1){e.removeEventListener&&typeof e.removeEventListener=="function"&&e.removeEventListener(t,n,s)}const Fd=992;function Vd(){return document.body.getBoundingClientRect().width-1<Fd}function Hd(e){const t=je();function n(){if(!document.hidden){const a=Vd();t.toggleDevice(a?"mobile":"desktop"),t.toggleMenu(a)}}const s=Ha(n,100);et(()=>{e&&s()}),Pa(()=>{Bd(window,"resize",s)}),ut(()=>{Gd(window,"resize",s)})}const Wd={width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},qd=i("circle",{cx:"28",cy:"28",r:"28",fill:"#FF7D00"},null,-1),zd=i("path",{d:"M25.607 34a2.432 2.432 0 0 0 4.79 0l1.596-22a4.012 4.012 0 0 0-1.171-2.826A3.996 3.996 0 0 0 28.002 8a4.095 4.095 0 0 0-2.935 1.345A4.112 4.112 0 0 0 24.01 12.4L25.607 34Zm2.395 6a3.986 3.986 0 0 0-3.688 2.47 4.008 4.008 0 0 0 .865 4.358A3.988 3.988 0 0 0 31.993 44a3.786 3.786 0 0 0-1.098-2.9 3.77 3.77 0 0 0-2.893-1.1Z",fill:"#fff"},null,-1),Jd=[qd,zd];function Kd(e,t){return E(),H("svg",Wd,[...Jd])}const _o={render:Kd};function Qd(){const e=N("default");return et(()=>{"Notification"in window&&(e.value=Notification.permission)}),{permission:e,requestPermission:async()=>{if(!("Notification"in window)){console.warn("Browser does not support notifications");return}try{const s=await Notification.requestPermission();e.value=s,console.log("\u8BF7\u6C42\u901A\u77E5\u6743\u9650",e.value)}catch(s){console.error("Error requesting permission:",s)}},notify:s=>{if(e.value!=="granted"){console.warn("Notification permission not granted");return}console.log("\u53D1\u9001\u7CFB\u7EDF\u901A\u77E5",s.title,s);const a=new Notification(s.title,s);a.onclick=()=>{window.focus(),console.log("Notification clicked")},console.log("\u53D1\u9001\u7CFB\u7EDF\u901A\u77E5-notification",a)}}}const Zd=ae({__name:"page-layout",setup(e){const t=Ut(),n=G(()=>t.getCacheList);return(s,a)=>{const l=Ua("router-view");return E(),B(l,null,{default:v(({Component:d,route:m})=>[f(xa,{name:"fade",mode:"out-in",appear:""},{default:v(()=>[m.meta.ignoreCache?(E(),B(Ke(d),{key:m.fullPath})):(E(),B(Da,{key:1,include:n.value},[(E(),B(Ke(d),{key:m.fullPath}))],1032,["include"]))]),_:2},1024)]),_:1})}}}),Yd={key:0,class:"layout-navbar"},Xd={class:"menu-wrapper"},ep={class:"modal-content"},tp={class:"modal-content-top"},np={class:"modal-content-desc"},op={class:"modal-content-desc-b"},sp={class:"errorMessage xxxx"},ap={class:"modal-content-bot"},rp={class:"modal-content"},ip={class:"modal-content-top"},cp={class:"modal-content-desc"},lp={class:"modal-content-desc-b"},up={class:"errorMessage"},dp={class:"modal-content-bot"},pp={class:"modal-content-bot-i"},fp={class:"modal-content-bot-i"},hp={class:"modal-content"},mp={class:"modal-content-top"},gp={class:"modal-content-desc"},vp={class:"modal-content-desc-b"},_p={class:"modal-content-bot"},bp={class:"modal-content-bot-i"},Cp={class:"modal-content-bot-i"},yp={key:2,class:"upcoming-modal"};function bo(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Eo(e)}const Ip="ChatDB",Tp="60px",wp=ae({__name:"default-layout",setup(e){const{requestPermission:t,notify:n}=Qd(),s=N(null),{t:a}=Ee.exports.useI18n(),{logout:l}=Do(),{addConversation:d,addMessage:m,getAllConversations:w,clearAll:_}=$t(Ip),b=wo(),S=N(!1),O=N(0),g=je(),y=Xe(),h=Io(),u=Pt(),C=tt(),p=To(),D=N(!1),W=N(!1),te=N(""),$e=N(""),K=N(!1),_e=N(0),de=N(!1),pe=N(!1),Ve=N(),X=N(!1);let be,at;const fe=(o,r)=>{te.value=o,$e.value=r};let x;const A=N(null);Hd(!0);const Ae=G(()=>Ue()),k=G(()=>g.navbar),F=G(()=>g.menu&&!g.topMenu),He=G(()=>Ae.value?!1:g.hideMenu),Ce=G(()=>g.menuCollapse?48:g.menuWidth),ht=G(()=>g.menuCollapse),Oe=G(()=>{const o=F.value&&!He.value?{paddingLeft:`${Ce.value}px`}:{},r=k.value?{paddingTop:Ae.value?0:Tp}:{};return{...o,...r}}),We=o=>{!S.value||g.updateSettings({menuCollapse:o})},ke=N(!1),Re=()=>{ke.value=!1};ja("toggleDrawerMenu",()=>{ke.value=!ke.value});const Ne=(o,r,I)=>{n({title:o,body:r,icon:I})},he=N(!1),rt=()=>{he.value=!0},mt=()=>{he.value=!1},it=async()=>{var I;console.log("\u5237\u65B0\u4E1A\u52A1\u7CFB\u7EDFtoken-----------");const o=Et(),r=await y.userResetLogin({refresh_token:o});if(r.code!==200&&r.code!==401){V.error(r.msg);return}if(r.code===10909&&!D.value){fe(a("error.logout.title1"),a("error.logout.tips2")),D.value=!0;return}Vn(r.data.tokenType),Hn(r.data.token),Wn(r.data.refreshToken),x==null||x.refreshToken({token:r.data.token}),(I=A.value)==null||I.refreshToken({token:r.data.token})},qe=async()=>{D.value=!1,W.value=!1,await l(),_()},gt=()=>{K.value=!1,de.value=!1},vt=()=>{K.value=!1};let ze;const ee=o=>{A.value.sendAssistInviteeTimeoutEvent({meetingNo:o.meetingNo,invitor:o.invitor}),p.updateAnswerInfo(null),p.updateAnswerVisible(!1)},ct=o=>{if(p.answerInfo&&p.answerInfo.meetingNo||A.value&&A.value.meetingInfo&&A.value.meetingInfo.meetingNo){console.log("\u63A5\u6536\u5230\u88AB\u9080\u8BF7\u4E1A\u52A1-\u5DF2\u7ECF\u5728\u88AB\u547C\u53EB\u4E2D",o),A.value.sendAssistInviteeBusyEvent({meetingNo:o.meetingNo,invitor:o.invitor});return}const r=b.filterMemberInfoByUserId(o.invitor);p.updateAnswerInfo({...r,meetingNo:o.meetingNo}),p.updateAnswerVisible(!0),ze=setTimeout(()=>{ee(o)},1e3*p.answerTimeoutTime),Ne(a("notification.title"),a("notification.assist.title"),p.answerInfo.avatarUrl)},me=()=>{ze&&clearTimeout(ze)},Jt=async o=>{const r=await b.filterMemberInfoByUserId(o.invitee);console.log("\u88AB\u9080\u8BF7\u4EBA\u5FD9\u788C\u4E2D-",r,r==null?void 0:r.name,o),r?V.warning(`${r.name} ${a("meeting.invite.line.msg1")}`):V.warning(`${o.invitee} ${a("meeting.invite.line.msg1")}`)},Kt=o=>{console.log("\u88AB\u9080\u8BF7\u4EBA\u8D85\u65F6\u672A\u63A5\u542C-",o);const r=b.filterMemberInfoByUserId(o.invitee);r?V.warning(`${r.name} ${a("meeting.invite.line.msg2")}`):V.warning(`${o.invitee} ${a("meeting.invite.line.msg2")}`)},Qt=()=>{V.warning(`${a("meeting.answer.msg1")}`),me(),p.updateAnswerInfo(null),p.updateAnswerVisible(!1)},Zt=()=>{V.warning(`${a("meeting.answer.msg2")}`),me(),p.updateAnswerInfo(null),p.updateAnswerVisible(!1)},Yt=o=>{p.answerVisible&&o.meetingNo===p.answerInfo.meetingNo&&(V.warning(a("meeting.message.over")),p.updateAnswerInfo(null),p.updateAnswerVisible(!1))},rs=()=>{pe.value=!0},Xt=o=>{pe.value=!1,u.notificationId&&Ie.remove(u.notificationId),o||localStorage.removeItem("meetingInfo")},is=async()=>{var r;Xt(!0);const o=await A.value.agreeJoinMeeting({meetingNo:p.forceEntryMeetingInfo.meetingNo,invitor:p.forceEntryMeetingInfo.userId,forceEntryStatus:1});if(o.code!==200&&o.code!==401){V.error(o.msg);return}re.updateRoomTranslateInfo({...re.roomTranslateInfo,...o.data,open:!!((r=o.data)!=null&&r.enableTranslation)}),A.value.setRoomOnlineListPsn(b.memberList),A.value.setRoomOnlineGroupPsn(b.memberGroupList),p.updateAnswerVisible(!1),p.updateAnswerInfo(null),p.updateForceEntryMeetingInfo(null),p.updateAssistVisible(!0)},en=()=>{me(),rs()},tn=o=>{p.addUpcomingMeetingList(o),p.updateUpcomingMeetingInfo(o),p.updateUpcomingMeetingVisible(!0)},nn=async()=>{if(p.answerInfo&&p.answerInfo.meetingNo){V.error(a("meeting.call.message.tips"));return}const o=p.upcomingMeetingInfo,r=b.filterMemberInfoByUserId(o.master);p.updateRoomOptions({meetingName:o==null?void 0:o.subject,meetingNo:o==null?void 0:o.meetingNo,organizer:r==null?void 0:r.name,cloudRecord:(o==null?void 0:o.recordStatus)===1,abstract:(o==null?void 0:o.aiStatus)===1,escaping:o.escaping===1,video:!1,audio:!0,loudspeaker:!0}),X.value=!0,Ve.value&&Ve.value.handleClose()},_t=()=>{X.value=!1},cs=async o=>{var I,R,oe,Q;const r=await A.value.joinMeeting({meetingNo:o.meetingNo,forceEntryStatus:0,inviters:[]});if(r.code!==200&&r.code!==401){r.code===Pe.OTHER_CLIENT_JOINED_MEETING||r.code===Pe.OTHER_CLIENT_IN_MEETING?(p.updateForceEntryMeetingInfo({meetingNo:o.meetingNo,invitor:[]}),re.updateRoomTranslateInfo({...re.roomTranslateInfo,...r.data,open:!!((I=r.data)!=null&&I.enableTranslation)}),c.emit("Chat-Other-Client-Joined-Meeting")):V.error(r.msg);return}A.value.roomMenuOptions={video:(R=p.roomOptions)==null?void 0:R.video,audio:(oe=p.roomOptions)==null?void 0:oe.audio,loudspeaker:(Q=p.roomOptions)==null?void 0:Q.loudspeaker},A.value.setRoomOnlineListPsn(b.memberList),A.value.setRoomOnlineGroupPsn(b.memberGroupList),X.value&&_t(),X.value&&_t(),p.updateAssistVisible(!0)},on=()=>{c.emit("meeting-list-update")},re=ua(),sn=o=>{o.reason===8&&(s.value=_o,fe(a("error.logout.tips3"),a("error.logout.tips6")),D.value=!0),re.updateRoomMenuOptionsVideo(!1),j.emit("th-self-menu-camera-close")},ls=async()=>{var r,I,R;const o=localStorage.getItem("meetingInfo");if(o){const oe=JSON.parse(o),Q=await A.value.joinMeeting({meetingNo:oe.meetingNo,forceEntryStatus:0,inviters:[]});if(Q.code!==200&&Q.code!==401){Q.code===Pe.OTHER_CLIENT_JOINED_MEETING||Q.code===Pe.OTHER_CLIENT_IN_MEETING?(p.updateForceEntryMeetingInfo({meetingNo:oe.meetingNo,invitor:[]}),c.emit("Chat-Other-Client-Joined-Meeting")):(Ie.remove(u.notificationId),localStorage.removeItem("meetingInfo"),j.emit("th-assist-closed"));return}A.value.roomMenuOptions={video:(r=p.roomOptions)==null?void 0:r.video,audio:(I=p.roomOptions)==null?void 0:I.audio,loudspeaker:(R=p.roomOptions)==null?void 0:R.loudspeaker},A.value.setRoomOnlineListPsn(b.memberList),A.value.setRoomOnlineGroupPsn(b.memberGroupList),A.value.sendAssistMeetingStatusSyncEvent({meetingNo:oe.meetingNo})}},us=async()=>{var r,I,R,oe,Q,ge,ie;const o=localStorage.getItem("meetingInfo");if(o){const Z=JSON.parse(o),se=await A.value.joinMeeting({meetingNo:Z.meetingNo,forceEntryStatus:0,inviters:[]});if(se.code!==200&&se.code!==401){se.code===Pe.OTHER_CLIENT_JOINED_MEETING||se.code===Pe.OTHER_CLIENT_IN_MEETING?(p.updateForceEntryMeetingInfo({meetingNo:Z.meetingNo,invitor:[]}),c.emit("Chat-Other-Client-Joined-Meeting"),re.updateRoomTranslateInfo({...re.roomTranslateInfo,...Z,open:!!((r=se.data)!=null&&r.enableTranslation)})):(V.error(se.msg),Ie.remove(u.notificationId),localStorage.removeItem("meetingInfo"));return}re.updateRoomTranslateInfo({...re.roomTranslateInfo,languageType:(I=se.data)==null?void 0:I.languageType,industryType:(R=se.data)==null?void 0:R.industryType,...se.data,open:!!((oe=se.data)!=null&&oe.enableTranslation)}),A.value.roomMenuOptions={video:(Q=p.roomOptions)==null?void 0:Q.video,audio:(ge=p.roomOptions)==null?void 0:ge.audio,loudspeaker:(ie=p.roomOptions)==null?void 0:ie.loudspeaker},A.value.setRoomOnlineListPsn(b.memberList),A.value.setRoomOnlineGroupPsn(b.memberGroupList),Ie.remove(u.notificationId),p.updateAssistVisible(!0)}},ds=()=>{if(p.assistVisible){ls();return}u.updateNotificationId(`${Date.now()}`);const o=localStorage.getItem("meetingInfo");if(o){const r=JSON.parse(o);Ie.info({id:u.notificationId,title:a("notification.assist.join.hint"),content:`${a("notification.assist.join.title")} ${r.subject}, ${a("notification.assist.join.title1")}`,duration:0,footer:()=>{let I,R;return f(Mo,null,{default:()=>[f(De,{type:"secondary",size:"small",onClick:()=>{localStorage.removeItem("meetingInfo"),Ie.remove(u.notificationId)}},bo(I=a("notification.assist.join.label1"))?I:{default:()=>[I]}),f(De,{type:"primary",size:"small",onClick:us},bo(R=a("notification.assist.join.label2"))?R:{default:()=>[R]})]})}})}},an=async()=>{const o=await b.getContactsData();return o.code!==200&&o.code!==401||b.addMemberList(o.data),o},rn=async()=>{const o=await b.getContactsGroupData();return o.code!==200&&o.code!==401||b.addGroupMemberList(o.data),o},ps=async o=>{const r=await h.getChatMessageList(o);return r.code!==200&&r.code!==401||(console.log("\u52A0\u8F7D\u6B21\u8981\u6570\u636E--\u6700\u8FD1\u6D88\u606F-res",r),r.data&&r.data.length>0&&r.data.forEach(async I=>{if(I.chatType===J.GROUP_CHAT){const R={...I,parentId:`${I.chatType}_${o.groupId}`};await m(R,!1)}else{const R={...I,parentId:`${I.chatType}_${o.userId}`};await m(R,!1)}})),r},fs=async()=>{const o=await h.getChatConversationList();if(o.code!==200&&o.code!==401)return o;if(console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E--\u4F1A\u8BDD\u5217\u8868-api-res",o),o.data&&o.data.length>0){await o.data.forEach(async I=>{await d({...I,conversationId:`${I.chatType}_${I.targetId}`,status:1}),await ps({userId:I.targetId,pageNo:1,pageSize:I.unreadCount?I.unreadCount:10})});const r=await w();console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E--\u4F1A\u8BDD\u5217\u8868-db-conversationList",r),h.updateConversationList(r)}return o},hs=async()=>{const o={groupId:"",userId:""},r=await h.getChatOffLineMessageList(o);return r.code!==200&&r.code!==401||(console.log("\u52A0\u8F7D\u6B21\u8981\u6570\u636E--\u79BB\u7EBF\u6D88\u606F-res",r),r.data&&r.data.length>0&&await r.data.forEach(async I=>{const R={...I,parentId:`${I.chatType}_${I.chatType===J.GROUP_CHAT?I.recipientId:I.senderId}`};await m(R,!0)})),r},cn=()=>{console.log("\u8FDC\u7A0B\u534F\u52A9-Websocket\u8FDE\u63A5\u6253\u5F00:Th-im-open-success"),A.value.login()},ln=o=>{console.log("\u8FDC\u7A0B\u534F\u52A9Websocket\u767B\u5F55\u6210\u529F:Th-login-success",o.lastLoginTime),u.updateSocketStatus(3);const r=localStorage.getItem("meetingInfo");r&&(JSON.parse(r).selfUserId===y.userId?ds():localStorage.removeItem("meetingInfo"))},un=o=>{console.log("Socket\u5F02\u5E38\u8FDE\u63A5\u5173\u95ED\u89E6\u53D1-\u91CD\u65B0\u8FDE\u63A5\u4E2D-layout...",o),_e.value=o.retryCount,_e.value===0&&(K.value=!0)},dn=o=>{K.value&&(K.value=!1),console.log("Socket\u5F02\u5E38\u8FDE\u63A5\u5173\u95ED-\u4E1A\u52A1\u903B\u8F91",o),de.value=!0,x==null||x.logout()},ms=()=>{de.value=!1,x.chatWssReconnect()},gs=()=>{j.on("ThAssistImWsOpen",cn),j.on("ThAssistLoginSuccess",ln),j.on("ThAssistInvited",ct),j.on("ThAssistInviteeBeBusy",Jt),j.on("ThAssistInviteeBeTimeout",Kt),j.on("ThAssistOtherClientAccepted",Qt),j.on("ThAssistOtherClientRejected",Zt),j.on("ThAssistClosed",Yt),j.on("ThAssistAboutToBegin",tn),j.on("ThAssistPlanStatusUpdated",on),j.on("ThAssistKickOut",sn)},vs=()=>{j.off("ThAssistImWsOpen",cn),j.off("ThAssistLoginSuccess",ln),j.off("ThAssistInvited",ct),j.off("ThAssistInviteeBeBusy",Jt),j.off("ThAssistInviteeBeTimeout",Kt),j.off("ThAssistOtherClientAccepted",Qt),j.off("ThAssistOtherClientRejected",Zt),j.off("ThAssistClosed",Yt),j.off("ThAssistAboutToBegin",tn),j.off("ThAssistPlanStatusUpdated",on),j.off("ThAssistKickOut",sn)},{appConfig:pn}=da(),_s=async()=>{let o="";Ue()?o=`wss://${pn.host}/socket`:o=`wss://${window.location.host}/socket`,A.value=new ma({wssUrl:o,userId:y.userId,token:wt()}),p.updateThImEvent(A.value),A.value.initWss(),gs()},fn=()=>{console.log("\u5373\u65F6\u901A\u8BAF-websocket-\u8FDE\u63A5\u6253\u5F00:handleChatWsOpen"),u.updateSocketStatus(2),x.login()},hn=async o=>{await be(),u.updateLastLoginTime(o.lastLoginTime),gt(),_s()},mn=o=>{console.log("\u63A5\u6536\u5230\u767B\u51FA\u6210\u529F\u4E8B\u4EF6-\u4E1A\u52A1\u903B\u8F91",o)},gn=o=>{D.value||(console.log("\u63A5\u6536\u5230\u88AB\u8E22\u4E0B\u7EBF\u4E8B\u4EF6-\u4E1A\u52A1\u903B\u8F91",o,qn.DUPLICATE_LOGIN),o.reason===qn.DUPLICATE_LOGIN?(s.value=_o,fe(a("error.logout.tips3"),a("error.logout.tips3")),W.value=!0):(fe(a("error.logout.title"),a("error.logout.tips5")),W.value=!0),D.value=!0,x==null||x.logout())},vn=()=>{u.updateSocketStatus(1)},_n=async o=>{await d({conversationId:`${o.chatType}_${o.targetId}`,...o,status:1,unreadCount:0});const r=`${o.chatType}_${o.chatType===J.GROUP_CHAT?o.targetId:o.senderId}`;await m({chatType:o.chatType,recipientId:o.targetId,content:o.content,fingerPrint:o.fp,messageType:o.messageType,sendTime:o.sendTime,senderId:ve.SERVER,parentId:r,status:0,name:"",avatarUrl:""},!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==r);const I=await w();h.updateConversationList(I)},bn=async o=>{console.log("\u7FA4\u7EC4\u4FE1\u606F\u66F4\u65B0\u4E8B\u4EF6",o,h.conversationList);const r=h.conversationList.find(I=>I.conversationId===`${J.GROUP_CHAT}_${o.groupId}`);console.log("\u7FA4\u7EC4\u4FE1\u606F\u66F4\u65B0\u4E8B\u4EF6-conversation",r),h.updateConversations({...r,targetAvatarUrl:o.avatarUrl,targetName:o.groupName}),c.emit("group-info-change")},bs=async o=>{const r=await b.filterMemberInfoByUserId(o.senderId);Ne(a("notification.title"),o.content,r==null?void 0:r.avatarUrl)},Cn=async o=>{let r;if(o.chatType===J.GROUP_CHAT)console.log("\u63A5\u6536\u804A\u5929\u4FE1\u606F-\u7FA4\u804A",o),r={...o,parentId:`${o.chatType}_${o.recipientId}`};else if(o.chatType===J.PRIVATE_CHAT){console.log("\u63A5\u6536\u804A\u5929\u4FE1\u606F-\u5355\u804A");const R=await b.filterMemberInfoByUserId(o.senderId);r={...o,parentId:`${o.chatType}_${o.senderId}`,sendId:o.senderId,name:R==null?void 0:R.name,avatarUrl:R==null?void 0:R.avatarUrl}}m(r,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==r.parentId);const I=await w();h.updateConversationList(I),c.emit("group-info-change"),bs(o)},yn=o=>{b.updateMemberStatus(o,!0)},In=o=>{b.updateMemberStatus(o,!1)},Tn=()=>{an(),rn()},wn=o=>{console.log("\u7FA4\u6210\u5458\u8E22\u51FA\u4E8B\u4EF6-handleChatGroupMemberRemoved",o),m(o,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==o.parentId),c.emit("group-info-change",o)},En=async o=>{console.log("\u7FA4\u6210\u5458\u9080\u8BF7\u4E8B\u4EF6\uFF1AhandleChatGroupMemberInvited",o),await m(o,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==o.parentId),c.emit("group-info-change",o)},Sn=o=>{console.log("\u7FA4\u4E3B\u53D8\u66F4\u4E8B\u4EF6\uFF1AhandleChatGroupMasterChanged",o),m(o,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==o.parentId),c.emit("group-info-change",o)},Mn=o=>{console.log("\u7FA4\u5931\u6548\u4E8B\u4EF6\uFF1AhandleChatGroupDisbanded",o),m(o,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==o.parentId),c.emit("group-info-change",o)},$n=o=>{m(o,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==o.parentId),c.emit("group-info-change",o)},An=o=>{x.sendAckMessage(o)},On=o=>{console.log("\u53D1\u9001\u804A\u5929\u6D88\u606F",o),x.sendMessage(o)},kn=o=>{x.sendChatReceivedMessageReadEvent({targetId:o.targetId,chatType:o.chatType})},Rn=()=>{u.updateSocketStatus(1)},bt=()=>{u.notificationId&&Ie.remove(u.notificationId)},Cs=async()=>{c.on("ChatWsOpen",fn),c.on("ChatLoginSuccess",hn),c.on("ChatWsClose",Rn),c.on("im-ws-reconnect-start",un),c.on("im-ws-reconnect-failed",dn),c.on("ChatWsError",vn),c.on("ChatTokenExpirationDate",it),c.on("ChatLogoutSucceed",mn),c.on("ChatKickOut",gn),c.on("GroupCreatedEvent",_n),c.on("GroupChatGroupInfoUpdated",bn),c.on("ChatImSendAckMessage",An),c.on("ChatSendMessage",On),c.on("ChatConversationRead",kn),c.on("ChatMessageReceive",Cn),c.on("ChatGroupMemberRemoved",wn),c.on("ChatGroupMemberInvited",En),c.on("ChatGroupMasterChanged",Sn),c.on("ChatGroupDisbanded",Mn),c.on("ChatGroupMemberQuit",$n),c.on("ChatUserOnline",yn),c.on("ChatUserOffline",In),c.on("ChatContactUpdated",Tn),c.on("Chat-answer-agree",me),c.on("Chat-answer-hangup",me),c.on("Chat-Other-Client-Joined-Meeting",en),c.on("Chat-upcoming-meeting-join",nn),c.on("navbar-show-ar-login-qr-code",rt),c.on("meeting-notification-close",bt)},ys=async()=>{c.off("ChatWsOpen",fn),c.off("ChatLoginSuccess",hn),c.off("ChatWsClose",Rn),c.off("im-ws-reconnect-start",un),c.off("im-ws-reconnect-failed",dn),c.off("ChatWsError",vn),c.off("ChatTokenExpirationDate",it),c.off("ChatLogoutSucceed",mn),c.off("ChatKickOut",gn),c.off("GroupCreatedEvent",_n),c.off("GroupChatGroupInfoUpdated",bn),c.off("ChatImSendAckMessage",An),c.off("ChatSendMessage",On),c.off("ChatConversationRead",kn),c.off("ChatMessageReceive",Cn),c.off("ChatGroupMemberRemoved",wn),c.off("ChatGroupMemberInvited",En),c.off("ChatGroupMasterChanged",Sn),c.off("ChatGroupDisbanded",Mn),c.off("ChatGroupMemberQuit",$n),c.off("ChatUserOnline",yn),c.off("ChatUserOffline",In),c.off("ChatContactUpdated",Tn),c.off("Chat-answer-agree",me),c.off("Chat-answer-hangup",me),c.off("Chat-Other-Client-Joined-Meeting",en),c.off("Chat-upcoming-meeting-join",nn),c.off("navbar-show-ar-login-qr-code",rt),c.off("meeting-notification-close",bt)},Is=async()=>{console.log("\u5373\u65F6\u901A\u8BAF-\u521D\u59CB\u5316\u5EFA-websocket"),u.updateSocketStatus(2);let o="";Ue()?o=`wss://${pn.host}/chat-socket`:o=`wss://${window.location.host}/chat-socket`,x=new _r({wssUrl:o,userId:y.userId,token:wt()}),x.initChatWss(),Cs()},Ts=()=>{be(),at()};be=async()=>{vs(),A.value&&await A.value.logout(),p.updateThImEvent(null)},at=()=>{ys(),x&&x.logout(),h.updateChatImEvent(null)};const Ct=()=>{window.open("/assist/#/NoPermission","_self")},yt=async()=>{if(u.updateSocketStatus(2),O.value+=1,O.value>3){if(fe(a("error.logout.title1"),a("error.logout.tips4")),D.value)return;D.value=!0;return}const[o,r]=await Promise.all([await an(),await rn()]);if(console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E-memberRes&groupListRes",o,r),o.code===403||r.code===403){Ct();return}if(o.code===200&&r.code===200){const I=await fs();console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E-conversationRes",I),I.code===200?(await hs(),Is(),O.value=0):yt()}else(o.code!==401||r.code!==401)&&yt()},It=()=>{console.log("handleNetworkStatusChange",navigator.onLine),u.updateNetworkStatus(navigator.onLine),b.updateMemberStatus({client:ve.PC,userId:y.userId},navigator.onLine)},Nn=()=>{It()},Ln=()=>{It()},ws=()=>{window.addEventListener("online",Nn),window.addEventListener("offline",Ln)},Es=()=>{window.removeEventListener("online",Nn),window.removeEventListener("offline",Ln)},Pn=async()=>{var o;if(console.log(sessionStorage.getItem("refreshTokenStatus")),sessionStorage.getItem("refreshTokenStatus")!=="1"){sessionStorage.setItem("refreshTokenStatus","1");const r=await y.userResetLogin({refresh_token:Et()?Et():""});sessionStorage.setItem("refreshTokenStatus","0"),r.code===200?(Vn(r.data.tokenType),Hn(r.data.token),Wn(r.data.refreshToken),x&&A.value?(x==null||x.refreshToken({token:r.data.token}),(o=A.value)==null||o.refreshToken({token:r.data.token})):window.location.reload()):(Co(),C.push({path:"/login"}))}},Un=()=>{D.value||(fe(a("error.logout.title1"),a("error.logout.tips6")),D.value=!0)},Ss=()=>{c.on("sys-user-reset-login",Pn),c.on("sys-application-disabled",Un),c.on("sys-no-permission-access",Ct)},Ms=()=>{c.off("sys-user-reset-login",Pn),c.off("sys-application-disabled",Un),c.off("sys-no-permission-access",Ct)};window.addEventListener("storage",o=>{const r=N(wt()),I=pa(),R=fa();o.key==="token"&&(I!==R?C.push({name:"login"}):(r.value=o.newValue,window.location.reload())),o.key==="ASSIST_APP"&&I!==R&&C.push({name:"login"})});async function $s(){const o=await p.getLanguageList(),r=await p.getIndustryList();o.code===200&&r.code===200&&(p.updateLanguageList(o.data),p.updateIndustryList(r.data))}return et(async()=>{t(),Ss(),It(),ws(),S.value||(console.log("\u9996\u6B21\u52A0\u8F7D\u91CD\u8981\u6570\u636E"),await _(),await yt()),S.value=!0,$s()}),ut(()=>{Ms(),Ts(),bt(),Es(),O.value=0,S.value=!1,W.value=!1}),ha(),(o,r)=>{const I=Ba,R=Ga,oe=Fa,Q=Va,ge=De,ie=ko;return E(),B(Q,{class:Dt({layout:!0,mobile:M(g).hideMenu,"remote-micro-app-layout":Ae.value})},{default:v(()=>[k.value&&!Ae.value?(E(),H("div",Yd,[f(Wu)])):z("",!0),f(Q,null,{default:v(()=>[f(Q,null,{default:v(()=>[F.value?Ro((E(),B(I,{key:0,class:"layout-sider",breakpoint:"xl",collapsed:ht.value,collapsible:!0,width:Ce.value,style:zn({paddingTop:k.value?"60px":""}),"hide-trigger":!0,onCollapse:We},{default:v(()=>[i("div",Xd,[f(Lt)])]),_:1},8,["collapsed","width","style"])),[[No,!He.value]]):z("",!0),He.value?(E(),B(R,{key:1,visible:ke.value,placement:"left",footer:!1,"mask-closable":"",closable:!1,onCancel:Re},{default:v(()=>[f(Lt)]),_:1},8,["visible"])):z("",!0),f(Q,{class:"layout-content",style:zn(Oe.value)},{default:v(()=>[M(g).tabBar?(E(),B(cd,{key:0})):z("",!0),f(oe,null,{default:v(()=>[f(Zd)]),_:1})]),_:1},8,["style"])]),_:1})]),_:1}),f(ie,{visible:D.value,"onUpdate:visible":r[0]||(r[0]=Z=>D.value=Z),closable:!1,"esc-to-close":!1,"hide-cancel":!0,"mask-closable":!1,footer:!1},{default:v(()=>[i("div",ep,[i("div",tp,[(E(),B(Ke(M(mr))))]),i("div",np,[i("div",op,[i("span",null,$(te.value),1)])]),i("div",sp,$($e.value),1),i("div",ap,[f(ge,{type:"primary",onClick:qe},{default:v(()=>[ne($(o.$t("error.logout.btn.label1")),1)]),_:1})])])]),_:1},8,["visible"]),f(ie,{visible:K.value,"onUpdate:visible":r[1]||(r[1]=Z=>K.value=Z),"modal-class":"custom-modal",width:"398px",closable:!1,"esc-to-close":!1,"hide-cancel":!0,"mask-closable":!1,footer:!1},{default:v(()=>[i("div",rp,[i("div",ip,[(E(),B(Ke(M(sr))))]),i("div",cp,[i("div",lp,[i("span",null,$(o.$t("error.logout.tip10")),1)])]),i("div",up,$(o.$t("error.logout.tip9"))+" ("+$(_e.value)+"/30)",1),i("div",dp,[i("div",pp,[f(ge,{type:"outline",onClick:vt},{default:v(()=>[ne($(o.$t("error.logout.btn.label2")),1)]),_:1})]),i("div",fp,[f(ge,{type:"primary",onClick:qe},{default:v(()=>[ne($(o.$t("error.logout.btn.label3")),1)]),_:1})])])])]),_:1},8,["visible"]),f(ie,{visible:de.value,"onUpdate:visible":r[2]||(r[2]=Z=>de.value=Z),"modal-class":"custom-modal",width:"398px",closable:!1,"esc-to-close":!1,"hide-cancel":!0,"mask-closable":!1,footer:!1},{default:v(()=>[i("div",hp,[i("div",mp,[(E(),B(Ke(M(lr))))]),i("div",gp,[i("div",vp,[i("span",null,$(o.$t("error.logout.tip11")),1)])]),i("div",_p,[i("div",bp,[f(ge,{type:"outline",onClick:ms},{default:v(()=>[ne($(o.$t("error.logout.btn.label4")),1)]),_:1})]),i("div",Cp,[f(ge,{type:"primary",onClick:qe},{default:v(()=>[ne($(o.$t("error.logout.btn.label3")),1)]),_:1})])])])]),_:1},8,["visible"]),pe.value?(E(),B(ie,{key:1,visible:pe.value,"onUpdate:visible":r[3]||(r[3]=Z=>pe.value=Z),footer:!1,closable:!1,class:"customModal"},{default:v(()=>[pe.value?(E(),B(gd,{key:0,onHandleClose:Xt,onHandleJoinMeeting:is})):z("",!0)]),_:1},8,["visible"])):z("",!0),M(p).upcomingMeetingVisible?(E(),H("div",yp,[M(p).upcomingMeetingVisible?(E(),B(Od,{key:0,ref_key:"upcomingModalRef",ref:Ve},null,512)):z("",!0)])):z("",!0),X.value?(E(),B(ie,{key:3,visible:X.value,"onUpdate:visible":r[4]||(r[4]=Z=>X.value=Z),footer:!1,closable:!1,class:"customModal"},{default:v(()=>[X.value?(E(),B(Za,{key:0,onHandleClose:_t,onHandleJoinMeeting:cs})):z("",!0)]),_:1},8,["visible"])):z("",!0),he.value?(E(),B(ie,{key:4,visible:he.value,"onUpdate:visible":r[5]||(r[5]=Z=>he.value=Z),footer:!1,closable:!1,class:"customModal"},{default:v(()=>[he.value?(E(),B(jd,{key:0,onHandleClose:mt})):z("",!0)]),_:1},8,["visible"])):z("",!0)]),_:1},8,["class"])}}});const Pp=ce(wp,[["__scopeId","data-v-5a32a39a"]]);export{Pp as default};
