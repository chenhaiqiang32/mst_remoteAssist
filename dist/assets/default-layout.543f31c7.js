var Es=Object.defineProperty;var Ss=(e,t,n)=>t in e?Es(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var z=(e,t,n)=>(Ss(e,typeof t!="symbol"?t+"":t,n),n);import{u as Qe,f as vo,E as c,P as X,h as P,A as Tt,L as T,j as Ms,T as As,k as $s,K as Os,U as ks,l as Rs,G as Ns,C as K,M as Ne,m as Ls,n as Ps,o as _e,p as Us,q as Ds,r as xs,t as js,w as Bs,H as Ln,x as Ie,y as Pn,z as Un,B as Dn,D as xn,F as jn,I as Gs,J as Fs,N as xe,v as Se,i as Pe,O as _o,_ as ue,d as Pt,Q as bo,R as Vs,e as At,S as Hs,V as Ws,W as qs,X as zs,Y as Js,Z as Ks,$ as Qs,a0 as Ut,a1 as Zs,a2 as Ys,a3 as Xs,a4 as ea,a5 as ta,a6 as na,a7 as oa,a8 as sa,a9 as Co,aa as yo,ab as aa,ac as ra,ad as ia,g as wt,ae as ca,af as la,ag as ua,ah as Le,ai as j,aj as Et,a as Bn,b as Gn,c as Fn,ak as Vn,al as da}from"./index.56b53071.js";/* empty css              */import{C as E,D as H,E as i,H as pa,c as G,d as re,j as N,aI as m,bk as fa,bl as Io,h as ma,bm as ha,bn as ga,bo as va,b as it,u as M,aN as A,aH as v,aM as te,aW as V,bh as _a,ba,bb as Ca,aX as Ue,i as ya,w as To,aE as B,aF as J,aK as We,aJ as $t,F as Dt,bp as Ia,Q as Ta,b6 as wo,b7 as Eo,bq as So,br as Mo,bs as wa,bt as Ea,bc as Ao,b0 as $o,b1 as Oo,a0 as Sa,bu as Ma,b2 as Aa,a2 as $a,bv as Oa,bw as ka,o as Ze,bx as Ra,bf as Na,by as qe,bz as La,bA as Pa,p as Ua,G as Hn,bB as Te,bC as Da,aZ as xa,bD as ja,bE as Ba}from"./arco.7c13ffb5.js";import{f as Ye,h as ko,i as Ga}from"./vue.671e172d.js";import{i as Xe,b as et,r as de,a as tt,f as Fa,S as Wn,c as Va,o as Ha,d as Wa,e as Ro,g as qa}from"./icon_volume_1.11c747fb.js";import{l as za,j as Ja}from"./html2canvas.esm.7ed028a9.js";/* empty css              */import{c as No}from"./icon_close.f7fee805.js";import"./chart.a30fa8da.js";function Lo(){const e=Ye(),t=Qe();return{logout:async s=>{await t.logout();const a=e.currentRoute.value;vo(),e.push({name:s&&typeof s=="string"?s:"login",query:{...e.currentRoute.value.query,redirect:a.name}}),window.location.reload()}}}const Ka={width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Qa(e,t){return E(),H("svg",Ka,t[0]||(t[0]=[i("rect",{width:"56",height:"56",rx:"8",fill:"#0267FF"},null,-1),i("path",{d:"m28.065 31.061-2.238 1.965a1.48 1.48 0 0 1-.121 2.102l-5.597 4.91a1.509 1.509 0 0 1-2.117-.136l-3.994-4.478a1.48 1.48 0 0 1 .12-2.102l5.597-4.91a1.51 1.51 0 0 1 2.118.136l2.239-1.964-.999-1.12c-1.103-1.236-2.999-1.36-4.235-.274l-7.835 6.876a2.96 2.96 0 0 0-.242 4.203l5.99 6.717c1.104 1.236 3 1.36 4.236.274l7.835-6.876a2.96 2.96 0 0 0 .242-4.203l-.999-1.12Zm17.719-5.69-3.344-8.368c-.615-1.54-2.355-2.306-3.887-1.71l-9.704 3.774c-1.53.596-2.273 2.327-1.658 3.867l.557 1.395 2.773-1.079a1.478 1.478 0 0 1 .83-1.933l6.93-2.696a1.511 1.511 0 0 1 1.944.855l2.229 5.579a1.477 1.477 0 0 1-.83 1.933l-6.93 2.696a1.511 1.511 0 0 1-1.944-.855l-2.773 1.078.558 1.395c.615 1.54 2.355 2.306 3.886 1.71l9.705-3.774c1.53-.596 2.273-2.327 1.658-3.867ZM21.59 32.75c.552.619 1.5.68 2.118.138l3.398-2.982-2.031-2.21-3.364 2.953a1.48 1.48 0 0 0-.12 2.102Zm11.988-5.856a1.478 1.478 0 0 0 .83-1.933 1.511 1.511 0 0 0-1.944-.856l-4.126 1.605 1.035 2.82 4.205-1.636Zm-5.287-14.252L27.012 12l-1.755 4.747 1.28.642 1.755-4.746Zm-7.508 9.286-.293-1.498-6.337 1.227.291 1.499 6.34-1.228Zm2.015-4.074-2.662-5.037-1.305.814 2.661 5.037 1.306-.814Z",fill:"#fff"},null,-1)]))}const Za={render:Qa},Ya={width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Xa(e,t){return E(),H("svg",Ya,t[0]||(t[0]=[pa('<rect width="56" height="56" rx="8" fill="#FF3939"></rect><g fill="#fff"><path d="M28 10c9.941 0 18 8.059 18 18s-8.059 18-18 18-18-8.059-18-18 8.059-18 18-18Zm0 2.667c-8.468 0-15.333 6.865-15.333 15.333S19.532 43.333 28 43.333 43.333 36.468 43.333 28 36.468 12.667 28 12.667Z"></path><path d="M36.6 19.276c.629.629.629 1.257 0 1.886L21.162 36.6c-.629.629-1.257.629-1.886 0-.628-.628-.628-1.257 0-1.885l15.439-15.439c.628-.628 1.257-.628 1.885 0Z"></path><path d="M19.276 19.276c.629-.628 1.257-.628 1.886 0L36.6 34.715c.629.628.629 1.257 0 1.885-.628.629-1.257.629-1.885 0L19.276 21.162c-.628-.629-.628-1.257 0-1.886Z"></path></g>',2)]))}const er={render:Xa},tr={height:"56",viewBox:"0 0 56 56",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function nr(e,t){return E(),H("svg",tr,t[0]||(t[0]=[i("circle",{cx:"28",cy:"28",r:"28",fill:"#FF1500"},null,-1),i("path",{d:"M25.607 34a2.432 2.432 0 0 0 4.79 0l1.596-22a4.012 4.012 0 0 0-1.171-2.826A3.996 3.996 0 0 0 28.002 8a4.095 4.095 0 0 0-2.935 1.345A4.112 4.112 0 0 0 24.01 12.4L25.607 34Zm2.395 6a3.986 3.986 0 0 0-3.688 2.47 4.008 4.008 0 0 0 .865 4.358A3.988 3.988 0 0 0 31.993 44a3.786 3.786 0 0 0-1.098-2.9 3.77 3.77 0 0 0-2.893-1.1Z",fill:"#fff"},null,-1)]))}const or={render:nr};class sr{constructor(t){z(this,"websocket",null);z(this,"reconnectTimeout");z(this,"retryCount",0);z(this,"maxRetries",30);z(this,"initialReconnectDelay",3e3);z(this,"maxReconnectDelay",6e4);z(this,"wsUrl");z(this,"isConnected",!1);z(this,"isReConnect",!0);this.wsUrl=t,this.connect()}connect(){this.websocket||(console.log("222222222wsUrl>>>>",this.wsUrl),this.websocket=new WebSocket(this.wsUrl),this.websocket.binaryType="arraybuffer",this.websocket.addEventListener("open",this.onOpen.bind(this)),this.websocket.addEventListener("message",this.onMessage.bind(this)),this.websocket.addEventListener("close",this.onClose.bind(this)),this.websocket.addEventListener("error",this.onError.bind(this)))}onOpen(){console.log("\u5373\u65F6\u901A\u8BAF-WebSocket-websocketService connection open"),this.isConnected=!0,this.retryCount=0,this.clearReconnectTimeout(),c.emit("im-ws-open")}onMessage(t){const n=new Uint8Array(t.data);c.emit("im-ws-message",{data:n,_self:this})}onClose(t){console.log(`IM-Connection closed with code: ${t.code}`),this.isReConnect&&this.reconnect()}onError(t){console.error("IM-WebSocket error",t),c.emit("im-ws-error",{error:t,event:this})}reconnect(){if(!this.isReConnect){console.log("Max retries reached or reconnection is disabled.");return}if(console.log(`IM WebSocket reconnecting in ${this.initialReconnectDelay} ms... \u91CD\u8BD5\u6B21\u6570\uFF1A`,this.retryCount),this.retryCount>this.maxRetries){this.stopReconnect(),c.emit("im-ws-reconnect-failed");return}this.websocket=null,c.emit("im-ws-reconnect-start",{retryCount:this.retryCount}),this.reconnectTimeout=window.setTimeout(()=>{this.retryCount+=1,this.connect()},this.initialReconnectDelay)}stopReconnect(){console.log("IM WebSocket stop reconnect"),this.isReConnect=!1,this.retryCount=0,this.clearReconnectTimeout()}clearReconnectTimeout(){this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0)}sendMessage(t){this.websocket&&this.isConnected?this.websocket.send(t):console.warn("WebSocket is not connected. Message not sent.",t)}close(){console.log("IM WebSocket close"),this.stopReconnect(),this.websocket&&(this.websocket.close(),this.websocket=null)}}const ar=e=>new sr(e);class rr{constructor(t){z(this,"webSocketService",null);z(this,"wssUrl");z(this,"userId");z(this,"token");z(this,"intervalHeart",null);z(this,"lastLoginTime");z(this,"messageMap",new Map);const{wssUrl:n,userId:s,token:a}=t;this.wssUrl=n,this.userId=s,this.token=a,this.handleChatWsOpen=this.handleChatWsOpen.bind(this),this.handleChatWsMessage=this.handleChatWsMessage.bind(this),this.handleChatWsClose=this.handleChatWsClose.bind(this),this.handleChatWsError=this.handleChatWsError.bind(this)}handleChatWsOpen(){c.emit("ChatWsOpen","Chat WebSocket connection opened")}handleChatWsMessage(t){const{data:n}=t;console.log("chat-message--handleChatWsMessage",n);const s=X.decode(n);if(P.ACK===s.type){const a=Tt.decode(s.event),l=this.messageMap.get(a.fp);console.log("ChatPB.EventType.ACK",l),l&&(this.messageMap.delete(a.fp),c.emit("ChatMessageStatus",{fp:a.fp,status:!0}))}if(P.ACK!==s.type&&P.HEARTBEAT_PONG!==s.type&&this.sendAckMessage({fp:s.fp,timestamp:T.fromValue(s.timestamp).toNumber()}),P.LOGIN_SUCCEED===s.type){const a=Ms.decode(s.event);this.lastLoginTime=T.fromValue(a.lastLoginTime).toNumber(),console.log("\u5373\u65F6\u901A\u8BAF-websocket-\u767B\u5F55\u6210\u529F-\u670D\u52A1\u7AEF\u8FD4\u56DE\u503C",{...a,lastLoginTime:T.fromValue(a.lastLoginTime).toNumber()}),c.emit("ChatLoginSuccess",{...a,lastLoginTime:T.fromValue(a.lastLoginTime).toNumber()}),this.heartInterval()}if(P.TOKEN_EXPIRATION_DATE===s.type){const a=As.decode(s.event);console.log("\u63A5\u6536\u5230Token\u4E8B\u4EF6-TOKEN_EXPIRATION_DATE",a),c.emit("ChatTokenExpirationDate",a)}if(P.LOGOUT_SUCCEED===s.type){const a=$s.decode(s.event);console.log("\u63A5\u6536\u5230\u767B\u51FA\u6210\u529F\u4E8B\u4EF6-LOGOUT_SUCCEED",a),c.emit("ChatLogoutSucceed",a)}if(P.KICK_OUT===s.type){const a=Os.decode(s.event);console.log("\u8E22\u4E0B\u7EBF\u4E8B\u4EF6-KICK_OUT",a),c.emit("ChatKickOut",a)}if(P.CONTACT_UPDATED===s.type&&(console.log("\u901A\u8BAF\u5F55\u53D1\u751F\u53D8\u5316-CONTACT_UPDATED",s),c.emit("ChatContactUpdated")),P.CHAT_USER_ONLINE===s.type){const a=ks.decode(s.event);c.emit("ChatUserOnline",{client:a.client,userId:T.fromValue(a.userId).toNumber()})}if(P.CHAT_USER_OFFLINE===s.type){const a=Rs.decode(s.event);console.log("\u7528\u6237\u4E0B\u7EBF-CHAT_USER_OFFLINE",a,{client:a.client,userId:T.fromValue(a.userId).toNumber()}),c.emit("ChatUserOffline",{client:a.client,userId:T.fromValue(a.userId).toNumber()})}if(P.CHAT_GROUP_CREATED===s.type){const a=Ns.decode(s.event);console.log("\u7FA4\u7EC4\u521B\u5EFA\u4E8B\u4EF6-CHAT_GROUP_CREATED-dataContent",a);const l=[];a.userIds.forEach(h=>{l.push(T.fromValue(h).toNumber())});const p={eventType:s.type,eventData:{...a,groupId:T.fromValue(a.groupId).toNumber(),masterId:T.fromValue(a.masterId).toNumber(),timestamp:T.fromValue(a.timestamp).toNumber(),userIds:l}};c.emit("GroupCreatedEvent",{fp:s.fp,targetId:T.fromValue(a.groupId).toNumber(),chatType:K.GROUP_CHAT,targetAvatarUrl:a.avatarUrl,targetName:a.groupName,name:"",messageType:Ne.SYSTEM,content:JSON.stringify(p),sendTime:T.fromValue(a.timestamp).toNumber(),unreadCount:0})}if(P.CHAT_GROUP_INFO_UPDATED===s.type){const a=Ls.decode(s.event);console.log("\u7FA4\u7EC4\u4FE1\u606F\u66F4\u65B0\u4E8B\u4EF6-CHAT_GROUP_INFO_UPDATED",a),c.emit("GroupChatGroupInfoUpdated",{...a,groupId:T.fromValue(a.groupId).toNumber()})}if(P.CHAT_GROUP_MEMBER_REMOVED===s.type){const a=Ps.decode(s.event);console.log("\u7FA4\u7EC4\u6210\u5458\u8E22\u51FA\u4E8B\u4EF6-CHAT_GROUP_MEMBER_REMOVED-dataContent",a);const l=[];a.removedUserIds.forEach(h=>{l.push(T.fromValue(h).toNumber())});const p={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),masterId:T.fromValue(a.masterId).toNumber(),removedUserIds:l}};c.emit("ChatGroupMemberRemoved",{fingerPrint:s.fp,chatType:K.GROUP_CHAT,content:JSON.stringify(p),messageType:Ne.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:_e.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${K.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(P.CHAT_GROUP_MEMBER_INVITED===s.type){const a=Us.decode(s.event);console.log("\u7FA4\u7EC4\u9080\u8BF7\u6210\u5458\u4E8B\u4EF6-CHAT_GROUP_MEMBER_INVITED",a);const l=[];a.invitedUserIds.forEach(h=>{l.push(T.fromValue(h).toNumber())});const p={eventType:s.type,eventData:{...a,timestamp:T.fromValue(a.timestamp).toNumber,groupId:T.fromValue(a.groupId).toNumber(),groupName:a.groupName,inviteeUserIds:l,invitorUserId:T.fromValue(a.invitorUserId).toNumber()}};c.emit("ChatGroupMemberInvited",{fingerPrint:s.fp,chatType:K.GROUP_CHAT,content:JSON.stringify(p),messageType:Ne.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:_e.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${K.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(P.CHAT_GROUP_MASTER_CHANGED===s.type){const a=Ds.decode(s.event);console.log("\u7FA4\u4E3B\u53D8\u66F4\u4E8B\u4EF6-CHAT_GROUP_MASTER_CHANGED",a);const l={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),newMasterId:T.fromValue(a.newMasterId).toNumber(),oldMasterId:T.fromValue(a.oldMasterId).toNumber()}};c.emit("ChatGroupMasterChanged",{fingerPrint:s.fp,chatType:K.GROUP_CHAT,content:JSON.stringify(l),messageType:Ne.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:_e.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${K.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(P.CHAT_GROUP_DISBANDED===s.type){const a=xs.decode(s.event);console.log("\u7FA4\u89E3\u6563\u4E8B\u4EF6-CHAT_GROUP_DISBANDED",a);const l={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),masterId:T.fromValue(a.masterId).toNumber(),timestamp:T.fromValue(a.timestamp).toNumber()}};c.emit("ChatGroupDisbanded",{fingerPrint:s.fp,chatType:K.GROUP_CHAT,content:JSON.stringify(l),messageType:Ne.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:_e.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${K.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(P.CHAT_GROUP_MEMBER_QUIT===s.type){const a=js.decode(s.event);console.log("\u7FA4\u7EC4\u4EBA\u5458\u9000\u51FA-CHAT_GROUP_MEMBER_QUIT-dataContent",a);const l={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),quitUserId:T.fromValue(a.quitUserId).toNumber(),timestamp:T.fromValue(a.timestamp).toNumber()}};c.emit("ChatGroupMemberQuit",{fingerPrint:s.fp,chatType:K.GROUP_CHAT,content:JSON.stringify(l),messageType:Ne.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:_e.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${K.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(P.CHAT_MESSAGE_RECEIVED===s.type){const a=Bs.decode(s.event);console.log("\u6D88\u606F\u63A5\u6536\u4E8B\u4EF6-CHAT_MESSAGE_RECEIVED",a),this.sendAckMessage({fp:s.fp,timestamp:T.fromValue(a.timestamp).toNumber()}),c.emit("ChatMessageReceive",{fingerPrint:s.fp,chatType:a.chatType,content:a.content,messageType:a.messageType,recipientId:T.fromValue(a.recipientId).toNumber(),senderId:T.fromValue(a.senderId).toNumber(),sendTime:T.fromValue(a.timestamp).toNumber()})}}handleChatWsError(t){this.clearHeartInterval(),c.emit("ChatWsError",t)}handleChatWsClose(t){console.log("ChatWebSocket \u8FDE\u63A5\u5DF2\u5173\u95ED",t,this),this.clearHeartInterval(),c.emit("ChatWsClose","Chat WebSocket connection closed")}clearHeartInterval(){this.intervalHeart&&clearInterval(this.intervalHeart)}heartInterval(){this.intervalHeart=setInterval(()=>{if(!this.webSocketService){this.clearHeartInterval();return}const t=Date.now(),n=Ln.create(),s=Ln.encode(n).finish(),a=X.create({type:P.HEARTBEAT_PING,fp:Ie(),event:s,timestamp:t}),l=X.encode(a).finish();this.webSocketService.sendMessage(l)},1e3*30)}login(){var p;let t;this.lastLoginTime?t=this.lastLoginTime:t=Date.now(),console.log("Chat-login----lastLoginTime",this.lastLoginTime);const n=Pn.create({userId:this.userId,client:_e.PC,token:this.token,lastLoginTime:t}),s=Pn.encode(n).finish(),a=X.create({type:P.LOGIN_REQUEST,fp:Ie(),event:s,timestamp:t}),l=X.encode(a).finish();(p=this.webSocketService)==null||p.sendMessage(l)}refreshToken(t){console.log("Chat-refresh-token",t);const n=Date.now(),s=Un.create({token:t.token}),a=Un.encode(s).finish(),l=X.create({type:P.TOKEN_REFRESH,fp:Ie(),event:a,timestamp:n}),p=X.encode(l).finish();this.webSocketService.sendMessage(p)}sendLogoutMessage(){const t=Date.now(),n=Dn.create(),s=Dn.encode(n).finish(),a=X.create({type:P.LOGOUT_REQUEST,fp:Ie(),event:s,timestamp:t}),l=X.encode(a).finish();this.webSocketService.sendMessage(l)}logout(){this.webSocketService&&(this.clearHeartInterval(),this.handleOffEventBus(),this.sendLogoutMessage(),this.webSocketService.close())}handleOnEventBus(){c.on("im-ws-open",this.handleChatWsOpen),c.on("im-ws-message",this.handleChatWsMessage),c.on("im-ws-close",this.handleChatWsClose),c.on("im-ws-error",this.handleChatWsError)}handleOffEventBus(){c.off("im-ws-open",this.handleChatWsOpen),c.off("im-ws-message",this.handleChatWsMessage),c.off("im-ws-close",this.handleChatWsClose),c.off("im-ws-error",this.handleChatWsError)}initChatWss(){this.webSocketService=ar(this.wssUrl),this.webSocketService.connect(),this.handleOnEventBus()}chatWssReconnect(){this.webSocketService&&(this.webSocketService.stopReconnect(),this.initChatWss())}sendMessage(t){var g;const{fingerPrint:n,recipientId:s,chatType:a,messageType:l,content:p}=t,h=Date.now(),w=n||Ie(),_=xn.create({recipientId:s,chatType:a,messageType:l,content:p}),b=xn.encode(_).finish(),S=X.create({type:P.CHAT_MESSAGE_SEND,fp:w,event:b,timestamp:h}),O=X.encode(S).finish();this.messageMap.set(w,{timestamp:h,retries:0,data:O}),(g=this.webSocketService)==null||g.sendMessage(O),this.retryMessage(w)}retryMessage(t){!this.messageMap.get(t)||setTimeout(()=>{const s=this.messageMap.get(t);if(!!s){if(s.retries>=3){this.messageMap.delete(t),c.emit("ChatMessageStatus",{fp:t,status:!1});return}console.log(`\u6B63\u5728\u91CD\u8BD5\u6D88\u606F ${t}, \u5C1D\u8BD5\u6B21\u6570 ${s.retries+1}`),this.webSocketService.sendMessage(s.data),this.messageMap.set(t,{...s,retries:s.retries+1}),this.retryMessage(t)}},3e3)}sendAckMessage(t){var h;const n=Date.now(),s=Tt.create(t),a=Tt.encode(s).finish(),l=X.create({type:P.ACK,fp:Ie(),event:a,timestamp:n}),p=X.encode(l).finish();(h=this.webSocketService)==null||h.sendMessage(p)}sendChatReceivedMessageReadEvent(t){var h;const n=Date.now(),s=jn.create(t),a=jn.encode(s).finish(),l=X.create({type:P.CHAT_MESSAGE_READ,fp:Ie(),event:a,timestamp:n}),p=X.encode(l).finish();(h=this.webSocketService)==null||h.sendMessage(p)}}function ir(){return{accessRouter(e){var t,n,s,a;return!((t=e.meta)!=null&&t.requiresAuth)||!((n=e.meta)!=null&&n.roles)||((a=(s=e.meta)==null?void 0:s.roles)==null?void 0:a.includes("*"))},findFirstPermissionRoute(e,t="admin"){var s,a;const n=[...e];for(;n.length;){const l=n.shift();if((a=(s=l==null?void 0:l.meta)==null?void 0:s.roles)!=null&&a.find(p=>p.includes("*")||p.includes(t)))return{name:l.name};l!=null&&l.children&&n.push(...l.children)}return null}}}const cr=[...Gs,...Fs],lr=cr.map(e=>{const{name:t,path:n,meta:s,redirect:a,children:l}=e;return{name:t,path:n,meta:s,redirect:a,children:l}}),ur=lr;var dr=Array.isArray;const xt=dr;var pr="[object AsyncFunction]",fr="[object Function]",mr="[object GeneratorFunction]",hr="[object Proxy]";function Po(e){if(!Xe(e))return!1;var t=et(e);return t==fr||t==mr||t==pr||t==hr}var gr=de["__core-js_shared__"];const St=gr;var qn=function(){var e=/[^.]+$/.exec(St&&St.keys&&St.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function vr(e){return!!qn&&qn in e}var _r=Function.prototype,br=_r.toString;function Me(e){if(e!=null){try{return br.call(e)}catch{}try{return e+""}catch{}}return""}var Cr=/[\\^$.*+?()[\]{}|]/g,yr=/^\[object .+?Constructor\]$/,Ir=Function.prototype,Tr=Object.prototype,wr=Ir.toString,Er=Tr.hasOwnProperty,Sr=RegExp("^"+wr.call(Er).replace(Cr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Mr(e){if(!Xe(e)||vr(e))return!1;var t=Po(e)?Sr:yr;return t.test(Me(e))}function Ar(e,t){return e==null?void 0:e[t]}function Ae(e,t){var n=Ar(e,t);return Mr(n)?n:void 0}var $r=Ae(de,"WeakMap");const Ot=$r;var zn=Object.create,Or=function(){function e(){}return function(t){if(!Xe(t))return{};if(zn)return zn(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();const kr=Or;function Rr(e,t){var n=-1,s=e.length;for(t||(t=Array(s));++n<s;)t[n]=e[n];return t}var Nr=function(){try{var e=Ae(Object,"defineProperty");return e({},"",{}),e}catch{}}();const Jn=Nr;function Lr(e,t){for(var n=-1,s=e==null?0:e.length;++n<s&&t(e[n],n,e)!==!1;);return e}var Pr=9007199254740991,Ur=/^(?:0|[1-9]\d*)$/;function Dr(e,t){var n=typeof e;return t=t==null?Pr:t,!!t&&(n=="number"||n!="symbol"&&Ur.test(e))&&e>-1&&e%1==0&&e<t}function Uo(e,t,n){t=="__proto__"&&Jn?Jn(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Do(e,t){return e===t||e!==e&&t!==t}var xr=Object.prototype,jr=xr.hasOwnProperty;function xo(e,t,n){var s=e[t];(!(jr.call(e,t)&&Do(s,n))||n===void 0&&!(t in e))&&Uo(e,t,n)}function ct(e,t,n,s){var a=!n;n||(n={});for(var l=-1,p=t.length;++l<p;){var h=t[l],w=s?s(n[h],e[h],h,n,e):void 0;w===void 0&&(w=e[h]),a?Uo(n,h,w):xo(n,h,w)}return n}var Br=9007199254740991;function jo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Br}function Bo(e){return e!=null&&jo(e.length)&&!Po(e)}var Gr=Object.prototype;function jt(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Gr;return e===n}function Fr(e,t){for(var n=-1,s=Array(e);++n<e;)s[n]=t(n);return s}var Vr="[object Arguments]";function Kn(e){return tt(e)&&et(e)==Vr}var Go=Object.prototype,Hr=Go.hasOwnProperty,Wr=Go.propertyIsEnumerable,qr=Kn(function(){return arguments}())?Kn:function(e){return tt(e)&&Hr.call(e,"callee")&&!Wr.call(e,"callee")};const zr=qr;function Jr(){return!1}var Fo=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Qn=Fo&&typeof module=="object"&&module&&!module.nodeType&&module,Kr=Qn&&Qn.exports===Fo,Zn=Kr?de.Buffer:void 0,Qr=Zn?Zn.isBuffer:void 0,Zr=Qr||Jr;const Vo=Zr;var Yr="[object Arguments]",Xr="[object Array]",ei="[object Boolean]",ti="[object Date]",ni="[object Error]",oi="[object Function]",si="[object Map]",ai="[object Number]",ri="[object Object]",ii="[object RegExp]",ci="[object Set]",li="[object String]",ui="[object WeakMap]",di="[object ArrayBuffer]",pi="[object DataView]",fi="[object Float32Array]",mi="[object Float64Array]",hi="[object Int8Array]",gi="[object Int16Array]",vi="[object Int32Array]",_i="[object Uint8Array]",bi="[object Uint8ClampedArray]",Ci="[object Uint16Array]",yi="[object Uint32Array]",U={};U[fi]=U[mi]=U[hi]=U[gi]=U[vi]=U[_i]=U[bi]=U[Ci]=U[yi]=!0;U[Yr]=U[Xr]=U[di]=U[ei]=U[pi]=U[ti]=U[ni]=U[oi]=U[si]=U[ai]=U[ri]=U[ii]=U[ci]=U[li]=U[ui]=!1;function Ii(e){return tt(e)&&jo(e.length)&&!!U[et(e)]}function Bt(e){return function(t){return e(t)}}var Ho=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ze=Ho&&typeof module=="object"&&module&&!module.nodeType&&module,Ti=ze&&ze.exports===Ho,Mt=Ti&&Fa.process,wi=function(){try{var e=ze&&ze.require&&ze.require("util").types;return e||Mt&&Mt.binding&&Mt.binding("util")}catch{}}();const De=wi;var Yn=De&&De.isTypedArray,Ei=Yn?Bt(Yn):Ii;const Si=Ei;var Mi=Object.prototype,Ai=Mi.hasOwnProperty;function Wo(e,t){var n=xt(e),s=!n&&zr(e),a=!n&&!s&&Vo(e),l=!n&&!s&&!a&&Si(e),p=n||s||a||l,h=p?Fr(e.length,String):[],w=h.length;for(var _ in e)(t||Ai.call(e,_))&&!(p&&(_=="length"||a&&(_=="offset"||_=="parent")||l&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||Dr(_,w)))&&h.push(_);return h}function qo(e,t){return function(n){return e(t(n))}}var $i=qo(Object.keys,Object);const Oi=$i;var ki=Object.prototype,Ri=ki.hasOwnProperty;function Ni(e){if(!jt(e))return Oi(e);var t=[];for(var n in Object(e))Ri.call(e,n)&&n!="constructor"&&t.push(n);return t}function Gt(e){return Bo(e)?Wo(e):Ni(e)}function Li(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var Pi=Object.prototype,Ui=Pi.hasOwnProperty;function Di(e){if(!Xe(e))return Li(e);var t=jt(e),n=[];for(var s in e)s=="constructor"&&(t||!Ui.call(e,s))||n.push(s);return n}function Ft(e){return Bo(e)?Wo(e,!0):Di(e)}var xi=Ae(Object,"create");const Je=xi;function ji(){this.__data__=Je?Je(null):{},this.size=0}function Bi(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Gi="__lodash_hash_undefined__",Fi=Object.prototype,Vi=Fi.hasOwnProperty;function Hi(e){var t=this.__data__;if(Je){var n=t[e];return n===Gi?void 0:n}return Vi.call(t,e)?t[e]:void 0}var Wi=Object.prototype,qi=Wi.hasOwnProperty;function zi(e){var t=this.__data__;return Je?t[e]!==void 0:qi.call(t,e)}var Ji="__lodash_hash_undefined__";function Ki(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Je&&t===void 0?Ji:t,this}function Ee(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}Ee.prototype.clear=ji;Ee.prototype.delete=Bi;Ee.prototype.get=Hi;Ee.prototype.has=zi;Ee.prototype.set=Ki;function Qi(){this.__data__=[],this.size=0}function lt(e,t){for(var n=e.length;n--;)if(Do(e[n][0],t))return n;return-1}var Zi=Array.prototype,Yi=Zi.splice;function Xi(e){var t=this.__data__,n=lt(t,e);if(n<0)return!1;var s=t.length-1;return n==s?t.pop():Yi.call(t,n,1),--this.size,!0}function ec(e){var t=this.__data__,n=lt(t,e);return n<0?void 0:t[n][1]}function tc(e){return lt(this.__data__,e)>-1}function nc(e,t){var n=this.__data__,s=lt(n,e);return s<0?(++this.size,n.push([e,t])):n[s][1]=t,this}function pe(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}pe.prototype.clear=Qi;pe.prototype.delete=Xi;pe.prototype.get=ec;pe.prototype.has=tc;pe.prototype.set=nc;var oc=Ae(de,"Map");const Ke=oc;function sc(){this.size=0,this.__data__={hash:new Ee,map:new(Ke||pe),string:new Ee}}function ac(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function ut(e,t){var n=e.__data__;return ac(t)?n[typeof t=="string"?"string":"hash"]:n.map}function rc(e){var t=ut(this,e).delete(e);return this.size-=t?1:0,t}function ic(e){return ut(this,e).get(e)}function cc(e){return ut(this,e).has(e)}function lc(e,t){var n=ut(this,e),s=n.size;return n.set(e,t),this.size+=n.size==s?0:1,this}function je(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}je.prototype.clear=sc;je.prototype.delete=rc;je.prototype.get=ic;je.prototype.has=cc;je.prototype.set=lc;function zo(e,t){for(var n=-1,s=t.length,a=e.length;++n<s;)e[a+n]=t[n];return e}var uc=qo(Object.getPrototypeOf,Object);const Jo=uc;function dc(){this.__data__=new pe,this.size=0}function pc(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function fc(e){return this.__data__.get(e)}function mc(e){return this.__data__.has(e)}var hc=200;function gc(e,t){var n=this.__data__;if(n instanceof pe){var s=n.__data__;if(!Ke||s.length<hc-1)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new je(s)}return n.set(e,t),this.size=n.size,this}function Be(e){var t=this.__data__=new pe(e);this.size=t.size}Be.prototype.clear=dc;Be.prototype.delete=pc;Be.prototype.get=fc;Be.prototype.has=mc;Be.prototype.set=gc;function vc(e,t){return e&&ct(t,Gt(t),e)}function _c(e,t){return e&&ct(t,Ft(t),e)}var Ko=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Xn=Ko&&typeof module=="object"&&module&&!module.nodeType&&module,bc=Xn&&Xn.exports===Ko,eo=bc?de.Buffer:void 0,to=eo?eo.allocUnsafe:void 0;function Cc(e,t){if(t)return e.slice();var n=e.length,s=to?to(n):new e.constructor(n);return e.copy(s),s}function yc(e,t){for(var n=-1,s=e==null?0:e.length,a=0,l=[];++n<s;){var p=e[n];t(p,n,e)&&(l[a++]=p)}return l}function Qo(){return[]}var Ic=Object.prototype,Tc=Ic.propertyIsEnumerable,no=Object.getOwnPropertySymbols,wc=no?function(e){return e==null?[]:(e=Object(e),yc(no(e),function(t){return Tc.call(e,t)}))}:Qo;const Vt=wc;function Ec(e,t){return ct(e,Vt(e),t)}var Sc=Object.getOwnPropertySymbols,Mc=Sc?function(e){for(var t=[];e;)zo(t,Vt(e)),e=Jo(e);return t}:Qo;const Zo=Mc;function Ac(e,t){return ct(e,Zo(e),t)}function Yo(e,t,n){var s=t(e);return xt(e)?s:zo(s,n(e))}function $c(e){return Yo(e,Gt,Vt)}function Oc(e){return Yo(e,Ft,Zo)}var kc=Ae(de,"DataView");const kt=kc;var Rc=Ae(de,"Promise");const Rt=Rc;var Nc=Ae(de,"Set");const Nt=Nc;var oo="[object Map]",Lc="[object Object]",so="[object Promise]",ao="[object Set]",ro="[object WeakMap]",io="[object DataView]",Pc=Me(kt),Uc=Me(Ke),Dc=Me(Rt),xc=Me(Nt),jc=Me(Ot),we=et;(kt&&we(new kt(new ArrayBuffer(1)))!=io||Ke&&we(new Ke)!=oo||Rt&&we(Rt.resolve())!=so||Nt&&we(new Nt)!=ao||Ot&&we(new Ot)!=ro)&&(we=function(e){var t=et(e),n=t==Lc?e.constructor:void 0,s=n?Me(n):"";if(s)switch(s){case Pc:return io;case Uc:return oo;case Dc:return so;case xc:return ao;case jc:return ro}return t});const Ht=we;var Bc=Object.prototype,Gc=Bc.hasOwnProperty;function Fc(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&Gc.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var Vc=de.Uint8Array;const co=Vc;function Wt(e){var t=new e.constructor(e.byteLength);return new co(t).set(new co(e)),t}function Hc(e,t){var n=t?Wt(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var Wc=/\w*$/;function qc(e){var t=new e.constructor(e.source,Wc.exec(e));return t.lastIndex=e.lastIndex,t}var lo=Wn?Wn.prototype:void 0,uo=lo?lo.valueOf:void 0;function zc(e){return uo?Object(uo.call(e)):{}}function Jc(e,t){var n=t?Wt(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var Kc="[object Boolean]",Qc="[object Date]",Zc="[object Map]",Yc="[object Number]",Xc="[object RegExp]",el="[object Set]",tl="[object String]",nl="[object Symbol]",ol="[object ArrayBuffer]",sl="[object DataView]",al="[object Float32Array]",rl="[object Float64Array]",il="[object Int8Array]",cl="[object Int16Array]",ll="[object Int32Array]",ul="[object Uint8Array]",dl="[object Uint8ClampedArray]",pl="[object Uint16Array]",fl="[object Uint32Array]";function ml(e,t,n){var s=e.constructor;switch(t){case ol:return Wt(e);case Kc:case Qc:return new s(+e);case sl:return Hc(e,n);case al:case rl:case il:case cl:case ll:case ul:case dl:case pl:case fl:return Jc(e,n);case Zc:return new s;case Yc:case tl:return new s(e);case Xc:return qc(e);case el:return new s;case nl:return zc(e)}}function hl(e){return typeof e.constructor=="function"&&!jt(e)?kr(Jo(e)):{}}var gl="[object Map]";function vl(e){return tt(e)&&Ht(e)==gl}var po=De&&De.isMap,_l=po?Bt(po):vl;const bl=_l;var Cl="[object Set]";function yl(e){return tt(e)&&Ht(e)==Cl}var fo=De&&De.isSet,Il=fo?Bt(fo):yl;const Tl=Il;var wl=1,El=2,Sl=4,Xo="[object Arguments]",Ml="[object Array]",Al="[object Boolean]",$l="[object Date]",Ol="[object Error]",es="[object Function]",kl="[object GeneratorFunction]",Rl="[object Map]",Nl="[object Number]",ts="[object Object]",Ll="[object RegExp]",Pl="[object Set]",Ul="[object String]",Dl="[object Symbol]",xl="[object WeakMap]",jl="[object ArrayBuffer]",Bl="[object DataView]",Gl="[object Float32Array]",Fl="[object Float64Array]",Vl="[object Int8Array]",Hl="[object Int16Array]",Wl="[object Int32Array]",ql="[object Uint8Array]",zl="[object Uint8ClampedArray]",Jl="[object Uint16Array]",Kl="[object Uint32Array]",L={};L[Xo]=L[Ml]=L[jl]=L[Bl]=L[Al]=L[$l]=L[Gl]=L[Fl]=L[Vl]=L[Hl]=L[Wl]=L[Rl]=L[Nl]=L[ts]=L[Ll]=L[Pl]=L[Ul]=L[Dl]=L[ql]=L[zl]=L[Jl]=L[Kl]=!0;L[Ol]=L[es]=L[xl]=!1;function rt(e,t,n,s,a,l){var p,h=t&wl,w=t&El,_=t&Sl;if(n&&(p=a?n(e,s,a,l):n(e)),p!==void 0)return p;if(!Xe(e))return e;var b=xt(e);if(b){if(p=Fc(e),!h)return Rr(e,p)}else{var S=Ht(e),O=S==es||S==kl;if(Vo(e))return Cc(e,h);if(S==ts||S==Xo||O&&!a){if(p=w||O?{}:hl(e),!h)return w?Ac(e,_c(p,e)):Ec(e,vc(p,e))}else{if(!L[S])return a?e:{};p=ml(e,S,h)}}l||(l=new Be);var g=l.get(e);if(g)return g;l.set(e,p),Tl(e)?e.forEach(function(u){p.add(rt(u,t,n,u,e,l))}):bl(e)&&e.forEach(function(u,C){p.set(C,rt(u,t,n,C,e,l))});var y=_?w?Oc:$c:w?Ft:Gt,d=b?void 0:y(e);return Lr(d||e,function(u,C){d&&(C=u,u=e[C]),xo(p,C,rt(u,t,n,C,e,l))}),p}var Ql=1,Zl=4;function Yl(e){return rt(e,Ql|Zl)}function Xl(){const e=ir(),t=xe(),n=G(()=>t.menuFromServer?t.appAsyncMenus:ur);return{menuTree:G(()=>{const a=Yl(n.value);a.sort((p,h)=>(p.meta.order||0)-(h.meta.order||0));function l(p,h){return p?p.map(_=>{var S,O;if(!e.accessRouter(_))return null;if(((S=_.meta)==null?void 0:S.hideChildrenInMenu)||!_.children)return _.children=[],_;_.children=_.children.filter(g=>{var y;return((y=g.meta)==null?void 0:y.hideInMenu)!==!0});const b=l(_.children,h+1);return b.length||h>1?(_.children=b,_):((O=_.meta)==null?void 0:O.hideInMenu)===!1?_:null}).filter(Boolean):null}return l(a,0)})}}function eu(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Io(e)}const tu=re({emit:["collapse"],setup(){const{t:e}=Se.exports.useI18n(),t=xe(),n=Ye(),s=ko(),{menuTree:a}=Xl(),l=G({get(){return Pe()||t.device==="desktop"?t.menuCollapse:!1},set(g){t.updateSettings({menuCollapse:g})}}),p=G(()=>t.topMenu),h=N([]),w=N([]),_=g=>{if(Va.test(g.path)){Ha(g.path),w.value=[g.name];return}const{hideInMenu:y,activeMenu:d}=g.meta;if(s.name===g.name&&!y&&!d){w.value=[g.name];return}n.push({name:g.name})},b=g=>{const y=[];let d=!1;const u=(C,f)=>{var D;if(C.name===g){d=!0,y.push(...f);return}(D=C.children)!=null&&D.length&&C.children.forEach(W=>{u(W,[...f,W.name])})};return a.value.forEach(C=>{d||u(C,[C.name])}),y};_o(g=>{const{requiresAuth:y,activeMenu:d,hideInMenu:u}=g.meta;if(y&&(!u||d)){const C=b(d||g.name),f=new Set([...C,...h.value]);h.value=[...f],w.value=[d||C[C.length-1]]}},!0);const S=g=>{Pe()&&t.updateSettings({menuCollapse:g}),t.device==="desktop"&&t.updateSettings({menuCollapse:g})},O=()=>{function g(y,d=[]){return y&&y.forEach(u=>{var D,W;const C=(D=u==null?void 0:u.meta)!=null&&D.icon?(W=u==null?void 0:u.meta)==null?void 0:W.icon:"",f=(u==null?void 0:u.children)&&(u==null?void 0:u.children.length)!==0?m(ga,{key:u==null?void 0:u.name},{default:()=>[g(u==null?void 0:u.children)],icon:()=>m("i",{class:`iconfont ${C}`},null),title:()=>{var ne;return ma(ha(e(((ne=u==null?void 0:u.meta)==null?void 0:ne.locale)||"")))}}):m(va,{key:u==null?void 0:u.name,onClick:()=>_(u)},{default:()=>{var ne;return[e(((ne=u==null?void 0:u.meta)==null?void 0:ne.locale)||"")]},icon:()=>m("i",{class:`iconfont ${C}`},null)});d.push(f)}),d}return g(a.value)};return()=>{let g;return m(fa,{mode:p.value?"horizontal":"vertical",collapsed:l.value,"onUpdate:collapsed":y=>l.value=y,"open-keys":h.value,"onUpdate:open-keys":y=>h.value=y,"show-collapse-button":Pe()?!0:t.device!=="mobile","auto-open":!1,"selected-keys":w.value,"auto-open-selected":!0,"level-indent":34,style:"height: 100%;width:100%;",onCollapse:S},eu(g=O())?g:{default:()=>[g]})}}});const Lt=ue(tu,[["__scopeId","data-v-5fd36c54"]]),nu={class:"change-password-container modal-container"},ou=["src"],su={class:"modal-title"},au={class:"modal-main wsl-scroll"},ru={class:"modal-bot"},iu=re({__name:"chang",emits:["handleClose","handleConfirmation"],setup(e,{emit:t}){const{t:n}=Se.exports.useI18n(),s=t,a=Qe(),l=N({password:"",surePassword:""}),p=()=>{l.value={password:"",surePassword:""}},h=()=>{p(),s("handleClose")},w=async()=>{if(!l.value.password){V.warning(n("password.modal.placeholder.new"));return}if(!l.value.surePassword){V.warning(n("password.modal.placeholder.sure"));return}if(l.value.password!==l.value.surePassword){V.warning(n("password.form.btn.inconformity"));return}const _=await a.revampPassword({newPassword:l.value.password});if(_.code!==200&&_.code!==401){V.error(_.msg);return}V.success(n("password.form.btn.success")),h(),s("handleConfirmation")};return it(()=>{p()}),(_,b)=>{const S=_a,O=ba,g=Ca,y=Ue;return E(),H("div",nu,[i("div",{class:"modal-fixed",onClick:h},[i("img",{src:M(No),alt:""},null,8,ou)]),i("div",su,A(_.$t("password.modal.title")),1),i("div",au,[m(g,{model:l.value,layout:"vertical"},{default:v(()=>[m(O,{field:"password",label:_.$t("password.modal.new")},{default:v(()=>[m(S,{modelValue:l.value.password,"onUpdate:modelValue":b[0]||(b[0]=d=>l.value.password=d),placeholder:_.$t("password.modal.placeholder.new"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),m(O,{field:"surePassword",label:_.$t("password.modal.sure")},{default:v(()=>[m(S,{modelValue:l.value.surePassword,"onUpdate:modelValue":b[1]||(b[1]=d=>l.value.surePassword=d),placeholder:_.$t("password.modal.placeholder.sure"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),i("div",ru,[m(y,{class:"modal-btn-item",onClick:h},{default:v(()=>[te(A(_.$t("password.form.btn.cancel")),1)]),_:1}),m(y,{class:"modal-btn-item",disabled:!l.value.password||!l.value.surePassword,type:"primary",onClick:w},{default:v(()=>[te(A(_.$t("password.form.btn.sure")),1)]),_:1},8,["disabled"])])])}}});const cu=ue(iu,[["__scopeId","data-v-a9f3d9bb"]]),lu={width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function uu(e,t){return E(),H("svg",lu,t[0]||(t[0]=[i("g",{"fill-rule":"evenodd","clip-rule":"evenodd",fill:"#4E5969"},[i("path",{d:"M12.834 3.167a4.546 4.546 0 0 0-7.556 4.565.5.5 0 0 1-.124.501l-3.13 3.13a.766.766 0 0 0-.146.27.718.718 0 0 0-.043.301v.004l.2 1.449a.719.719 0 0 0 .207.375c.12.12.255.186.367.202l1.457.2c.066.01.179.003.305-.038a.662.662 0 0 0 .257-.141l.006-.006 3.14-3.133a.5.5 0 0 1 .502-.124A4.55 4.55 0 0 0 12.841 9.6a4.552 4.552 0 0 0-.007-6.432Zm-7.133-.708a5.55 5.55 0 0 1 7.846 7.847v.001a5.55 5.55 0 0 1-5.274 1.453l-2.93 2.924c-.186.19-.432.318-.663.393a1.719 1.719 0 0 1-.758.077l-1.45-.2a1.674 1.674 0 0 1-.938-.487 1.712 1.712 0 0 1-.488-.932l-.001-.007-.2-1.45v-.002c-.037-.259.008-.53.084-.76.077-.23.203-.47.38-.651l.004-.006 2.928-2.927A5.541 5.541 0 0 1 5.7 2.46Z"}),i("path",{d:"M4.24 11.307a.5.5 0 0 1 .707 0l1.534 1.533a.5.5 0 1 1-.707.707L4.24 12.014a.5.5 0 0 1 0-.707ZM9.668 5.834a.5.5 0 1 0 0 1 .5.5 0 0 0 0-1Zm-1.5.5a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"})],-1)]))}const du={render:uu},pu={class:"navbar"},fu={class:"left-side"},mu=["src"],hu={class:"center-side"},gu={class:"right-side"},vu={class:"quick_access_main"},_u=["onClick"],bu={class:"quick_access_main_item_main"},Cu=["src"],yu={class:"quick_access_main_item_m_label"},Iu=["src"],Tu={class:"user-info"},wu={class:"user-info-name"},Eu={class:"user-info-bot"},Su={class:"user-info-bot-l"},Mu={class:"user-info-bot-l"},Au=["src"],mo="ChatDB",$u=re({__name:"index",setup(e){const t=xe(),n=Qe(),s=Pt(),a=bo(),l=Vs(),p=Ye(),{t:h,locale:w}=Se.exports.useI18n(),{getAllConversations:_}=At(mo),{clearAll:b}=At(mo),{logout:S}=Lo(),{changeLocale:O,currentLocale:g}=Hs(),y=[...Qs],d=G(()=>n.avatarUrl),u=G(()=>n.name),C=G(()=>s.socketStatus===1?h("socket.status1"):s.socketStatus===2?h("socket.status2"):""),f=G(()=>t.topMenu&&t.menu),D=N(),W=async()=>{await S(),b()},ne=()=>{const k=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});D.value.dispatchEvent(k)},$e=ya("toggleDrawerMenu"),Q=N(!1),be=()=>{Q.value=!0},fe=()=>{Q.value=!1},me=()=>{fe()},Ge=()=>{c.emit("navbar-show-ar-login-qr-code")},ee=N(0),Ce=N([]),nt=async()=>{ee.value=0,Ce.value=await _(),Ce.value?Ce.value.forEach(k=>{ee.value+=k.unreadCount}):ee.value=0},he=k=>JSON.parse(k.entryName)[w.value],x=async k=>{if(console.log("handleInitQuitList",k),k){const F=await l.getQuickList();if(F.code!==200&&F.code!==401){if(F.code===20408)return;V.error(F.msg);return}l.updateQuickEnters(F.data)}},$=async k=>{if(k.isOwnApp===0)window.open(k.entryUri,"_blank");else{const F=await n.getApplicationCode({client_id:k.appId,redirect_uri:k.entryUri,scope:"snsapi_base"});if(F.code!==200&&F.code!==401)return F.code===20408||V.error(F.msg),!1;window.open(`${k.entryUri}?code=${F.data.code}`,"_blank")}return!1},Oe=k=>{p.push({path:k})};return To(()=>a.conversationList,k=>{k&&nt()},{deep:!0,immediate:!0}),(k,F)=>{const Fe=Ia,ot=Ta,ke=wo,dt=Ws,Re=Ue,ge=Eo,pt=Sa,ye=So,se=Mo,st=qs,ft=zs,at=wa,Ve=Js,mt=Ea,ht=Ma,He=Ks,gt=Ao;return E(),H("div",pu,[i("div",fu,[m(ke,null,{default:v(()=>{var q;return[i("img",{alt:"logo",src:(q=M(s).platformConfig)==null?void 0:q.oneToOneLogo},null,8,mu),m(Fe,{style:{margin:0,fontSize:"18px"},heading:5},{default:v(()=>[te(A(k.$t("platform.title")),1)]),_:1}),!f.value&&M(t).device==="mobile"?(E(),B(ot,{key:0,style:{"font-size":"22px",cursor:"pointer"},onClick:M($e)},null,8,["onClick"])):J("",!0)]}),_:1})]),i("div",hu,[f.value?(E(),B(Lt,{key:0})):J("",!0)]),i("ul",gu,[i("li",null,[m(ge,{content:k.$t("settings.language")},{default:v(()=>[m(Re,{class:"nav-btn",type:"outline",shape:"circle",onClick:ne},{icon:v(()=>[m(dt)]),_:1})]),_:1},8,["content"]),m(se,{trigger:"click",onSelect:M(O)},{content:v(()=>[(E(),H(We,null,$t(y,q=>m(ye,{key:q.value,value:q.value},{icon:v(()=>[$o(m(pt,null,null,512),[[Oo,q.value===M(g)]])]),default:v(()=>[te(" "+A(q.label),1)]),_:2},1032,["value"])),64))]),default:v(()=>[i("div",{ref_key:"triggerBtn",ref:D,class:"trigger-btn"},null,512)]),_:1},8,["onSelect"])]),i("li",null,[m(se,{onPopupVisibleChange:x},{content:v(()=>[i("div",vu,[(E(!0),H(We,null,$t(M(l).quickEnters,(q,ie)=>(E(),H("div",{key:`quick_${ie}`,class:"quick_access_main_item",onClick:vt=>$(q)},[i("div",bu,[i("img",{class:"quick_access_main_item_m_icon",src:q.iconUrl,alt:""},null,8,Cu),i("div",yu,[i("span",null,A(he(q)),1)])])],8,_u))),128))])]),default:v(()=>[m(ge,{content:k.$t("settings.application")},{default:v(()=>[m(Re,{class:"nav-btn",type:"outline",shape:"circle"},{icon:v(()=>[m(st)]),_:1})]),_:1},8,["content"])]),_:1})]),i("li",null,[m(at,{count:ee.value,dot:""},{default:v(()=>[m(Re,{class:"nav-btn",type:"outline",shape:"circle",onClick:F[0]||(F[0]=q=>Oe("/Message-List"))},{default:v(()=>[m(ft)]),_:1})]),_:1},8,["count"])]),i("li",null,[m(ge,{content:k.$t("messageBox.ar.logo.title")},{default:v(()=>[m(Re,{class:"nav-btn",type:"outline",shape:"circle",onClick:Ge},{icon:v(()=>[m(Ve)]),_:1})]),_:1},8,["content"])]),i("li",null,[m(mt,{size:32,style:{marginRight:"8px",cursor:"pointer"}},{default:v(()=>[i("img",{alt:"avatar",src:d.value},null,8,Iu)]),_:1}),m(se,{trigger:"click",position:"br"},{content:v(()=>[m(ye,null,{default:v(()=>[m(ke,null,{default:v(()=>[i("img",{style:{width:"14px",height:"14px",borderRadius:"50%"},src:d.value,alt:""},null,8,Au),i("span",null,A(u.value),1)]),_:1})]),_:1}),m(ye,{onClick:be},{default:v(()=>[m(ke,null,{default:v(()=>[m(M(du)),i("span",null,A(k.$t("messageBox.change.password")),1)]),_:1})]),_:1}),m(ye,{onClick:W},{default:v(()=>[m(ke,null,{default:v(()=>[m(He),i("span",null,A(k.$t("messageBox.logout")),1)]),_:1})]),_:1})]),default:v(()=>[i("div",Tu,[i("div",wu,[i("span",null,A(u.value),1)]),i("div",Eu,[M(s).networkStatus?(E(),H(We,{key:0},[M(s).socketStatus==3?(E(),H("div",{key:0,class:Dt(["user-info-bot-i",M(s).networkStatus?"online":"outline"])},null,2)):J("",!0),M(s).socketStatus===2?(E(),B(ht,{key:1,size:12})):J("",!0),i("div",Su,A(M(s).socketStatus===2?C.value:k.$t("meeting.invite.line.status.online")),1)],64)):(E(),H(We,{key:1},[F[2]||(F[2]=i("div",{class:"user-info-bot-i outline"},null,-1)),i("div",Mu,A(k.$t("meeting.invite.line.status.outline")),1)],64))])])]),_:1})])]),Q.value?(E(),B(gt,{key:0,visible:Q.value,"onUpdate:visible":F[1]||(F[1]=q=>Q.value=q),footer:!1,closable:!1,class:"customModal"},{default:v(()=>[m(cu,{onHandleClose:fe,onHandleConfirmation:me})]),_:1},8,["visible"])):J("",!0)])}}});const Ou=ue($u,[["__scopeId","data-v-07bcb5ee"]]);const ku={class:"tag-link"},Ru=re({__name:"tab-item",props:{itemData:{type:Object,default(){return[]}},index:{type:Number,default:0}},setup(e){const t=e,n=Ye(),s=ko(),a=Ut(),l=y=>{n.push({...y})},p=G(()=>a.getTabList),h=G(()=>t.itemData.fullPath!==s.fullPath),w=G(()=>t.index===0),_=G(()=>[0,1].includes(t.index)),b=G(()=>t.index===p.value.length-1),S=(y,d)=>{if(a.deleteTag(d,y),t.itemData.fullPath===s.fullPath){const u=p.value[d-1];n.push({name:u.name})}},O=()=>p.value.findIndex(y=>y.fullPath===s.fullPath),g=async y=>{const{itemData:d,index:u}=t,C=[...p.value];if(y==="current")S(d,u);else if(y==="left"){const f=O();C.splice(1,t.index-1),a.freshTabList(C),f<u&&n.push({name:d.name})}else if(y==="right"){const f=O();C.splice(t.index+1),a.freshTabList(C),f>u&&n.push({name:d.name})}else if(y==="others"){const f=p.value.filter((D,W)=>W===0||W===t.index);a.freshTabList(f),n.push({name:d.name})}else y==="reload"?(a.deleteCache(d),await n.push({name:Zs,params:{path:s.fullPath}}),a.addCache(d.name)):(a.resetTabList(),n.push({name:Ys}))};return(y,d)=>{const u=$a,C=Xs,f=So,D=ea,W=ta,ne=na,$e=oa,Q=Mo;return E(),B(Q,{trigger:"contextMenu","popup-max-height":!1,onSelect:g},{content:v(()=>[m(f,{disabled:h.value,value:"reload"},{default:v(()=>[m(C),d[2]||(d[2]=i("span",null,"\u91CD\u65B0\u52A0\u8F7D",-1))]),_:1,__:[2]},8,["disabled","value"]),m(f,{class:"sperate-line",disabled:w.value,value:"current"},{default:v(()=>[m(u),d[3]||(d[3]=i("span",null,"\u5173\u95ED\u5F53\u524D\u6807\u7B7E\u9875",-1))]),_:1,__:[3]},8,["disabled","value"]),m(f,{disabled:_.value,value:"left"},{default:v(()=>[m(D),d[4]||(d[4]=i("span",null,"\u5173\u95ED\u5DE6\u4FA7\u6807\u7B7E\u9875",-1))]),_:1,__:[4]},8,["disabled","value"]),m(f,{class:"sperate-line",disabled:b.value,value:"right"},{default:v(()=>[m(W),d[5]||(d[5]=i("span",null,"\u5173\u95ED\u53F3\u4FA7\u6807\u7B7E\u9875",-1))]),_:1,__:[5]},8,["disabled","value"]),m(f,{value:"others"},{default:v(()=>[m(ne),d[6]||(d[6]=i("span",null,"\u5173\u95ED\u5176\u5B83\u6807\u7B7E\u9875",-1))]),_:1,__:[6]},8,["value"]),m(f,{value:"all"},{default:v(()=>[m($e),d[7]||(d[7]=i("span",null,"\u5173\u95ED\u5168\u90E8\u6807\u7B7E\u9875",-1))]),_:1,__:[7]},8,["value"])]),default:v(()=>[i("span",{class:Dt(["arco-tag arco-tag-size-medium arco-tag-checked",{"link-activated":e.itemData.fullPath===y.$route.fullPath}]),onClick:d[1]||(d[1]=be=>l(e.itemData))},[i("span",ku,A(y.$t(e.itemData.title)),1),i("span",{class:"arco-icon-hover arco-tag-icon-hover arco-icon-hover-size-medium arco-tag-close-btn",onClick:d[0]||(d[0]=Aa(be=>S(e.itemData,e.index),["stop"]))},[m(u)])],2)]),_:1})}}});const Nu=ue(Ru,[["__scopeId","data-v-17257cfa"]]),Lu={class:"tab-bar-container"},Pu={class:"tab-bar-box"},Uu={class:"tab-bar-scroll"},Du={class:"tags-wrap"},xu=re({__name:"index",setup(e){const t=xe(),n=Ut(),s=N(),a=G(()=>n.getTabList),l=G(()=>t.navbar?60:0);return To(()=>t.navbar,()=>{s.value.updatePosition()}),_o(p=>{!p.meta.noAffix&&!a.value.some(h=>h.fullPath===p.fullPath)&&n.updateTabList(p)},!0),Oa(()=>{sa()}),(p,h)=>{const w=ka;return E(),H("div",Lu,[m(w,{ref_key:"affixRef",ref:s,"offset-top":l.value},{default:v(()=>[i("div",Pu,[i("div",Uu,[i("div",Du,[(E(!0),H(We,null,$t(a.value,(_,b)=>(E(),B(Nu,{key:_.fullPath,index:b,"item-data":_},null,8,["index","item-data"]))),128))])]),h[0]||(h[0]=i("div",{class:"tag-bar-operation"},null,-1))])]),_:1},8,["offset-top"])])}}});const ju=ue(xu,[["__scopeId","data-v-509db106"]]),Bu={class:"room-options-container"},Gu=["src"],Fu={class:"link-m-t borderB"},Vu={class:"room-options-main"},Hu={class:"link-m-b"},Wu={class:"link-m-b-btn"},qu=re({__name:"force_entry",emits:["handleClose","handleJoinMeeting"],setup(e,{emit:t}){const n=t,{t:s}=Se.exports.useI18n(),a=()=>{n("handleClose")},p=Wa(async()=>{n("handleJoinMeeting")},1e3);return(h,w)=>(E(),H("div",Bu,[i("div",{class:"room-fixed",onClick:a},[i("img",{src:M(Ro),alt:""},null,8,Gu)]),i("div",Fu,[i("span",null,A(M(s)("meeting.modal.title")),1)]),i("div",Vu,[i("span",null,A(M(s)("meeting.modal.force.desc")),1)]),i("div",Hu,[i("div",Wu,[i("div",{class:"link-m-b-btn-i btn-border",onClick:a},[i("span",null,A(M(s)("meeting.modal.btn.cancel")),1)]),i("div",{class:"link-m-b-btn-i btn-bg",onClick:w[0]||(w[0]=(..._)=>M(p)&&M(p)(..._))},[i("span",null,A(M(s)("meeting.modal.btn.sure")),1)])])])]))}});const zu=ue(qu,[["__scopeId","data-v-beb61611"]]),Ju={class:"upcoming-container"},Ku={class:"upcoming-container-top"},Qu={class:"upcoming-container-top-l"},Zu=["src"],Yu={class:"upcoming-container-top-l-r"},Xu=["src"],ed={class:"upcoming-container-main"},td={class:"upcoming-container-main-top textEllipsis"},nd={class:"upcoming-container-main-bot"},od={class:"upcoming-container-main-bot-i one"},sd={class:"upcoming-container-main-bot-i"},ad={class:"upcoming-container-menu"},rd=re({__name:"index",setup(e,{expose:t}){const{t:n}=Se.exports.useI18n(),s=Co(),a=yo(),l=N(""),p=b=>b?qa(b,"HH:mm"):"",h=async b=>{if(b){const S=await a.filterMemberInfoByUserId(b);l.value=S.name}},w=()=>{s.removeUpcomingMeetingList(s.upcomingMeetingInfo),s.upcomingMeetingList.length>0?s.updateUpcomingMeetingInfo(s.upcomingMeetingList[0]):(s.updateUpcomingMeetingInfo(null),s.updateUpcomingMeetingVisible(!1))},_=async()=>{c.emit("meeting-notification-close"),c.emit("Chat-upcoming-meeting-join")};return Ze(()=>{h(s.upcomingMeetingInfo.master)}),t({handleClose:w}),(b,S)=>{var y,d,u;const O=Eo,g=Ue;return E(),H("div",Ju,[i("div",Ku,[i("div",Qu,[i("img",{src:M(za),alt:""},null,8,Zu),i("div",Yu,[i("span",null,A(M(n)("meeting.modal.upcoming.title")),1)])]),i("div",{class:"upcoming-container-top-r",onClick:w},[i("img",{src:M(No),alt:""},null,8,Xu)])]),i("div",ed,[m(O,{content:(y=M(s).upcomingMeetingInfo)==null?void 0:y.subject},{default:v(()=>{var C;return[i("div",td,A((C=M(s).upcomingMeetingInfo)==null?void 0:C.subject),1)]}),_:1},8,["content"]),i("div",nd,[i("div",od,[i("span",null,A(M(n)("meeting.modal.upcoming.content2"))+":",1),S[0]||(S[0]=te(" \xA0 ")),i("span",null,A(l.value),1)]),i("div",sd,[i("span",null,A(M(n)("meeting.modal.upcoming.content1"))+":",1),S[1]||(S[1]=te(" \xA0 ")),i("span",null,A(p((d=M(s).upcomingMeetingInfo)==null?void 0:d.startTime))+" - "+A(p((u=M(s).upcomingMeetingInfo)==null?void 0:u.endTime)),1)])])]),i("div",ad,[m(g,{long:"",class:"modal-btn-item",onClick:w},{default:v(()=>[te(A(b.$t("meeting.modal.upcoming.btn1")),1)]),_:1}),m(g,{long:"",class:"modal-btn-item",type:"primary",onClick:_},{default:v(()=>[te(A(b.$t("meeting.modal.upcoming.btn2")),1)]),_:1})])])}}});const id=ue(rd,[["__scopeId","data-v-204ae469"]]),cd={class:"ar-qr-code-modal-container"},ld=["src"],ud={class:"ar-qr-code-main"},dd={class:"ar-qr-code-main-top"},pd={class:"ar-qr-code-main-mid-body"},fd={class:"ar-qr-code-main-bot"},md={class:"ar-qr-code-main-bot-desc"},hd=re({__name:"index",emits:["handleClose"],setup(e,{emit:t}){const n=N(null),s=t,{t:a}=Se.exports.useI18n();N(!0);const l=()=>{s("handleClose")},p=Qe(),h=Pt(),w=N(""),_=async()=>{const S=await p.getArLoginQrCode({command:0});if(S.code!==200&&S.code!==401){V.error(S.msg);return}w.value=S.data},b=async()=>{n.value&&(await _(),n.value.innerHTML="",aa.toCanvas(w.value,{errorCorrectionLevel:"H",width:180,margin:2},(S,O)=>{var y;if(S){console.error(S);return}n.value&&n.value.appendChild(O);const g=O.getContext("2d");if(g){const u=(O.width-30)/2,C=(O.height-30)/2;g.beginPath(),g.moveTo(u+5,C),g.lineTo(u+30-5,C),g.quadraticCurveTo(u+30,C,u+30,C+5),g.lineTo(u+30,C+30-5),g.quadraticCurveTo(u+30,C+30,u+30-5,C+30),g.lineTo(u+5,C+30),g.quadraticCurveTo(u,C+30,u,C+30-5),g.lineTo(u,C+5),g.quadraticCurveTo(u,C,u+5,C),g.closePath(),g.fillStyle="#ffffff",g.fill(),g.strokeStyle="#000000",g.lineWidth=2,g.stroke();const f=new Image;f.src=(y=h.platformConfig)==null?void 0:y.oneToOneLogo,f.onload=()=>{g.drawImage(f,u+2.5,C+2.5,30-5,30-5)}}if(n.value){const d=document.createElement("div");d.textContent=p.name?p.name:"",d.style.textAlign="center",n.value.appendChild(d)}}))};return Ze(()=>{b()}),it(()=>{w.value=""}),(S,O)=>(E(),H("div",cd,[i("div",{class:"ar-qr-code-fixed",onClick:l},[i("img",{src:M(Ro),alt:""},null,8,ld)]),i("div",ud,[i("div",dd,[i("span",null,A(M(a)("ar.qr.code.modal.title")),1)]),i("div",pd,[i("div",{ref_key:"qrCodeContainer",ref:n,class:"ar-qr-code-container"},null,512)])]),i("div",fd,[i("div",md,[i("span",null,A(M(a)("ar.qr.code.modal.desc1")),1)])])]))}});const gd=ue(hd,[["__scopeId","data-v-145f1761"]]);function vd(e,t,n,s=!1){e.addEventListener&&typeof e.addEventListener=="function"&&e.addEventListener(t,n,s)}function _d(e,t,n,s=!1){e.removeEventListener&&typeof e.removeEventListener=="function"&&e.removeEventListener(t,n,s)}const bd=992;function Cd(){return document.body.getBoundingClientRect().width-1<bd}function yd(e){const t=xe();function n(){if(!document.hidden){const a=Cd();t.toggleDevice(a?"mobile":"desktop"),t.toggleMenu(a)}}const s=Ga(n,100);Ze(()=>{e&&s()}),Ra(()=>{vd(window,"resize",s)}),it(()=>{_d(window,"resize",s)})}const Id={width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Td(e,t){return E(),H("svg",Id,t[0]||(t[0]=[i("circle",{cx:"28",cy:"28",r:"28",fill:"#FF7D00"},null,-1),i("path",{d:"M25.607 34a2.432 2.432 0 0 0 4.79 0l1.596-22a4.012 4.012 0 0 0-1.171-2.826A3.996 3.996 0 0 0 28.002 8a4.095 4.095 0 0 0-2.935 1.345A4.112 4.112 0 0 0 24.01 12.4L25.607 34Zm2.395 6a3.986 3.986 0 0 0-3.688 2.47 4.008 4.008 0 0 0 .865 4.358A3.988 3.988 0 0 0 31.993 44a3.786 3.786 0 0 0-1.098-2.9 3.77 3.77 0 0 0-2.893-1.1Z",fill:"#fff"},null,-1)]))}const ho={render:Td};function wd(){const e=N("default");return Ze(()=>{"Notification"in window&&(e.value=Notification.permission)}),{permission:e,requestPermission:async()=>{if(!("Notification"in window)){console.warn("Browser does not support notifications");return}try{const s=await Notification.requestPermission();e.value=s,console.log("\u8BF7\u6C42\u901A\u77E5\u6743\u9650",e.value)}catch(s){console.error("Error requesting permission:",s)}},notify:s=>{if(e.value!=="granted"){console.warn("Notification permission not granted");return}console.log("\u53D1\u9001\u7CFB\u7EDF\u901A\u77E5",s.title,s);const a=new Notification(s.title,s);a.onclick=()=>{window.focus(),console.log("Notification clicked")},console.log("\u53D1\u9001\u7CFB\u7EDF\u901A\u77E5-notification",a)}}}const Ed=re({__name:"page-layout",setup(e){const t=Ut(),n=G(()=>t.getCacheList);return(s,a)=>{const l=Na("router-view");return E(),B(l,null,{default:v(({Component:p,route:h})=>[m(Pa,{name:"fade",mode:"out-in",appear:""},{default:v(()=>[h.meta.ignoreCache?(E(),B(qe(p),{key:h.fullPath})):(E(),B(La,{key:1,include:n.value},[(E(),B(qe(p),{key:h.fullPath}))],1032,["include"]))]),_:2},1024)]),_:1})}}}),Sd={key:0,class:"layout-navbar"},Md={class:"menu-wrapper"},Ad={class:"modal-content"},$d={class:"modal-content-top"},Od={class:"modal-content-desc"},kd={class:"modal-content-desc-b"},Rd={class:"errorMessage xxxx"},Nd={class:"modal-content-bot"},Ld={class:"modal-content"},Pd={class:"modal-content-top"},Ud={class:"modal-content-desc"},Dd={class:"modal-content-desc-b"},xd={class:"errorMessage"},jd={class:"modal-content-bot"},Bd={class:"modal-content-bot-i"},Gd={class:"modal-content-bot-i"},Fd={class:"modal-content"},Vd={class:"modal-content-top"},Hd={class:"modal-content-desc"},Wd={class:"modal-content-desc-b"},qd={class:"modal-content-bot"},zd={class:"modal-content-bot-i"},Jd={class:"modal-content-bot-i"},Kd={key:2,class:"upcoming-modal"};function go(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Io(e)}const Qd="ChatDB",Zd="60px",Yd=re({__name:"default-layout",setup(e){const{requestPermission:t,notify:n}=wd(),s=N(null),{t:a}=Se.exports.useI18n(),{logout:l}=Lo(),{addConversation:p,addMessage:h,getAllConversations:w,clearAll:_}=At(Qd),b=yo(),S=N(!1),O=N(0),g=xe(),y=Qe(),d=bo(),u=Pt(),C=Ye(),f=Co(),D=N(!1),W=N(!1),ne=N(""),$e=N(""),Q=N(!1),be=N(0),fe=N(!1),me=N(!1),Ge=N(),ee=N(!1);let Ce,nt;const he=(o,r)=>{ne.value=o,$e.value=r};let x;const $=N(null);yd(!0);const Oe=G(()=>Pe()),k=G(()=>g.navbar),F=G(()=>g.menu&&!g.topMenu),Fe=G(()=>Oe.value?!1:g.hideMenu),ot=G(()=>g.menuCollapse?48:g.menuWidth),ke=G(()=>g.menuCollapse),dt=G(()=>{const o=F.value&&!Fe.value?{paddingLeft:`${ot.value}px`}:{},r=k.value?{paddingTop:Oe.value?0:Zd}:{};return{...o,...r}}),Re=o=>{!S.value||g.updateSettings({menuCollapse:o})},ge=N(!1),pt=()=>{ge.value=!1};Ua("toggleDrawerMenu",()=>{ge.value=!ge.value});const ye=(o,r,I)=>{n({title:o,body:r,icon:I})},se=N(!1),st=()=>{se.value=!0},ft=()=>{se.value=!1},at=async()=>{var I;console.log("\u5237\u65B0\u4E1A\u52A1\u7CFB\u7EDFtoken-----------");const o=Et(),r=await y.userResetLogin({refresh_token:o});if(r.code!==200&&r.code!==401){V.error(r.msg);return}if(r.code===10909&&!D.value){he(a("error.logout.title1"),a("error.logout.tips2")),D.value=!0;return}Bn(r.data.tokenType),Gn(r.data.token),Fn(r.data.refreshToken),x==null||x.refreshToken({token:r.data.token}),(I=$.value)==null||I.refreshToken({token:r.data.token})},Ve=async()=>{D.value=!1,W.value=!1,await l(),_()},mt=()=>{Q.value=!1,fe.value=!1},ht=()=>{Q.value=!1};let He;const gt=o=>{$.value.sendAssistInviteeTimeoutEvent({meetingNo:o.meetingNo,invitor:o.invitor}),f.updateAnswerInfo(null),f.updateAnswerVisible(!1)},q=o=>{if(f.answerInfo&&f.answerInfo.meetingNo||$.value&&$.value.meetingInfo&&$.value.meetingInfo.meetingNo){console.log("\u63A5\u6536\u5230\u88AB\u9080\u8BF7\u4E1A\u52A1-\u5DF2\u7ECF\u5728\u88AB\u547C\u53EB\u4E2D",o),$.value.sendAssistInviteeBusyEvent({meetingNo:o.meetingNo,invitor:o.invitor});return}const r=b.filterMemberInfoByUserId(o.invitor);f.updateAnswerInfo({...r,meetingNo:o.meetingNo}),f.updateAnswerVisible(!0),He=setTimeout(()=>{gt(o)},1e3*f.answerTimeoutTime),ye(a("notification.title"),a("notification.assist.title"),f.answerInfo.avatarUrl)},ie=()=>{He&&clearTimeout(He)},vt=async o=>{const r=await b.filterMemberInfoByUserId(o.invitee);console.log("\u88AB\u9080\u8BF7\u4EBA\u5FD9\u788C\u4E2D-",r,r==null?void 0:r.name,o),r?V.warning(`${r.name} ${a("meeting.invite.line.msg1")}`):V.warning(`${o.invitee} ${a("meeting.invite.line.msg1")}`)},qt=o=>{console.log("\u88AB\u9080\u8BF7\u4EBA\u8D85\u65F6\u672A\u63A5\u542C-",o);const r=b.filterMemberInfoByUserId(o.invitee);r?V.warning(`${r.name} ${a("meeting.invite.line.msg2")}`):V.warning(`${o.invitee} ${a("meeting.invite.line.msg2")}`)},zt=()=>{V.warning(`${a("meeting.answer.msg1")}`),ie(),f.updateAnswerInfo(null),f.updateAnswerVisible(!1)},Jt=()=>{V.warning(`${a("meeting.answer.msg2")}`),ie(),f.updateAnswerInfo(null),f.updateAnswerVisible(!1)},Kt=o=>{f.answerVisible&&o.meetingNo===f.answerInfo.meetingNo&&(V.warning(a("meeting.message.over")),f.updateAnswerInfo(null),f.updateAnswerVisible(!1))},ns=()=>{me.value=!0},Qt=o=>{me.value=!1,u.notificationId&&Te.remove(u.notificationId),o||localStorage.removeItem("meetingInfo")},os=async()=>{var r;Qt(!0);const o=await $.value.agreeJoinMeeting({meetingNo:f.forceEntryMeetingInfo.meetingNo,invitor:f.forceEntryMeetingInfo.userId,forceEntryStatus:1});if(o.code!==200&&o.code!==401){V.error(o.msg);return}ce.updateRoomTranslateInfo({...ce.roomTranslateInfo,...o.data,open:!!((r=o.data)!=null&&r.enableTranslation)}),$.value.setRoomOnlineListPsn(b.memberList),$.value.setRoomOnlineGroupPsn(b.memberGroupList),f.updateAnswerVisible(!1),f.updateAnswerInfo(null),f.updateForceEntryMeetingInfo(null),f.updateAssistVisible(!0)},Zt=()=>{ie(),ns()},Yt=o=>{f.addUpcomingMeetingList(o),f.updateUpcomingMeetingInfo(o),f.updateUpcomingMeetingVisible(!0)},Xt=async()=>{if(f.answerInfo&&f.answerInfo.meetingNo){V.error(a("meeting.call.message.tips"));return}const o=f.upcomingMeetingInfo,r=b.filterMemberInfoByUserId(o.master);f.updateRoomOptions({meetingName:o==null?void 0:o.subject,meetingNo:o==null?void 0:o.meetingNo,organizer:r==null?void 0:r.name,cloudRecord:(o==null?void 0:o.recordStatus)===1,abstract:(o==null?void 0:o.aiStatus)===1,escaping:o.escaping===1,video:!1,audio:!0,loudspeaker:!0}),ee.value=!0,Ge.value&&Ge.value.handleClose()},_t=()=>{ee.value=!1},ss=async o=>{var I,R,oe,Z;const r=await $.value.joinMeeting({meetingNo:o.meetingNo,forceEntryStatus:0,inviters:[]});if(r.code!==200&&r.code!==401){r.code===Le.OTHER_CLIENT_JOINED_MEETING||r.code===Le.OTHER_CLIENT_IN_MEETING?(f.updateForceEntryMeetingInfo({meetingNo:o.meetingNo,invitor:[]}),ce.updateRoomTranslateInfo({...ce.roomTranslateInfo,...r.data,open:!!((I=r.data)!=null&&I.enableTranslation)}),c.emit("Chat-Other-Client-Joined-Meeting")):V.error(r.msg);return}$.value.roomMenuOptions={video:(R=f.roomOptions)==null?void 0:R.video,audio:(oe=f.roomOptions)==null?void 0:oe.audio,loudspeaker:(Z=f.roomOptions)==null?void 0:Z.loudspeaker},$.value.setRoomOnlineListPsn(b.memberList),$.value.setRoomOnlineGroupPsn(b.memberGroupList),ee.value&&_t(),ee.value&&_t(),f.updateAssistVisible(!0)},en=()=>{c.emit("meeting-list-update")},ce=ra(),tn=o=>{o.reason===8&&(s.value=ho,he(a("error.logout.tips3"),a("error.logout.tips6")),D.value=!0),ce.updateRoomMenuOptionsVideo(!1),j.emit("th-self-menu-camera-close")},as=async()=>{var r,I,R;const o=localStorage.getItem("meetingInfo");if(o){const oe=JSON.parse(o),Z=await $.value.joinMeeting({meetingNo:oe.meetingNo,forceEntryStatus:0,inviters:[]});if(Z.code!==200&&Z.code!==401){Z.code===Le.OTHER_CLIENT_JOINED_MEETING||Z.code===Le.OTHER_CLIENT_IN_MEETING?(f.updateForceEntryMeetingInfo({meetingNo:oe.meetingNo,invitor:[]}),c.emit("Chat-Other-Client-Joined-Meeting")):(Te.remove(u.notificationId),localStorage.removeItem("meetingInfo"),j.emit("th-assist-closed"));return}$.value.roomMenuOptions={video:(r=f.roomOptions)==null?void 0:r.video,audio:(I=f.roomOptions)==null?void 0:I.audio,loudspeaker:(R=f.roomOptions)==null?void 0:R.loudspeaker},$.value.setRoomOnlineListPsn(b.memberList),$.value.setRoomOnlineGroupPsn(b.memberGroupList),$.value.sendAssistMeetingStatusSyncEvent({meetingNo:oe.meetingNo})}},rs=async()=>{var r,I,R,oe,Z,ve,le;const o=localStorage.getItem("meetingInfo");if(o){const Y=JSON.parse(o),ae=await $.value.joinMeeting({meetingNo:Y.meetingNo,forceEntryStatus:0,inviters:[]});if(ae.code!==200&&ae.code!==401){ae.code===Le.OTHER_CLIENT_JOINED_MEETING||ae.code===Le.OTHER_CLIENT_IN_MEETING?(f.updateForceEntryMeetingInfo({meetingNo:Y.meetingNo,invitor:[]}),c.emit("Chat-Other-Client-Joined-Meeting"),ce.updateRoomTranslateInfo({...ce.roomTranslateInfo,...Y,open:!!((r=ae.data)!=null&&r.enableTranslation)})):(V.error(ae.msg),Te.remove(u.notificationId),localStorage.removeItem("meetingInfo"));return}ce.updateRoomTranslateInfo({...ce.roomTranslateInfo,languageType:(I=ae.data)==null?void 0:I.languageType,industryType:(R=ae.data)==null?void 0:R.industryType,...ae.data,open:!!((oe=ae.data)!=null&&oe.enableTranslation)}),$.value.roomMenuOptions={video:(Z=f.roomOptions)==null?void 0:Z.video,audio:(ve=f.roomOptions)==null?void 0:ve.audio,loudspeaker:(le=f.roomOptions)==null?void 0:le.loudspeaker},$.value.setRoomOnlineListPsn(b.memberList),$.value.setRoomOnlineGroupPsn(b.memberGroupList),Te.remove(u.notificationId),f.updateAssistVisible(!0)}},is=()=>{if(f.assistVisible){as();return}u.updateNotificationId(`${Date.now()}`);const o=localStorage.getItem("meetingInfo");if(o){const r=JSON.parse(o);Te.info({id:u.notificationId,title:a("notification.assist.join.hint"),content:`${a("notification.assist.join.title")} ${r.subject}, ${a("notification.assist.join.title1")}`,duration:0,footer:()=>{let I,R;return m(wo,null,{default:()=>[m(Ue,{type:"secondary",size:"small",onClick:()=>{localStorage.removeItem("meetingInfo"),Te.remove(u.notificationId)}},go(I=a("notification.assist.join.label1"))?I:{default:()=>[I]}),m(Ue,{type:"primary",size:"small",onClick:rs},go(R=a("notification.assist.join.label2"))?R:{default:()=>[R]})]})}})}},nn=async()=>{const o=await b.getContactsData();return o.code!==200&&o.code!==401||b.addMemberList(o.data),o},on=async()=>{const o=await b.getContactsGroupData();return o.code!==200&&o.code!==401||b.addGroupMemberList(o.data),o},cs=async o=>{const r=await d.getChatMessageList(o);return r.code!==200&&r.code!==401||(console.log("\u52A0\u8F7D\u6B21\u8981\u6570\u636E--\u6700\u8FD1\u6D88\u606F-res",r),r.data&&r.data.length>0&&r.data.forEach(async I=>{if(I.chatType===K.GROUP_CHAT){const R={...I,parentId:`${I.chatType}_${o.groupId}`};await h(R,!1)}else{const R={...I,parentId:`${I.chatType}_${o.userId}`};await h(R,!1)}})),r},ls=async()=>{const o=await d.getChatConversationList();if(o.code!==200&&o.code!==401)return o;if(console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E--\u4F1A\u8BDD\u5217\u8868-api-res",o),o.data&&o.data.length>0){await o.data.forEach(async I=>{await p({...I,conversationId:`${I.chatType}_${I.targetId}`,status:1}),await cs({userId:I.targetId,pageNo:1,pageSize:I.unreadCount?I.unreadCount:10})});const r=await w();console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E--\u4F1A\u8BDD\u5217\u8868-db-conversationList",r),d.updateConversationList(r)}return o},us=async()=>{const o={groupId:"",userId:""},r=await d.getChatOffLineMessageList(o);return r.code!==200&&r.code!==401||(console.log("\u52A0\u8F7D\u6B21\u8981\u6570\u636E--\u79BB\u7EBF\u6D88\u606F-res",r),r.data&&r.data.length>0&&await r.data.forEach(async I=>{const R={...I,parentId:`${I.chatType}_${I.chatType===K.GROUP_CHAT?I.recipientId:I.senderId}`};await h(R,!0)})),r},sn=()=>{console.log("\u8FDC\u7A0B\u534F\u52A9-Websocket\u8FDE\u63A5\u6253\u5F00:Th-im-open-success"),$.value.login()},an=o=>{console.log("\u8FDC\u7A0B\u534F\u52A9Websocket\u767B\u5F55\u6210\u529F:Th-login-success",o.lastLoginTime),u.updateSocketStatus(3);const r=localStorage.getItem("meetingInfo");r&&(JSON.parse(r).selfUserId===y.userId?is():localStorage.removeItem("meetingInfo"))},rn=o=>{console.log("Socket\u5F02\u5E38\u8FDE\u63A5\u5173\u95ED\u89E6\u53D1-\u91CD\u65B0\u8FDE\u63A5\u4E2D-layout...",o),be.value=o.retryCount,be.value===0&&(Q.value=!0)},cn=o=>{Q.value&&(Q.value=!1),console.log("Socket\u5F02\u5E38\u8FDE\u63A5\u5173\u95ED-\u4E1A\u52A1\u903B\u8F91",o),fe.value=!0,x==null||x.logout()},ds=()=>{fe.value=!1,x.chatWssReconnect()},ps=()=>{j.on("ThAssistImWsOpen",sn),j.on("ThAssistLoginSuccess",an),j.on("ThAssistInvited",q),j.on("ThAssistInviteeBeBusy",vt),j.on("ThAssistInviteeBeTimeout",qt),j.on("ThAssistOtherClientAccepted",zt),j.on("ThAssistOtherClientRejected",Jt),j.on("ThAssistClosed",Kt),j.on("ThAssistAboutToBegin",Yt),j.on("ThAssistPlanStatusUpdated",en),j.on("ThAssistKickOut",tn)},fs=()=>{j.off("ThAssistImWsOpen",sn),j.off("ThAssistLoginSuccess",an),j.off("ThAssistInvited",q),j.off("ThAssistInviteeBeBusy",vt),j.off("ThAssistInviteeBeTimeout",qt),j.off("ThAssistOtherClientAccepted",zt),j.off("ThAssistOtherClientRejected",Jt),j.off("ThAssistClosed",Kt),j.off("ThAssistAboutToBegin",Yt),j.off("ThAssistPlanStatusUpdated",en),j.off("ThAssistKickOut",tn)},{appConfig:ln}=ia(),ms=async()=>{let o="";Pe()?o=`wss://${ln.host}/socket`:o=`wss://${window.location.host}/socket`,$.value=new da({wssUrl:o,userId:y.userId,token:wt()}),f.updateThImEvent($.value),$.value.initWss(),ps()},un=()=>{console.log("\u5373\u65F6\u901A\u8BAF-websocket-\u8FDE\u63A5\u6253\u5F00:handleChatWsOpen"),u.updateSocketStatus(2),x.login()},dn=async o=>{await Ce(),u.updateLastLoginTime(o.lastLoginTime),mt(),ms()},pn=o=>{console.log("\u63A5\u6536\u5230\u767B\u51FA\u6210\u529F\u4E8B\u4EF6-\u4E1A\u52A1\u903B\u8F91",o)},fn=o=>{D.value||(console.log("\u63A5\u6536\u5230\u88AB\u8E22\u4E0B\u7EBF\u4E8B\u4EF6-\u4E1A\u52A1\u903B\u8F91",o,Vn.DUPLICATE_LOGIN),o.reason===Vn.DUPLICATE_LOGIN?(s.value=ho,he(a("error.logout.tips3"),a("error.logout.tips3")),W.value=!0):(he(a("error.logout.title"),a("error.logout.tips5")),W.value=!0),D.value=!0,x==null||x.logout())},mn=()=>{u.updateSocketStatus(1)},hn=async o=>{await p({conversationId:`${o.chatType}_${o.targetId}`,...o,status:1,unreadCount:0});const r=`${o.chatType}_${o.chatType===K.GROUP_CHAT?o.targetId:o.senderId}`;await h({chatType:o.chatType,recipientId:o.targetId,content:o.content,fingerPrint:o.fp,messageType:o.messageType,sendTime:o.sendTime,senderId:_e.SERVER,parentId:r,status:0,name:"",avatarUrl:""},!d.curConversation||!d.curConversation.conversationId||d.curConversation.conversationId!==r);const I=await w();d.updateConversationList(I)},gn=async o=>{console.log("\u7FA4\u7EC4\u4FE1\u606F\u66F4\u65B0\u4E8B\u4EF6",o,d.conversationList);const r=d.conversationList.find(I=>I.conversationId===`${K.GROUP_CHAT}_${o.groupId}`);console.log("\u7FA4\u7EC4\u4FE1\u606F\u66F4\u65B0\u4E8B\u4EF6-conversation",r),d.updateConversations({...r,targetAvatarUrl:o.avatarUrl,targetName:o.groupName}),c.emit("group-info-change")},hs=async o=>{const r=await b.filterMemberInfoByUserId(o.senderId);ye(a("notification.title"),o.content,r==null?void 0:r.avatarUrl)},vn=async o=>{let r;if(o.chatType===K.GROUP_CHAT)console.log("\u63A5\u6536\u804A\u5929\u4FE1\u606F-\u7FA4\u804A",o),r={...o,parentId:`${o.chatType}_${o.recipientId}`};else if(o.chatType===K.PRIVATE_CHAT){console.log("\u63A5\u6536\u804A\u5929\u4FE1\u606F-\u5355\u804A");const R=await b.filterMemberInfoByUserId(o.senderId);r={...o,parentId:`${o.chatType}_${o.senderId}`,sendId:o.senderId,name:R==null?void 0:R.name,avatarUrl:R==null?void 0:R.avatarUrl}}h(r,!d.curConversation||!d.curConversation.conversationId||d.curConversation.conversationId!==r.parentId);const I=await w();d.updateConversationList(I),c.emit("group-info-change"),hs(o)},_n=o=>{b.updateMemberStatus(o,!0)},bn=o=>{b.updateMemberStatus(o,!1)},Cn=()=>{nn(),on()},yn=o=>{console.log("\u7FA4\u6210\u5458\u8E22\u51FA\u4E8B\u4EF6-handleChatGroupMemberRemoved",o),h(o,!d.curConversation||!d.curConversation.conversationId||d.curConversation.conversationId!==o.parentId),c.emit("group-info-change",o)},In=async o=>{console.log("\u7FA4\u6210\u5458\u9080\u8BF7\u4E8B\u4EF6\uFF1AhandleChatGroupMemberInvited",o),await h(o,!d.curConversation||!d.curConversation.conversationId||d.curConversation.conversationId!==o.parentId),c.emit("group-info-change",o)},Tn=o=>{console.log("\u7FA4\u4E3B\u53D8\u66F4\u4E8B\u4EF6\uFF1AhandleChatGroupMasterChanged",o),h(o,!d.curConversation||!d.curConversation.conversationId||d.curConversation.conversationId!==o.parentId),c.emit("group-info-change",o)},wn=o=>{console.log("\u7FA4\u5931\u6548\u4E8B\u4EF6\uFF1AhandleChatGroupDisbanded",o),h(o,!d.curConversation||!d.curConversation.conversationId||d.curConversation.conversationId!==o.parentId),c.emit("group-info-change",o)},En=o=>{h(o,!d.curConversation||!d.curConversation.conversationId||d.curConversation.conversationId!==o.parentId),c.emit("group-info-change",o)},Sn=o=>{x.sendAckMessage(o)},Mn=o=>{console.log("\u53D1\u9001\u804A\u5929\u6D88\u606F",o),x.sendMessage(o)},An=o=>{x.sendChatReceivedMessageReadEvent({targetId:o.targetId,chatType:o.chatType})},$n=()=>{u.updateSocketStatus(1)},bt=()=>{u.notificationId&&Te.remove(u.notificationId)},gs=async()=>{c.on("ChatWsOpen",un),c.on("ChatLoginSuccess",dn),c.on("ChatWsClose",$n),c.on("im-ws-reconnect-start",rn),c.on("im-ws-reconnect-failed",cn),c.on("ChatWsError",mn),c.on("ChatTokenExpirationDate",at),c.on("ChatLogoutSucceed",pn),c.on("ChatKickOut",fn),c.on("GroupCreatedEvent",hn),c.on("GroupChatGroupInfoUpdated",gn),c.on("ChatImSendAckMessage",Sn),c.on("ChatSendMessage",Mn),c.on("ChatConversationRead",An),c.on("ChatMessageReceive",vn),c.on("ChatGroupMemberRemoved",yn),c.on("ChatGroupMemberInvited",In),c.on("ChatGroupMasterChanged",Tn),c.on("ChatGroupDisbanded",wn),c.on("ChatGroupMemberQuit",En),c.on("ChatUserOnline",_n),c.on("ChatUserOffline",bn),c.on("ChatContactUpdated",Cn),c.on("Chat-answer-agree",ie),c.on("Chat-answer-hangup",ie),c.on("Chat-Other-Client-Joined-Meeting",Zt),c.on("Chat-upcoming-meeting-join",Xt),c.on("navbar-show-ar-login-qr-code",st),c.on("meeting-notification-close",bt)},vs=async()=>{c.off("ChatWsOpen",un),c.off("ChatLoginSuccess",dn),c.off("ChatWsClose",$n),c.off("im-ws-reconnect-start",rn),c.off("im-ws-reconnect-failed",cn),c.off("ChatWsError",mn),c.off("ChatTokenExpirationDate",at),c.off("ChatLogoutSucceed",pn),c.off("ChatKickOut",fn),c.off("GroupCreatedEvent",hn),c.off("GroupChatGroupInfoUpdated",gn),c.off("ChatImSendAckMessage",Sn),c.off("ChatSendMessage",Mn),c.off("ChatConversationRead",An),c.off("ChatMessageReceive",vn),c.off("ChatGroupMemberRemoved",yn),c.off("ChatGroupMemberInvited",In),c.off("ChatGroupMasterChanged",Tn),c.off("ChatGroupDisbanded",wn),c.off("ChatGroupMemberQuit",En),c.off("ChatUserOnline",_n),c.off("ChatUserOffline",bn),c.off("ChatContactUpdated",Cn),c.off("Chat-answer-agree",ie),c.off("Chat-answer-hangup",ie),c.off("Chat-Other-Client-Joined-Meeting",Zt),c.off("Chat-upcoming-meeting-join",Xt),c.off("navbar-show-ar-login-qr-code",st),c.off("meeting-notification-close",bt)},_s=async()=>{console.log("\u5373\u65F6\u901A\u8BAF-\u521D\u59CB\u5316\u5EFA-websocket"),u.updateSocketStatus(2);let o="";Pe()?o=`wss://${ln.host}/chat-socket`:o=`wss://${window.location.host}/chat-socket`,x=new rr({wssUrl:o,userId:y.userId,token:wt()}),x.initChatWss(),gs()},bs=()=>{Ce(),nt()};Ce=async()=>{fs(),$.value&&await $.value.logout(),f.updateThImEvent(null)},nt=()=>{vs(),x&&x.logout(),d.updateChatImEvent(null)};const Ct=()=>{window.open("/assist/#/NoPermission","_self")},yt=async()=>{if(u.updateSocketStatus(2),O.value+=1,O.value>3){if(he(a("error.logout.title1"),a("error.logout.tips4")),D.value)return;D.value=!0;return}const[o,r]=await Promise.all([await nn(),await on()]);if(console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E-memberRes&groupListRes",o,r),o.code===403||r.code===403){Ct();return}if(o.code===200&&r.code===200){const I=await ls();console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E-conversationRes",I),I.code===200?(await us(),_s(),O.value=0):yt()}else(o.code!==401||r.code!==401)&&yt()},It=()=>{console.log("handleNetworkStatusChange",navigator.onLine),u.updateNetworkStatus(navigator.onLine),b.updateMemberStatus({client:_e.PC,userId:y.userId},navigator.onLine)},On=()=>{It()},kn=()=>{It()},Cs=()=>{window.addEventListener("online",On),window.addEventListener("offline",kn)},ys=()=>{window.removeEventListener("online",On),window.removeEventListener("offline",kn)},Rn=async()=>{var o;if(console.log(sessionStorage.getItem("refreshTokenStatus")),sessionStorage.getItem("refreshTokenStatus")!=="1"){sessionStorage.setItem("refreshTokenStatus","1");const r=await y.userResetLogin({refresh_token:Et()?Et():""});sessionStorage.setItem("refreshTokenStatus","0"),r.code===200?(Bn(r.data.tokenType),Gn(r.data.token),Fn(r.data.refreshToken),x&&$.value?(x==null||x.refreshToken({token:r.data.token}),(o=$.value)==null||o.refreshToken({token:r.data.token})):window.location.reload()):(vo(),C.push({path:"/login"}))}},Nn=()=>{D.value||(he(a("error.logout.title1"),a("error.logout.tips6")),D.value=!0)},Is=()=>{c.on("sys-user-reset-login",Rn),c.on("sys-application-disabled",Nn),c.on("sys-no-permission-access",Ct)},Ts=()=>{c.off("sys-user-reset-login",Rn),c.off("sys-application-disabled",Nn),c.off("sys-no-permission-access",Ct)};window.addEventListener("storage",o=>{const r=N(wt()),I=ca(),R=la();o.key==="token"&&(I!==R?C.push({name:"login"}):(r.value=o.newValue,window.location.reload())),o.key==="ASSIST_APP"&&I!==R&&C.push({name:"login"})});async function ws(){const o=await f.getLanguageList(),r=await f.getIndustryList();o.code===200&&r.code===200&&(f.updateLanguageList(o.data),f.updateIndustryList(r.data))}return Ze(async()=>{t(),Is(),It(),Cs(),S.value||(console.log("\u9996\u6B21\u52A0\u8F7D\u91CD\u8981\u6570\u636E"),await _(),await yt()),S.value=!0,ws()}),it(()=>{Ts(),bs(),bt(),ys(),O.value=0,S.value=!1,W.value=!1}),ua(),(o,r)=>{const I=Da,R=xa,oe=ja,Z=Ba,ve=Ue,le=Ao;return E(),B(Z,{class:Dt({layout:!0,mobile:M(g).hideMenu,"remote-micro-app-layout":Oe.value})},{default:v(()=>[k.value&&!Oe.value?(E(),H("div",Sd,[m(Ou)])):J("",!0),m(Z,null,{default:v(()=>[m(Z,null,{default:v(()=>[F.value?$o((E(),B(I,{key:0,class:"layout-sider",breakpoint:"xl",collapsed:ke.value,collapsible:!0,width:ot.value,style:Hn({paddingTop:k.value?"60px":""}),"hide-trigger":!0,onCollapse:Re},{default:v(()=>[i("div",Md,[m(Lt)])]),_:1},8,["collapsed","width","style"])),[[Oo,!Fe.value]]):J("",!0),Fe.value?(E(),B(R,{key:1,visible:ge.value,placement:"left",footer:!1,"mask-closable":"",closable:!1,onCancel:pt},{default:v(()=>[m(Lt)]),_:1},8,["visible"])):J("",!0),m(Z,{class:"layout-content",style:Hn(dt.value)},{default:v(()=>[M(g).tabBar?(E(),B(ju,{key:0})):J("",!0),m(oe,null,{default:v(()=>[m(Ed)]),_:1})]),_:1},8,["style"])]),_:1})]),_:1}),m(le,{visible:D.value,"onUpdate:visible":r[0]||(r[0]=Y=>D.value=Y),closable:!1,"esc-to-close":!1,"hide-cancel":!0,"mask-closable":!1,footer:!1},{default:v(()=>[i("div",Ad,[i("div",$d,[(E(),B(qe(M(or))))]),i("div",Od,[i("div",kd,[i("span",null,A(ne.value),1)])]),i("div",Rd,A($e.value),1),i("div",Nd,[m(ve,{type:"primary",onClick:Ve},{default:v(()=>[te(A(o.$t("error.logout.btn.label1")),1)]),_:1})])])]),_:1},8,["visible"]),m(le,{visible:Q.value,"onUpdate:visible":r[1]||(r[1]=Y=>Q.value=Y),"modal-class":"custom-modal",width:"398px",closable:!1,"esc-to-close":!1,"hide-cancel":!0,"mask-closable":!1,footer:!1},{default:v(()=>[i("div",Ld,[i("div",Pd,[(E(),B(qe(M(Za))))]),i("div",Ud,[i("div",Dd,[i("span",null,A(o.$t("error.logout.tip10")),1)])]),i("div",xd,A(o.$t("error.logout.tip9"))+" ("+A(be.value)+"/30)",1),i("div",jd,[i("div",Bd,[m(ve,{type:"outline",onClick:ht},{default:v(()=>[te(A(o.$t("error.logout.btn.label2")),1)]),_:1})]),i("div",Gd,[m(ve,{type:"primary",onClick:Ve},{default:v(()=>[te(A(o.$t("error.logout.btn.label3")),1)]),_:1})])])])]),_:1},8,["visible"]),m(le,{visible:fe.value,"onUpdate:visible":r[2]||(r[2]=Y=>fe.value=Y),"modal-class":"custom-modal",width:"398px",closable:!1,"esc-to-close":!1,"hide-cancel":!0,"mask-closable":!1,footer:!1},{default:v(()=>[i("div",Fd,[i("div",Vd,[(E(),B(qe(M(er))))]),i("div",Hd,[i("div",Wd,[i("span",null,A(o.$t("error.logout.tip11")),1)])]),i("div",qd,[i("div",zd,[m(ve,{type:"outline",onClick:ds},{default:v(()=>[te(A(o.$t("error.logout.btn.label4")),1)]),_:1})]),i("div",Jd,[m(ve,{type:"primary",onClick:Ve},{default:v(()=>[te(A(o.$t("error.logout.btn.label3")),1)]),_:1})])])])]),_:1},8,["visible"]),me.value?(E(),B(le,{key:1,visible:me.value,"onUpdate:visible":r[3]||(r[3]=Y=>me.value=Y),footer:!1,closable:!1,class:"customModal"},{default:v(()=>[me.value?(E(),B(zu,{key:0,onHandleClose:Qt,onHandleJoinMeeting:os})):J("",!0)]),_:1},8,["visible"])):J("",!0),M(f).upcomingMeetingVisible?(E(),H("div",Kd,[M(f).upcomingMeetingVisible?(E(),B(id,{key:0,ref_key:"upcomingModalRef",ref:Ge},null,512)):J("",!0)])):J("",!0),ee.value?(E(),B(le,{key:3,visible:ee.value,"onUpdate:visible":r[4]||(r[4]=Y=>ee.value=Y),footer:!1,closable:!1,class:"customModal"},{default:v(()=>[ee.value?(E(),B(Ja,{key:0,onHandleClose:_t,onHandleJoinMeeting:ss})):J("",!0)]),_:1},8,["visible"])):J("",!0),se.value?(E(),B(le,{key:4,visible:se.value,"onUpdate:visible":r[5]||(r[5]=Y=>se.value=Y),footer:!1,closable:!1,class:"customModal"},{default:v(()=>[se.value?(E(),B(gd,{key:0,onHandleClose:ft})):J("",!0)]),_:1},8,["visible"])):J("",!0)]),_:1},8,["class"])}}});const lp=ue(Yd,[["__scopeId","data-v-5a32a39a"]]);export{lp as default};
