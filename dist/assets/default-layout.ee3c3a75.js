var As=Object.defineProperty;var $s=(e,t,o)=>t in e?As(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var J=(e,t,o)=>($s(e,typeof t!="symbol"?t+"":t,o),o);import{u as Ye,j as yo,E as c,P as ee,k as D,A as Et,L as T,l as ks,T as Os,m as Rs,K as Ns,U as Ls,n as Ps,G as Us,C as Z,M as Le,o as Ds,p as xs,q as ve,r as js,t as Bs,w as Gs,x as Fs,y as Vs,H as Un,z as ye,B as Dn,D as xn,F as jn,I as Bn,J as Gn,N as Hs,O as Ws,Q as je,v as Ee,i as Ue,R as Io,_ as le,d as Dt,S as To,V as qs,e as kt,W as zs,X as Ks,Y as Js,Z as Qs,$ as Zs,a0 as Ys,a1 as Xs,a2 as xt,a3 as ea,a4 as ta,a5 as na,a6 as oa,a7 as sa,a8 as aa,a9 as ra,aa as ia,ab as wo,ac as Eo,f as ca,ad as la,ae as ua,g as St,af as da,ag as fa,ah as pa,ai as Pe,aj as ma,ak as F,al as ct,am as Mt,a as Fn,b as Vn,c as Hn,an as Wn,ao as qn,ap as ha}from"./index.ae3ddf81.js";/* empty css              */import{C as E,D as z,E as i,H as ga,c as H,d as ie,j as N,aI as m,bl as va,bm as So,h as _a,bn as ba,bo as Ca,bp as ya,b as ut,u as M,aN as A,aH as _,aM as ae,aW as W,bi as Ia,bb as Ta,bc as wa,aX as De,i as Ea,w as Mo,aE as V,aF as Q,aK as ze,aJ as Ot,F as jt,Q as Sa,b7 as Ao,b8 as $o,bq as ko,br as Oo,bs as Ma,bt as Aa,bd as Ro,b1 as No,b2 as Lo,a0 as $a,bu as ka,b3 as Oa,a2 as Ra,bv as Na,bw as La,o as Xe,bx as Pa,bg as Ua,by as Ke,bz as Da,bA as xa,p as ja,G as zn,bB as Ie,bC as Ba,aZ as Ga,bD as Fa,bE as Va}from"./arco.22dd370d.js";import{f as et,g as Po,i as Ha}from"./vue.141c3422.js";import{i as tt,b as nt,r as ue,a as ot,f as Wa,S as Kn,c as qa,o as za,d as Ka,e as Uo,g as Ja,h as Jn}from"./icon_volume_1.fd08a673.js";import{l as Qa,j as Za}from"./html2canvas.esm.8907e021.js";import{_ as Ya}from"./logo.667ff1c0.js";import{c as Do}from"./icon_close.f7fee805.js";import"./chart.93614b3d.js";function xo(){const e=et(),t=Ye();return{logout:async s=>{await t.logout();const a=e.currentRoute.value;yo(),e.push({name:s&&typeof s=="string"?s:"login",query:{...e.currentRoute.value.query,redirect:a.name}}),window.location.reload()}}}const Xa={width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function er(e,t){return E(),z("svg",Xa,t[0]||(t[0]=[i("rect",{width:"56",height:"56",rx:"8",fill:"#0267FF"},null,-1),i("path",{d:"m28.065 31.061-2.238 1.965a1.48 1.48 0 0 1-.121 2.102l-5.597 4.91a1.509 1.509 0 0 1-2.117-.136l-3.994-4.478a1.48 1.48 0 0 1 .12-2.102l5.597-4.91a1.51 1.51 0 0 1 2.118.136l2.239-1.964-.999-1.12c-1.103-1.236-2.999-1.36-4.235-.274l-7.835 6.876a2.96 2.96 0 0 0-.242 4.203l5.99 6.717c1.104 1.236 3 1.36 4.236.274l7.835-6.876a2.96 2.96 0 0 0 .242-4.203l-.999-1.12Zm17.719-5.69-3.344-8.368c-.615-1.54-2.355-2.306-3.887-1.71l-9.704 3.774c-1.53.596-2.273 2.327-1.658 3.867l.557 1.395 2.773-1.079a1.478 1.478 0 0 1 .83-1.933l6.93-2.696a1.511 1.511 0 0 1 1.944.855l2.229 5.579a1.477 1.477 0 0 1-.83 1.933l-6.93 2.696a1.511 1.511 0 0 1-1.944-.855l-2.773 1.078.558 1.395c.615 1.54 2.355 2.306 3.886 1.71l9.705-3.774c1.53-.596 2.273-2.327 1.658-3.867ZM21.59 32.75c.552.619 1.5.68 2.118.138l3.398-2.982-2.031-2.21-3.364 2.953a1.48 1.48 0 0 0-.12 2.102Zm11.988-5.856a1.478 1.478 0 0 0 .83-1.933 1.511 1.511 0 0 0-1.944-.856l-4.126 1.605 1.035 2.82 4.205-1.636Zm-5.287-14.252L27.012 12l-1.755 4.747 1.28.642 1.755-4.746Zm-7.508 9.286-.293-1.498-6.337 1.227.291 1.499 6.34-1.228Zm2.015-4.074-2.662-5.037-1.305.814 2.661 5.037 1.306-.814Z",fill:"#fff"},null,-1)]))}const tr={render:er},nr={width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function or(e,t){return E(),z("svg",nr,t[0]||(t[0]=[ga('<rect width="56" height="56" rx="8" fill="#FF3939"></rect><g fill="#fff"><path d="M28 10c9.941 0 18 8.059 18 18s-8.059 18-18 18-18-8.059-18-18 8.059-18 18-18Zm0 2.667c-8.468 0-15.333 6.865-15.333 15.333S19.532 43.333 28 43.333 43.333 36.468 43.333 28 36.468 12.667 28 12.667Z"></path><path d="M36.6 19.276c.629.629.629 1.257 0 1.886L21.162 36.6c-.629.629-1.257.629-1.886 0-.628-.628-.628-1.257 0-1.885l15.439-15.439c.628-.628 1.257-.628 1.885 0Z"></path><path d="M19.276 19.276c.629-.628 1.257-.628 1.886 0L36.6 34.715c.629.628.629 1.257 0 1.885-.628.629-1.257.629-1.885 0L19.276 21.162c-.628-.629-.628-1.257 0-1.886Z"></path></g>',2)]))}const sr={render:or},ar={height:"56",viewBox:"0 0 56 56",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function rr(e,t){return E(),z("svg",ar,t[0]||(t[0]=[i("circle",{cx:"28",cy:"28",r:"28",fill:"#FF1500"},null,-1),i("path",{d:"M25.607 34a2.432 2.432 0 0 0 4.79 0l1.596-22a4.012 4.012 0 0 0-1.171-2.826A3.996 3.996 0 0 0 28.002 8a4.095 4.095 0 0 0-2.935 1.345A4.112 4.112 0 0 0 24.01 12.4L25.607 34Zm2.395 6a3.986 3.986 0 0 0-3.688 2.47 4.008 4.008 0 0 0 .865 4.358A3.988 3.988 0 0 0 31.993 44a3.786 3.786 0 0 0-1.098-2.9 3.77 3.77 0 0 0-2.893-1.1Z",fill:"#fff"},null,-1)]))}const ir={render:rr};class cr{constructor(t){J(this,"websocket",null);J(this,"reconnectTimeout");J(this,"retryCount",0);J(this,"maxRetries",30);J(this,"initialReconnectDelay",3e3);J(this,"maxReconnectDelay",6e4);J(this,"wsUrl");J(this,"isConnected",!1);J(this,"isReConnect",!0);this.wsUrl=t,this.connect()}connect(){this.websocket||(console.log("222222222wsUrl>>>>",this.wsUrl),this.websocket=new WebSocket(this.wsUrl),this.websocket.binaryType="arraybuffer",this.websocket.addEventListener("open",this.onOpen.bind(this)),this.websocket.addEventListener("message",this.onMessage.bind(this)),this.websocket.addEventListener("close",this.onClose.bind(this)),this.websocket.addEventListener("error",this.onError.bind(this)))}onOpen(){console.log("\u5373\u65F6\u901A\u8BAF-WebSocket-websocketService connection open"),this.isConnected=!0,this.retryCount=0,this.clearReconnectTimeout(),c.emit("im-ws-open")}onMessage(t){const o=new Uint8Array(t.data);c.emit("im-ws-message",{data:o,_self:this})}onClose(t){console.log(`IM-Connection closed with code: ${t.code}`),this.isReConnect&&this.reconnect()}onError(t){console.error("IM-WebSocket error",t),c.emit("im-ws-error",{error:t,event:this})}reconnect(){if(!this.isReConnect){console.log("Max retries reached or reconnection is disabled.");return}if(console.log(`IM WebSocket reconnecting in ${this.initialReconnectDelay} ms... \u91CD\u8BD5\u6B21\u6570\uFF1A`,this.retryCount),this.retryCount>this.maxRetries){this.stopReconnect(),c.emit("im-ws-reconnect-failed");return}this.websocket=null,c.emit("im-ws-reconnect-start",{retryCount:this.retryCount}),this.reconnectTimeout=window.setTimeout(()=>{this.retryCount+=1,this.connect()},this.initialReconnectDelay)}stopReconnect(){console.log("IM WebSocket stop reconnect"),this.isReConnect=!1,this.retryCount=0,this.clearReconnectTimeout()}clearReconnectTimeout(){this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0)}sendMessage(t){this.websocket&&this.isConnected?this.websocket.send(t):console.warn("WebSocket is not connected. Message not sent.",t)}close(){console.log("IM WebSocket close"),this.stopReconnect(),this.websocket&&(this.websocket.close(),this.websocket=null)}}const lr=e=>new cr(e);class ur{constructor(t){J(this,"webSocketService",null);J(this,"wssUrl");J(this,"userId");J(this,"token");J(this,"intervalHeart",null);J(this,"lastLoginTime");J(this,"messageMap",new Map);const{wssUrl:o,userId:s,token:a}=t;this.wssUrl=o,this.userId=s,this.token=a,this.handleChatWsOpen=this.handleChatWsOpen.bind(this),this.handleChatWsMessage=this.handleChatWsMessage.bind(this),this.handleChatWsClose=this.handleChatWsClose.bind(this),this.handleChatWsError=this.handleChatWsError.bind(this)}handleChatWsOpen(){c.emit("ChatWsOpen","Chat WebSocket connection opened")}handleChatWsMessage(t){const{data:o}=t;console.log("chat-message--handleChatWsMessage",o);const s=ee.decode(o);if(D.ACK===s.type){const a=Et.decode(s.event),l=this.messageMap.get(a.fp);console.log("ChatPB.EventType.ACK",l),l&&(this.messageMap.delete(a.fp),c.emit("ChatMessageStatus",{fp:a.fp,status:!0}))}if(D.ACK!==s.type&&D.HEARTBEAT_PONG!==s.type&&this.sendAckMessage({fp:s.fp,timestamp:T.fromValue(s.timestamp).toNumber()}),D.LOGIN_SUCCEED===s.type){const a=ks.decode(s.event);this.lastLoginTime=T.fromValue(a.lastLoginTime).toNumber(),console.log("\u5373\u65F6\u901A\u8BAF-websocket-\u767B\u5F55\u6210\u529F-\u670D\u52A1\u7AEF\u8FD4\u56DE\u503C",{...a,lastLoginTime:T.fromValue(a.lastLoginTime).toNumber()}),c.emit("ChatLoginSuccess",{...a,lastLoginTime:T.fromValue(a.lastLoginTime).toNumber()}),this.heartInterval()}if(D.TOKEN_EXPIRATION_DATE===s.type){const a=Os.decode(s.event);console.log("\u63A5\u6536\u5230Token\u4E8B\u4EF6-TOKEN_EXPIRATION_DATE",a),c.emit("ChatTokenExpirationDate",a)}if(D.LOGOUT_SUCCEED===s.type){const a=Rs.decode(s.event);console.log("\u63A5\u6536\u5230\u767B\u51FA\u6210\u529F\u4E8B\u4EF6-LOGOUT_SUCCEED",a),c.emit("ChatLogoutSucceed",a)}if(D.KICK_OUT===s.type){const a=Ns.decode(s.event);console.log("\u8E22\u4E0B\u7EBF\u4E8B\u4EF6-KICK_OUT",a),c.emit("ChatKickOut",a)}if(D.CONTACT_UPDATED===s.type&&(console.log("\u901A\u8BAF\u5F55\u53D1\u751F\u53D8\u5316-CONTACT_UPDATED",s),c.emit("ChatContactUpdated")),D.CHAT_USER_ONLINE===s.type){const a=Ls.decode(s.event);c.emit("ChatUserOnline",{client:a.client,userId:T.fromValue(a.userId).toNumber()})}if(D.CHAT_USER_OFFLINE===s.type){const a=Ps.decode(s.event);console.log("\u7528\u6237\u4E0B\u7EBF-CHAT_USER_OFFLINE",a,{client:a.client,userId:T.fromValue(a.userId).toNumber()}),c.emit("ChatUserOffline",{client:a.client,userId:T.fromValue(a.userId).toNumber()})}if(D.CHAT_GROUP_CREATED===s.type){const a=Us.decode(s.event);console.log("\u7FA4\u7EC4\u521B\u5EFA\u4E8B\u4EF6-CHAT_GROUP_CREATED-dataContent",a);const l=[];a.userIds.forEach(h=>{l.push(T.fromValue(h).toNumber())});const f={eventType:s.type,eventData:{...a,groupId:T.fromValue(a.groupId).toNumber(),masterId:T.fromValue(a.masterId).toNumber(),timestamp:T.fromValue(a.timestamp).toNumber(),userIds:l}};c.emit("GroupCreatedEvent",{fp:s.fp,targetId:T.fromValue(a.groupId).toNumber(),chatType:Z.GROUP_CHAT,targetAvatarUrl:a.avatarUrl,targetName:a.groupName,name:"",messageType:Le.SYSTEM,content:JSON.stringify(f),sendTime:T.fromValue(a.timestamp).toNumber(),unreadCount:0})}if(D.CHAT_GROUP_INFO_UPDATED===s.type){const a=Ds.decode(s.event);console.log("\u7FA4\u7EC4\u4FE1\u606F\u66F4\u65B0\u4E8B\u4EF6-CHAT_GROUP_INFO_UPDATED",a),c.emit("GroupChatGroupInfoUpdated",{...a,groupId:T.fromValue(a.groupId).toNumber()})}if(D.CHAT_GROUP_MEMBER_REMOVED===s.type){const a=xs.decode(s.event);console.log("\u7FA4\u7EC4\u6210\u5458\u8E22\u51FA\u4E8B\u4EF6-CHAT_GROUP_MEMBER_REMOVED-dataContent",a);const l=[];a.removedUserIds.forEach(h=>{l.push(T.fromValue(h).toNumber())});const f={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),masterId:T.fromValue(a.masterId).toNumber(),removedUserIds:l}};c.emit("ChatGroupMemberRemoved",{fingerPrint:s.fp,chatType:Z.GROUP_CHAT,content:JSON.stringify(f),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${Z.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(D.CHAT_GROUP_MEMBER_INVITED===s.type){const a=js.decode(s.event);console.log("\u7FA4\u7EC4\u9080\u8BF7\u6210\u5458\u4E8B\u4EF6-CHAT_GROUP_MEMBER_INVITED",a);const l=[];a.invitedUserIds.forEach(h=>{l.push(T.fromValue(h).toNumber())});const f={eventType:s.type,eventData:{...a,timestamp:T.fromValue(a.timestamp).toNumber,groupId:T.fromValue(a.groupId).toNumber(),groupName:a.groupName,inviteeUserIds:l,invitorUserId:T.fromValue(a.invitorUserId).toNumber()}};c.emit("ChatGroupMemberInvited",{fingerPrint:s.fp,chatType:Z.GROUP_CHAT,content:JSON.stringify(f),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${Z.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(D.CHAT_GROUP_MASTER_CHANGED===s.type){const a=Bs.decode(s.event);console.log("\u7FA4\u4E3B\u53D8\u66F4\u4E8B\u4EF6-CHAT_GROUP_MASTER_CHANGED",a);const l={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),newMasterId:T.fromValue(a.newMasterId).toNumber(),oldMasterId:T.fromValue(a.oldMasterId).toNumber()}};c.emit("ChatGroupMasterChanged",{fingerPrint:s.fp,chatType:Z.GROUP_CHAT,content:JSON.stringify(l),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${Z.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(D.CHAT_GROUP_DISBANDED===s.type){const a=Gs.decode(s.event);console.log("\u7FA4\u89E3\u6563\u4E8B\u4EF6-CHAT_GROUP_DISBANDED",a);const l={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),masterId:T.fromValue(a.masterId).toNumber(),timestamp:T.fromValue(a.timestamp).toNumber()}};c.emit("ChatGroupDisbanded",{fingerPrint:s.fp,chatType:Z.GROUP_CHAT,content:JSON.stringify(l),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${Z.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(D.CHAT_GROUP_MEMBER_QUIT===s.type){const a=Fs.decode(s.event);console.log("\u7FA4\u7EC4\u4EBA\u5458\u9000\u51FA-CHAT_GROUP_MEMBER_QUIT-dataContent",a);const l={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),quitUserId:T.fromValue(a.quitUserId).toNumber(),timestamp:T.fromValue(a.timestamp).toNumber()}};c.emit("ChatGroupMemberQuit",{fingerPrint:s.fp,chatType:Z.GROUP_CHAT,content:JSON.stringify(l),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${Z.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(D.CHAT_MESSAGE_RECEIVED===s.type){const a=Vs.decode(s.event);console.log("\u6D88\u606F\u63A5\u6536\u4E8B\u4EF6-CHAT_MESSAGE_RECEIVED",a),this.sendAckMessage({fp:s.fp,timestamp:T.fromValue(a.timestamp).toNumber()}),c.emit("ChatMessageReceive",{fingerPrint:s.fp,chatType:a.chatType,content:a.content,messageType:a.messageType,recipientId:T.fromValue(a.recipientId).toNumber(),senderId:T.fromValue(a.senderId).toNumber(),sendTime:T.fromValue(a.timestamp).toNumber()})}}handleChatWsError(t){this.clearHeartInterval(),c.emit("ChatWsError",t)}handleChatWsClose(t){console.log("ChatWebSocket \u8FDE\u63A5\u5DF2\u5173\u95ED",t,this),this.clearHeartInterval(),c.emit("ChatWsClose","Chat WebSocket connection closed")}clearHeartInterval(){this.intervalHeart&&clearInterval(this.intervalHeart)}heartInterval(){this.intervalHeart=setInterval(()=>{if(!this.webSocketService){this.clearHeartInterval();return}const t=Date.now(),o=Un.create(),s=Un.encode(o).finish(),a=ee.create({type:D.HEARTBEAT_PING,fp:ye(),event:s,timestamp:t}),l=ee.encode(a).finish();this.webSocketService.sendMessage(l)},1e3*30)}login(){var f;let t;this.lastLoginTime?t=this.lastLoginTime:t=Date.now(),console.log("Chat-login----lastLoginTime",this.lastLoginTime);const o=Dn.create({userId:this.userId,client:ve.PC,token:this.token,lastLoginTime:t}),s=Dn.encode(o).finish(),a=ee.create({type:D.LOGIN_REQUEST,fp:ye(),event:s,timestamp:t}),l=ee.encode(a).finish();(f=this.webSocketService)==null||f.sendMessage(l)}refreshToken(t){console.log("Chat-refresh-token",t);const o=Date.now(),s=xn.create({token:t.token}),a=xn.encode(s).finish(),l=ee.create({type:D.TOKEN_REFRESH,fp:ye(),event:a,timestamp:o}),f=ee.encode(l).finish();this.webSocketService.sendMessage(f)}sendLogoutMessage(){const t=Date.now(),o=jn.create(),s=jn.encode(o).finish(),a=ee.create({type:D.LOGOUT_REQUEST,fp:ye(),event:s,timestamp:t}),l=ee.encode(a).finish();this.webSocketService.sendMessage(l)}logout(){this.webSocketService&&(this.clearHeartInterval(),this.handleOffEventBus(),this.sendLogoutMessage(),this.webSocketService.close())}handleOnEventBus(){c.on("im-ws-open",this.handleChatWsOpen),c.on("im-ws-message",this.handleChatWsMessage),c.on("im-ws-close",this.handleChatWsClose),c.on("im-ws-error",this.handleChatWsError)}handleOffEventBus(){c.off("im-ws-open",this.handleChatWsOpen),c.off("im-ws-message",this.handleChatWsMessage),c.off("im-ws-close",this.handleChatWsClose),c.off("im-ws-error",this.handleChatWsError)}initChatWss(){this.webSocketService=lr(this.wssUrl),this.webSocketService.connect(),this.handleOnEventBus()}chatWssReconnect(){this.webSocketService&&(this.webSocketService.stopReconnect(),this.initChatWss())}sendMessage(t){var g;const{fingerPrint:o,recipientId:s,chatType:a,messageType:l,content:f}=t,h=Date.now(),w=o||ye(),b=Bn.create({recipientId:s,chatType:a,messageType:l,content:f}),C=Bn.encode(b).finish(),S=ee.create({type:D.CHAT_MESSAGE_SEND,fp:w,event:C,timestamp:h}),O=ee.encode(S).finish();this.messageMap.set(w,{timestamp:h,retries:0,data:O}),(g=this.webSocketService)==null||g.sendMessage(O),this.retryMessage(w)}retryMessage(t){!this.messageMap.get(t)||setTimeout(()=>{const s=this.messageMap.get(t);if(!!s){if(s.retries>=3){this.messageMap.delete(t),c.emit("ChatMessageStatus",{fp:t,status:!1});return}console.log(`\u6B63\u5728\u91CD\u8BD5\u6D88\u606F ${t}, \u5C1D\u8BD5\u6B21\u6570 ${s.retries+1}`),this.webSocketService.sendMessage(s.data),this.messageMap.set(t,{...s,retries:s.retries+1}),this.retryMessage(t)}},3e3)}sendAckMessage(t){var h;const o=Date.now(),s=Et.create(t),a=Et.encode(s).finish(),l=ee.create({type:D.ACK,fp:ye(),event:a,timestamp:o}),f=ee.encode(l).finish();(h=this.webSocketService)==null||h.sendMessage(f)}sendChatReceivedMessageReadEvent(t){var h;const o=Date.now(),s=Gn.create(t),a=Gn.encode(s).finish(),l=ee.create({type:D.CHAT_MESSAGE_READ,fp:ye(),event:a,timestamp:o}),f=ee.encode(l).finish();(h=this.webSocketService)==null||h.sendMessage(f)}}function dr(){return{accessRouter(e){var t,o,s,a;return!((t=e.meta)!=null&&t.requiresAuth)||!((o=e.meta)!=null&&o.roles)||((a=(s=e.meta)==null?void 0:s.roles)==null?void 0:a.includes("*"))},findFirstPermissionRoute(e,t="admin"){var s,a;const o=[...e];for(;o.length;){const l=o.shift();if((a=(s=l==null?void 0:l.meta)==null?void 0:s.roles)!=null&&a.find(f=>f.includes("*")||f.includes(t)))return{name:l.name};l!=null&&l.children&&o.push(...l.children)}return null}}}const fr=[...Hs,...Ws],pr=fr.map(e=>{const{name:t,path:o,meta:s,redirect:a,children:l}=e;return{name:t,path:o,meta:s,redirect:a,children:l}}),mr=pr;var hr=Array.isArray;const Bt=hr;var gr="[object AsyncFunction]",vr="[object Function]",_r="[object GeneratorFunction]",br="[object Proxy]";function jo(e){if(!tt(e))return!1;var t=nt(e);return t==vr||t==_r||t==gr||t==br}var Cr=ue["__core-js_shared__"];const At=Cr;var Qn=function(){var e=/[^.]+$/.exec(At&&At.keys&&At.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function yr(e){return!!Qn&&Qn in e}var Ir=Function.prototype,Tr=Ir.toString;function Se(e){if(e!=null){try{return Tr.call(e)}catch{}try{return e+""}catch{}}return""}var wr=/[\\^$.*+?()[\]{}|]/g,Er=/^\[object .+?Constructor\]$/,Sr=Function.prototype,Mr=Object.prototype,Ar=Sr.toString,$r=Mr.hasOwnProperty,kr=RegExp("^"+Ar.call($r).replace(wr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Or(e){if(!tt(e)||yr(e))return!1;var t=jo(e)?kr:Er;return t.test(Se(e))}function Rr(e,t){return e==null?void 0:e[t]}function Me(e,t){var o=Rr(e,t);return Or(o)?o:void 0}var Nr=Me(ue,"WeakMap");const Rt=Nr;var Zn=Object.create,Lr=function(){function e(){}return function(t){if(!tt(t))return{};if(Zn)return Zn(t);e.prototype=t;var o=new e;return e.prototype=void 0,o}}();const Pr=Lr;function Ur(e,t){var o=-1,s=e.length;for(t||(t=Array(s));++o<s;)t[o]=e[o];return t}var Dr=function(){try{var e=Me(Object,"defineProperty");return e({},"",{}),e}catch{}}();const Yn=Dr;function xr(e,t){for(var o=-1,s=e==null?0:e.length;++o<s&&t(e[o],o,e)!==!1;);return e}var jr=9007199254740991,Br=/^(?:0|[1-9]\d*)$/;function Gr(e,t){var o=typeof e;return t=t==null?jr:t,!!t&&(o=="number"||o!="symbol"&&Br.test(e))&&e>-1&&e%1==0&&e<t}function Bo(e,t,o){t=="__proto__"&&Yn?Yn(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}function Go(e,t){return e===t||e!==e&&t!==t}var Fr=Object.prototype,Vr=Fr.hasOwnProperty;function Fo(e,t,o){var s=e[t];(!(Vr.call(e,t)&&Go(s,o))||o===void 0&&!(t in e))&&Bo(e,t,o)}function dt(e,t,o,s){var a=!o;o||(o={});for(var l=-1,f=t.length;++l<f;){var h=t[l],w=s?s(o[h],e[h],h,o,e):void 0;w===void 0&&(w=e[h]),a?Bo(o,h,w):Fo(o,h,w)}return o}var Hr=9007199254740991;function Vo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Hr}function Ho(e){return e!=null&&Vo(e.length)&&!jo(e)}var Wr=Object.prototype;function Gt(e){var t=e&&e.constructor,o=typeof t=="function"&&t.prototype||Wr;return e===o}function qr(e,t){for(var o=-1,s=Array(e);++o<e;)s[o]=t(o);return s}var zr="[object Arguments]";function Xn(e){return ot(e)&&nt(e)==zr}var Wo=Object.prototype,Kr=Wo.hasOwnProperty,Jr=Wo.propertyIsEnumerable,Qr=Xn(function(){return arguments}())?Xn:function(e){return ot(e)&&Kr.call(e,"callee")&&!Jr.call(e,"callee")};const Zr=Qr;function Yr(){return!1}var qo=typeof exports=="object"&&exports&&!exports.nodeType&&exports,eo=qo&&typeof module=="object"&&module&&!module.nodeType&&module,Xr=eo&&eo.exports===qo,to=Xr?ue.Buffer:void 0,ei=to?to.isBuffer:void 0,ti=ei||Yr;const zo=ti;var ni="[object Arguments]",oi="[object Array]",si="[object Boolean]",ai="[object Date]",ri="[object Error]",ii="[object Function]",ci="[object Map]",li="[object Number]",ui="[object Object]",di="[object RegExp]",fi="[object Set]",pi="[object String]",mi="[object WeakMap]",hi="[object ArrayBuffer]",gi="[object DataView]",vi="[object Float32Array]",_i="[object Float64Array]",bi="[object Int8Array]",Ci="[object Int16Array]",yi="[object Int32Array]",Ii="[object Uint8Array]",Ti="[object Uint8ClampedArray]",wi="[object Uint16Array]",Ei="[object Uint32Array]",x={};x[vi]=x[_i]=x[bi]=x[Ci]=x[yi]=x[Ii]=x[Ti]=x[wi]=x[Ei]=!0;x[ni]=x[oi]=x[hi]=x[si]=x[gi]=x[ai]=x[ri]=x[ii]=x[ci]=x[li]=x[ui]=x[di]=x[fi]=x[pi]=x[mi]=!1;function Si(e){return ot(e)&&Vo(e.length)&&!!x[nt(e)]}function Ft(e){return function(t){return e(t)}}var Ko=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Je=Ko&&typeof module=="object"&&module&&!module.nodeType&&module,Mi=Je&&Je.exports===Ko,$t=Mi&&Wa.process,Ai=function(){try{var e=Je&&Je.require&&Je.require("util").types;return e||$t&&$t.binding&&$t.binding("util")}catch{}}();const xe=Ai;var no=xe&&xe.isTypedArray,$i=no?Ft(no):Si;const ki=$i;var Oi=Object.prototype,Ri=Oi.hasOwnProperty;function Jo(e,t){var o=Bt(e),s=!o&&Zr(e),a=!o&&!s&&zo(e),l=!o&&!s&&!a&&ki(e),f=o||s||a||l,h=f?qr(e.length,String):[],w=h.length;for(var b in e)(t||Ri.call(e,b))&&!(f&&(b=="length"||a&&(b=="offset"||b=="parent")||l&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||Gr(b,w)))&&h.push(b);return h}function Qo(e,t){return function(o){return e(t(o))}}var Ni=Qo(Object.keys,Object);const Li=Ni;var Pi=Object.prototype,Ui=Pi.hasOwnProperty;function Di(e){if(!Gt(e))return Li(e);var t=[];for(var o in Object(e))Ui.call(e,o)&&o!="constructor"&&t.push(o);return t}function Vt(e){return Ho(e)?Jo(e):Di(e)}function xi(e){var t=[];if(e!=null)for(var o in Object(e))t.push(o);return t}var ji=Object.prototype,Bi=ji.hasOwnProperty;function Gi(e){if(!tt(e))return xi(e);var t=Gt(e),o=[];for(var s in e)s=="constructor"&&(t||!Bi.call(e,s))||o.push(s);return o}function Ht(e){return Ho(e)?Jo(e,!0):Gi(e)}var Fi=Me(Object,"create");const Qe=Fi;function Vi(){this.__data__=Qe?Qe(null):{},this.size=0}function Hi(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Wi="__lodash_hash_undefined__",qi=Object.prototype,zi=qi.hasOwnProperty;function Ki(e){var t=this.__data__;if(Qe){var o=t[e];return o===Wi?void 0:o}return zi.call(t,e)?t[e]:void 0}var Ji=Object.prototype,Qi=Ji.hasOwnProperty;function Zi(e){var t=this.__data__;return Qe?t[e]!==void 0:Qi.call(t,e)}var Yi="__lodash_hash_undefined__";function Xi(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Qe&&t===void 0?Yi:t,this}function we(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var s=e[t];this.set(s[0],s[1])}}we.prototype.clear=Vi;we.prototype.delete=Hi;we.prototype.get=Ki;we.prototype.has=Zi;we.prototype.set=Xi;function ec(){this.__data__=[],this.size=0}function ft(e,t){for(var o=e.length;o--;)if(Go(e[o][0],t))return o;return-1}var tc=Array.prototype,nc=tc.splice;function oc(e){var t=this.__data__,o=ft(t,e);if(o<0)return!1;var s=t.length-1;return o==s?t.pop():nc.call(t,o,1),--this.size,!0}function sc(e){var t=this.__data__,o=ft(t,e);return o<0?void 0:t[o][1]}function ac(e){return ft(this.__data__,e)>-1}function rc(e,t){var o=this.__data__,s=ft(o,e);return s<0?(++this.size,o.push([e,t])):o[s][1]=t,this}function de(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var s=e[t];this.set(s[0],s[1])}}de.prototype.clear=ec;de.prototype.delete=oc;de.prototype.get=sc;de.prototype.has=ac;de.prototype.set=rc;var ic=Me(ue,"Map");const Ze=ic;function cc(){this.size=0,this.__data__={hash:new we,map:new(Ze||de),string:new we}}function lc(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function pt(e,t){var o=e.__data__;return lc(t)?o[typeof t=="string"?"string":"hash"]:o.map}function uc(e){var t=pt(this,e).delete(e);return this.size-=t?1:0,t}function dc(e){return pt(this,e).get(e)}function fc(e){return pt(this,e).has(e)}function pc(e,t){var o=pt(this,e),s=o.size;return o.set(e,t),this.size+=o.size==s?0:1,this}function Be(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var s=e[t];this.set(s[0],s[1])}}Be.prototype.clear=cc;Be.prototype.delete=uc;Be.prototype.get=dc;Be.prototype.has=fc;Be.prototype.set=pc;function Zo(e,t){for(var o=-1,s=t.length,a=e.length;++o<s;)e[a+o]=t[o];return e}var mc=Qo(Object.getPrototypeOf,Object);const Yo=mc;function hc(){this.__data__=new de,this.size=0}function gc(e){var t=this.__data__,o=t.delete(e);return this.size=t.size,o}function vc(e){return this.__data__.get(e)}function _c(e){return this.__data__.has(e)}var bc=200;function Cc(e,t){var o=this.__data__;if(o instanceof de){var s=o.__data__;if(!Ze||s.length<bc-1)return s.push([e,t]),this.size=++o.size,this;o=this.__data__=new Be(s)}return o.set(e,t),this.size=o.size,this}function Ge(e){var t=this.__data__=new de(e);this.size=t.size}Ge.prototype.clear=hc;Ge.prototype.delete=gc;Ge.prototype.get=vc;Ge.prototype.has=_c;Ge.prototype.set=Cc;function yc(e,t){return e&&dt(t,Vt(t),e)}function Ic(e,t){return e&&dt(t,Ht(t),e)}var Xo=typeof exports=="object"&&exports&&!exports.nodeType&&exports,oo=Xo&&typeof module=="object"&&module&&!module.nodeType&&module,Tc=oo&&oo.exports===Xo,so=Tc?ue.Buffer:void 0,ao=so?so.allocUnsafe:void 0;function wc(e,t){if(t)return e.slice();var o=e.length,s=ao?ao(o):new e.constructor(o);return e.copy(s),s}function Ec(e,t){for(var o=-1,s=e==null?0:e.length,a=0,l=[];++o<s;){var f=e[o];t(f,o,e)&&(l[a++]=f)}return l}function es(){return[]}var Sc=Object.prototype,Mc=Sc.propertyIsEnumerable,ro=Object.getOwnPropertySymbols,Ac=ro?function(e){return e==null?[]:(e=Object(e),Ec(ro(e),function(t){return Mc.call(e,t)}))}:es;const Wt=Ac;function $c(e,t){return dt(e,Wt(e),t)}var kc=Object.getOwnPropertySymbols,Oc=kc?function(e){for(var t=[];e;)Zo(t,Wt(e)),e=Yo(e);return t}:es;const ts=Oc;function Rc(e,t){return dt(e,ts(e),t)}function ns(e,t,o){var s=t(e);return Bt(e)?s:Zo(s,o(e))}function Nc(e){return ns(e,Vt,Wt)}function Lc(e){return ns(e,Ht,ts)}var Pc=Me(ue,"DataView");const Nt=Pc;var Uc=Me(ue,"Promise");const Lt=Uc;var Dc=Me(ue,"Set");const Pt=Dc;var io="[object Map]",xc="[object Object]",co="[object Promise]",lo="[object Set]",uo="[object WeakMap]",fo="[object DataView]",jc=Se(Nt),Bc=Se(Ze),Gc=Se(Lt),Fc=Se(Pt),Vc=Se(Rt),Te=nt;(Nt&&Te(new Nt(new ArrayBuffer(1)))!=fo||Ze&&Te(new Ze)!=io||Lt&&Te(Lt.resolve())!=co||Pt&&Te(new Pt)!=lo||Rt&&Te(new Rt)!=uo)&&(Te=function(e){var t=nt(e),o=t==xc?e.constructor:void 0,s=o?Se(o):"";if(s)switch(s){case jc:return fo;case Bc:return io;case Gc:return co;case Fc:return lo;case Vc:return uo}return t});const qt=Te;var Hc=Object.prototype,Wc=Hc.hasOwnProperty;function qc(e){var t=e.length,o=new e.constructor(t);return t&&typeof e[0]=="string"&&Wc.call(e,"index")&&(o.index=e.index,o.input=e.input),o}var zc=ue.Uint8Array;const po=zc;function zt(e){var t=new e.constructor(e.byteLength);return new po(t).set(new po(e)),t}function Kc(e,t){var o=t?zt(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}var Jc=/\w*$/;function Qc(e){var t=new e.constructor(e.source,Jc.exec(e));return t.lastIndex=e.lastIndex,t}var mo=Kn?Kn.prototype:void 0,ho=mo?mo.valueOf:void 0;function Zc(e){return ho?Object(ho.call(e)):{}}function Yc(e,t){var o=t?zt(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}var Xc="[object Boolean]",el="[object Date]",tl="[object Map]",nl="[object Number]",ol="[object RegExp]",sl="[object Set]",al="[object String]",rl="[object Symbol]",il="[object ArrayBuffer]",cl="[object DataView]",ll="[object Float32Array]",ul="[object Float64Array]",dl="[object Int8Array]",fl="[object Int16Array]",pl="[object Int32Array]",ml="[object Uint8Array]",hl="[object Uint8ClampedArray]",gl="[object Uint16Array]",vl="[object Uint32Array]";function _l(e,t,o){var s=e.constructor;switch(t){case il:return zt(e);case Xc:case el:return new s(+e);case cl:return Kc(e,o);case ll:case ul:case dl:case fl:case pl:case ml:case hl:case gl:case vl:return Yc(e,o);case tl:return new s;case nl:case al:return new s(e);case ol:return Qc(e);case sl:return new s;case rl:return Zc(e)}}function bl(e){return typeof e.constructor=="function"&&!Gt(e)?Pr(Yo(e)):{}}var Cl="[object Map]";function yl(e){return ot(e)&&qt(e)==Cl}var go=xe&&xe.isMap,Il=go?Ft(go):yl;const Tl=Il;var wl="[object Set]";function El(e){return ot(e)&&qt(e)==wl}var vo=xe&&xe.isSet,Sl=vo?Ft(vo):El;const Ml=Sl;var Al=1,$l=2,kl=4,os="[object Arguments]",Ol="[object Array]",Rl="[object Boolean]",Nl="[object Date]",Ll="[object Error]",ss="[object Function]",Pl="[object GeneratorFunction]",Ul="[object Map]",Dl="[object Number]",as="[object Object]",xl="[object RegExp]",jl="[object Set]",Bl="[object String]",Gl="[object Symbol]",Fl="[object WeakMap]",Vl="[object ArrayBuffer]",Hl="[object DataView]",Wl="[object Float32Array]",ql="[object Float64Array]",zl="[object Int8Array]",Kl="[object Int16Array]",Jl="[object Int32Array]",Ql="[object Uint8Array]",Zl="[object Uint8ClampedArray]",Yl="[object Uint16Array]",Xl="[object Uint32Array]",P={};P[os]=P[Ol]=P[Vl]=P[Hl]=P[Rl]=P[Nl]=P[Wl]=P[ql]=P[zl]=P[Kl]=P[Jl]=P[Ul]=P[Dl]=P[as]=P[xl]=P[jl]=P[Bl]=P[Gl]=P[Ql]=P[Zl]=P[Yl]=P[Xl]=!0;P[Ll]=P[ss]=P[Fl]=!1;function lt(e,t,o,s,a,l){var f,h=t&Al,w=t&$l,b=t&kl;if(o&&(f=a?o(e,s,a,l):o(e)),f!==void 0)return f;if(!tt(e))return e;var C=Bt(e);if(C){if(f=qc(e),!h)return Ur(e,f)}else{var S=qt(e),O=S==ss||S==Pl;if(zo(e))return wc(e,h);if(S==as||S==os||O&&!a){if(f=w||O?{}:bl(e),!h)return w?Rc(e,Ic(f,e)):$c(e,yc(f,e))}else{if(!P[S])return a?e:{};f=_l(e,S,h)}}l||(l=new Ge);var g=l.get(e);if(g)return g;l.set(e,f),Ml(e)?e.forEach(function(u){f.add(lt(u,t,o,u,e,l))}):Tl(e)&&e.forEach(function(u,y){f.set(y,lt(u,t,o,y,e,l))});var I=b?w?Lc:Nc:w?Ht:Vt,d=C?void 0:I(e);return xr(d||e,function(u,y){d&&(y=u,u=e[y]),Fo(f,y,lt(u,t,o,y,e,l))}),f}var eu=1,tu=4;function nu(e){return lt(e,eu|tu)}function ou(){const e=dr(),t=je(),o=H(()=>t.menuFromServer?t.appAsyncMenus:mr);return{menuTree:H(()=>{const a=nu(o.value);a.sort((f,h)=>(f.meta.order||0)-(h.meta.order||0));function l(f,h){return f?f.map(b=>{var S,O;if(!e.accessRouter(b))return null;if(((S=b.meta)==null?void 0:S.hideChildrenInMenu)||!b.children)return b.children=[],b;b.children=b.children.filter(g=>{var I;return((I=g.meta)==null?void 0:I.hideInMenu)!==!0});const C=l(b.children,h+1);return C.length||h>1?(b.children=C,b):((O=b.meta)==null?void 0:O.hideInMenu)===!1?b:null}).filter(Boolean):null}return l(a,0)})}}function su(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!So(e)}const au=ie({emit:["collapse"],setup(){const{t:e}=Ee.exports.useI18n(),t=je(),o=et(),s=Po(),{menuTree:a}=ou(),l=H({get(){return Ue()||t.device==="desktop"?t.menuCollapse:!1},set(g){t.updateSettings({menuCollapse:g})}}),f=H(()=>t.topMenu),h=N([]),w=N([]),b=g=>{if(qa.test(g.path)){za(g.path),w.value=[g.name];return}const{hideInMenu:I,activeMenu:d}=g.meta;if(s.name===g.name&&!I&&!d){w.value=[g.name];return}o.push({name:g.name})},C=g=>{const I=[];let d=!1;const u=(y,p)=>{var j;if(y.name===g){d=!0,I.push(...p);return}(j=y.children)!=null&&j.length&&y.children.forEach(K=>{u(K,[...p,K.name])})};return a.value.forEach(y=>{d||u(y,[y.name])}),I};Io(g=>{const{requiresAuth:I,activeMenu:d,hideInMenu:u}=g.meta;if(I&&(!u||d)){const y=C(d||g.name),p=new Set([...y,...h.value]);h.value=[...p],w.value=[d||y[y.length-1]]}},!0);const S=g=>{Ue()&&t.updateSettings({menuCollapse:g}),t.device==="desktop"&&t.updateSettings({menuCollapse:g})},O=()=>{function g(I,d=[]){return I&&I.forEach(u=>{var j,K;const y=(j=u==null?void 0:u.meta)!=null&&j.icon?(K=u==null?void 0:u.meta)==null?void 0:K.icon:"",p=(u==null?void 0:u.children)&&(u==null?void 0:u.children.length)!==0?m(Ca,{key:u==null?void 0:u.name},{default:()=>[g(u==null?void 0:u.children)],icon:()=>m("i",{class:`iconfont ${y}`},null),title:()=>{var se;return _a(ba(e(((se=u==null?void 0:u.meta)==null?void 0:se.locale)||"")))}}):m(ya,{key:u==null?void 0:u.name,onClick:()=>b(u)},{default:()=>{var se;return[e(((se=u==null?void 0:u.meta)==null?void 0:se.locale)||"")]},icon:()=>m("i",{class:`iconfont ${y}`},null)});d.push(p)}),d}return g(a.value)};return()=>{let g;return m(va,{mode:f.value?"horizontal":"vertical",collapsed:l.value,"onUpdate:collapsed":I=>l.value=I,"open-keys":h.value,"onUpdate:open-keys":I=>h.value=I,"show-collapse-button":Ue()?!0:t.device!=="mobile","auto-open":!1,"selected-keys":w.value,"auto-open-selected":!0,"level-indent":34,style:"height: 100%;width:100%;",onCollapse:S},su(g=O())?g:{default:()=>[g]})}}});const Ut=le(au,[["__scopeId","data-v-7bbdf8b6"]]),ru={class:"change-password-container modal-container"},iu=["src"],cu={class:"modal-title"},lu={class:"modal-main wsl-scroll"},uu={class:"modal-bot"},du=ie({__name:"chang",emits:["handleClose","handleConfirmation"],setup(e,{emit:t}){const{t:o}=Ee.exports.useI18n(),s=t,a=Ye(),l=N({password:"",surePassword:""}),f=()=>{l.value={password:"",surePassword:""}},h=()=>{f(),s("handleClose")},w=async()=>{if(!l.value.password){W.warning(o("password.modal.placeholder.new"));return}if(!l.value.surePassword){W.warning(o("password.modal.placeholder.sure"));return}if(l.value.password!==l.value.surePassword){W.warning(o("password.form.btn.inconformity"));return}const b=await a.revampPassword({newPassword:l.value.password});if(b.code!==200&&b.code!==401){W.error(b.msg);return}W.success(o("password.form.btn.success")),h(),s("handleConfirmation")};return ut(()=>{f()}),(b,C)=>{const S=Ia,O=Ta,g=wa,I=De;return E(),z("div",ru,[i("div",{class:"modal-fixed",onClick:h},[i("img",{src:M(Do),alt:""},null,8,iu)]),i("div",cu,A(b.$t("password.modal.title")),1),i("div",lu,[m(g,{model:l.value,layout:"vertical"},{default:_(()=>[m(O,{field:"password",label:b.$t("password.modal.new")},{default:_(()=>[m(S,{modelValue:l.value.password,"onUpdate:modelValue":C[0]||(C[0]=d=>l.value.password=d),placeholder:b.$t("password.modal.placeholder.new"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),m(O,{field:"surePassword",label:b.$t("password.modal.sure")},{default:_(()=>[m(S,{modelValue:l.value.surePassword,"onUpdate:modelValue":C[1]||(C[1]=d=>l.value.surePassword=d),placeholder:b.$t("password.modal.placeholder.sure"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),i("div",uu,[m(I,{class:"modal-btn-item",onClick:h},{default:_(()=>[ae(A(b.$t("password.form.btn.cancel")),1)]),_:1}),m(I,{class:"modal-btn-item",disabled:!l.value.password||!l.value.surePassword,type:"primary",onClick:w},{default:_(()=>[ae(A(b.$t("password.form.btn.sure")),1)]),_:1},8,["disabled"])])])}}});const fu=le(du,[["__scopeId","data-v-a9f3d9bb"]]),pu={width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function mu(e,t){return E(),z("svg",pu,t[0]||(t[0]=[i("g",{"fill-rule":"evenodd","clip-rule":"evenodd",fill:"#4E5969"},[i("path",{d:"M12.834 3.167a4.546 4.546 0 0 0-7.556 4.565.5.5 0 0 1-.124.501l-3.13 3.13a.766.766 0 0 0-.146.27.718.718 0 0 0-.043.301v.004l.2 1.449a.719.719 0 0 0 .207.375c.12.12.255.186.367.202l1.457.2c.066.01.179.003.305-.038a.662.662 0 0 0 .257-.141l.006-.006 3.14-3.133a.5.5 0 0 1 .502-.124A4.55 4.55 0 0 0 12.841 9.6a4.552 4.552 0 0 0-.007-6.432Zm-7.133-.708a5.55 5.55 0 0 1 7.846 7.847v.001a5.55 5.55 0 0 1-5.274 1.453l-2.93 2.924c-.186.19-.432.318-.663.393a1.719 1.719 0 0 1-.758.077l-1.45-.2a1.674 1.674 0 0 1-.938-.487 1.712 1.712 0 0 1-.488-.932l-.001-.007-.2-1.45v-.002c-.037-.259.008-.53.084-.76.077-.23.203-.47.38-.651l.004-.006 2.928-2.927A5.541 5.541 0 0 1 5.7 2.46Z"}),i("path",{d:"M4.24 11.307a.5.5 0 0 1 .707 0l1.534 1.533a.5.5 0 1 1-.707.707L4.24 12.014a.5.5 0 0 1 0-.707ZM9.668 5.834a.5.5 0 1 0 0 1 .5.5 0 0 0 0-1Zm-1.5.5a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"})],-1)]))}const hu={render:mu},gu={class:"navbar"},vu={class:"left-side"},_u={class:"center-side"},bu={class:"right-side"},Cu={class:"quick_access_main"},yu=["onClick"],Iu={class:"quick_access_main_item_main"},Tu=["src"],wu={class:"quick_access_main_item_m_label"},Eu=["src"],Su={class:"user-info"},Mu={class:"user-info-name"},Au={class:"user-info-bot"},$u={class:"user-info-bot-l"},ku={class:"user-info-bot-l"},Ou=["src"],_o="ChatDB",Ru=ie({__name:"index",setup(e){const t=je(),o=Ye(),s=Dt(),a=To(),l=qs(),f=et(),{t:h,locale:w}=Ee.exports.useI18n(),{getAllConversations:b}=kt(_o),{clearAll:C}=kt(_o),{logout:S}=xo(),{changeLocale:O,currentLocale:g}=zs(),I=[...Xs],d=H(()=>o.avatarUrl),u=H(()=>o.name),y=H(()=>s.socketStatus===1?h("socket.status1"):s.socketStatus===2?h("socket.status2"):""),p=H(()=>t.topMenu&&t.menu),j=N(),K=async()=>{await S(),C()},se=()=>{const R=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});j.value.dispatchEvent(R)},Ae=Ea("toggleDrawerMenu"),Y=N(!1),_e=()=>{Y.value=!0},fe=()=>{Y.value=!1},pe=()=>{fe()},Fe=()=>{c.emit("navbar-show-ar-login-qr-code")},ne=N(0),be=N([]),st=async()=>{ne.value=0,be.value=await b(),be.value?be.value.forEach(R=>{ne.value+=R.unreadCount}):ne.value=0},me=R=>JSON.parse(R.entryName)[w.value],B=async R=>{if(console.log("handleInitQuitList",R),R){const G=await l.getQuickList();if(G.code!==200&&G.code!==401){if(G.code===20408)return;W.error(G.msg);return}l.updateQuickEnters(G.data)}},k=async R=>{if(R.isOwnApp===0)window.open(R.entryUri,"_blank");else{const G=await o.getApplicationCode({client_id:R.appId,redirect_uri:R.entryUri,scope:"snsapi_base"});if(G.code!==200&&G.code!==401)return G.code===20408||W.error(G.msg),!1;window.open(`${R.entryUri}?code=${G.data.code}`,"_blank")}return!1},$e=R=>{f.push({path:R})};return Mo(()=>a.conversationList,R=>{R&&st()},{deep:!0,immediate:!0}),(R,G)=>{const Ve=Sa,Ce=Ao,mt=Ks,ke=De,He=$o,Oe=$a,Re=ko,Ne=Oo,he=Js,at=Qs,ht=Ma,rt=Zs,We=Aa,gt=ka,vt=Ys,qe=Ro;return E(),z("div",gu,[i("div",vu,[m(Ce,null,{default:_(()=>[G[2]||(G[2]=i("img",{alt:"logo",src:Ya},null,-1)),!p.value&&M(t).device==="mobile"?(E(),V(Ve,{key:0,style:{"font-size":"22px",cursor:"pointer"},onClick:M(Ae)},null,8,["onClick"])):Q("",!0)]),_:1,__:[2]})]),i("div",_u,[p.value?(E(),V(Ut,{key:0})):Q("",!0)]),i("ul",bu,[i("li",null,[m(He,{content:R.$t("settings.language")},{default:_(()=>[m(ke,{class:"nav-btn",type:"outline",shape:"circle",onClick:se},{icon:_(()=>[m(mt)]),_:1})]),_:1},8,["content"]),m(Ne,{trigger:"click",onSelect:M(O)},{content:_(()=>[(E(),z(ze,null,Ot(I,oe=>m(Re,{key:oe.value,value:oe.value},{icon:_(()=>[No(m(Oe,null,null,512),[[Lo,oe.value===M(g)]])]),default:_(()=>[ae(" "+A(oe.label),1)]),_:2},1032,["value"])),64))]),default:_(()=>[i("div",{ref_key:"triggerBtn",ref:j,class:"trigger-btn"},null,512)]),_:1},8,["onSelect"])]),i("li",null,[m(Ne,{onPopupVisibleChange:B},{content:_(()=>[i("div",Cu,[(E(!0),z(ze,null,Ot(M(l).quickEnters,(oe,it)=>(E(),z("div",{key:`quick_${it}`,class:"quick_access_main_item",onClick:ge=>k(oe)},[i("div",Iu,[i("img",{class:"quick_access_main_item_m_icon",src:oe.iconUrl,alt:""},null,8,Tu),i("div",wu,[i("span",null,A(me(oe)),1)])])],8,yu))),128))])]),default:_(()=>[m(He,{content:R.$t("settings.application")},{default:_(()=>[m(ke,{class:"nav-btn",type:"outline",shape:"circle"},{icon:_(()=>[m(he)]),_:1})]),_:1},8,["content"])]),_:1})]),i("li",null,[m(ht,{count:ne.value,dot:""},{default:_(()=>[m(ke,{class:"nav-btn",type:"outline",shape:"circle",onClick:G[0]||(G[0]=oe=>$e("/Message-List"))},{default:_(()=>[m(at)]),_:1})]),_:1},8,["count"])]),i("li",null,[m(He,{content:R.$t("messageBox.ar.logo.title")},{default:_(()=>[m(ke,{class:"nav-btn",type:"outline",shape:"circle",onClick:Fe},{icon:_(()=>[m(rt)]),_:1})]),_:1},8,["content"])]),i("li",null,[m(We,{size:32,style:{marginRight:"8px",cursor:"pointer"}},{default:_(()=>[i("img",{alt:"avatar",src:d.value},null,8,Eu)]),_:1}),m(Ne,{trigger:"click",position:"br"},{content:_(()=>[m(Re,null,{default:_(()=>[m(Ce,null,{default:_(()=>[i("img",{style:{width:"14px",height:"14px",borderRadius:"50%"},src:d.value,alt:""},null,8,Ou),i("span",null,A(u.value),1)]),_:1})]),_:1}),m(Re,{onClick:_e},{default:_(()=>[m(Ce,null,{default:_(()=>[m(M(hu)),i("span",null,A(R.$t("messageBox.change.password")),1)]),_:1})]),_:1}),m(Re,{onClick:K},{default:_(()=>[m(Ce,null,{default:_(()=>[m(vt),i("span",null,A(R.$t("messageBox.logout")),1)]),_:1})]),_:1})]),default:_(()=>[i("div",Su,[i("div",Mu,[i("span",null,A(u.value),1)]),i("div",Au,[M(s).networkStatus?(E(),z(ze,{key:0},[M(s).socketStatus==3?(E(),z("div",{key:0,class:jt(["user-info-bot-i",M(s).networkStatus?"online":"outline"])},null,2)):Q("",!0),M(s).socketStatus===2?(E(),V(gt,{key:1,size:12})):Q("",!0),i("div",$u,A(M(s).socketStatus===2?y.value:R.$t("meeting.invite.line.status.online")),1)],64)):(E(),z(ze,{key:1},[G[3]||(G[3]=i("div",{class:"user-info-bot-i outline"},null,-1)),i("div",ku,A(R.$t("meeting.invite.line.status.outline")),1)],64))])])]),_:1})])]),Y.value?(E(),V(qe,{key:0,visible:Y.value,"onUpdate:visible":G[1]||(G[1]=oe=>Y.value=oe),footer:!1,closable:!1,class:"customModal"},{default:_(()=>[m(fu,{onHandleClose:fe,onHandleConfirmation:pe})]),_:1},8,["visible"])):Q("",!0)])}}});const Nu=le(Ru,[["__scopeId","data-v-44879333"]]);const Lu={class:"tag-link"},Pu=ie({__name:"tab-item",props:{itemData:{type:Object,default(){return[]}},index:{type:Number,default:0}},setup(e){const t=e,o=et(),s=Po(),a=xt(),l=I=>{o.push({...I})},f=H(()=>a.getTabList),h=H(()=>t.itemData.fullPath!==s.fullPath),w=H(()=>t.index===0),b=H(()=>[0,1].includes(t.index)),C=H(()=>t.index===f.value.length-1),S=(I,d)=>{if(a.deleteTag(d,I),t.itemData.fullPath===s.fullPath){const u=f.value[d-1];o.push({name:u.name})}},O=()=>f.value.findIndex(I=>I.fullPath===s.fullPath),g=async I=>{const{itemData:d,index:u}=t,y=[...f.value];if(I==="current")S(d,u);else if(I==="left"){const p=O();y.splice(1,t.index-1),a.freshTabList(y),p<u&&o.push({name:d.name})}else if(I==="right"){const p=O();y.splice(t.index+1),a.freshTabList(y),p>u&&o.push({name:d.name})}else if(I==="others"){const p=f.value.filter((j,K)=>K===0||K===t.index);a.freshTabList(p),o.push({name:d.name})}else I==="reload"?(a.deleteCache(d),await o.push({name:ea,params:{path:s.fullPath}}),a.addCache(d.name)):(a.resetTabList(),o.push({name:ta}))};return(I,d)=>{const u=Ra,y=na,p=ko,j=oa,K=sa,se=aa,Ae=ra,Y=Oo;return E(),V(Y,{trigger:"contextMenu","popup-max-height":!1,onSelect:g},{content:_(()=>[m(p,{disabled:h.value,value:"reload"},{default:_(()=>[m(y),d[2]||(d[2]=i("span",null,"\u91CD\u65B0\u52A0\u8F7D",-1))]),_:1,__:[2]},8,["disabled","value"]),m(p,{class:"sperate-line",disabled:w.value,value:"current"},{default:_(()=>[m(u),d[3]||(d[3]=i("span",null,"\u5173\u95ED\u5F53\u524D\u6807\u7B7E\u9875",-1))]),_:1,__:[3]},8,["disabled","value"]),m(p,{disabled:b.value,value:"left"},{default:_(()=>[m(j),d[4]||(d[4]=i("span",null,"\u5173\u95ED\u5DE6\u4FA7\u6807\u7B7E\u9875",-1))]),_:1,__:[4]},8,["disabled","value"]),m(p,{class:"sperate-line",disabled:C.value,value:"right"},{default:_(()=>[m(K),d[5]||(d[5]=i("span",null,"\u5173\u95ED\u53F3\u4FA7\u6807\u7B7E\u9875",-1))]),_:1,__:[5]},8,["disabled","value"]),m(p,{value:"others"},{default:_(()=>[m(se),d[6]||(d[6]=i("span",null,"\u5173\u95ED\u5176\u5B83\u6807\u7B7E\u9875",-1))]),_:1,__:[6]},8,["value"]),m(p,{value:"all"},{default:_(()=>[m(Ae),d[7]||(d[7]=i("span",null,"\u5173\u95ED\u5168\u90E8\u6807\u7B7E\u9875",-1))]),_:1,__:[7]},8,["value"])]),default:_(()=>[i("span",{class:jt(["arco-tag arco-tag-size-medium arco-tag-checked",{"link-activated":e.itemData.fullPath===I.$route.fullPath}]),onClick:d[1]||(d[1]=_e=>l(e.itemData))},[i("span",Lu,A(I.$t(e.itemData.title)),1),i("span",{class:"arco-icon-hover arco-tag-icon-hover arco-icon-hover-size-medium arco-tag-close-btn",onClick:d[0]||(d[0]=Oa(_e=>S(e.itemData,e.index),["stop"]))},[m(u)])],2)]),_:1})}}});const Uu=le(Pu,[["__scopeId","data-v-17257cfa"]]),Du={class:"tab-bar-container"},xu={class:"tab-bar-box"},ju={class:"tab-bar-scroll"},Bu={class:"tags-wrap"},Gu=ie({__name:"index",setup(e){const t=je(),o=xt(),s=N(),a=H(()=>o.getTabList),l=H(()=>t.navbar?60:0);return Mo(()=>t.navbar,()=>{s.value.updatePosition()}),Io(f=>{!f.meta.noAffix&&!a.value.some(h=>h.fullPath===f.fullPath)&&o.updateTabList(f)},!0),Na(()=>{ia()}),(f,h)=>{const w=La;return E(),z("div",Du,[m(w,{ref_key:"affixRef",ref:s,"offset-top":l.value},{default:_(()=>[i("div",xu,[i("div",ju,[i("div",Bu,[(E(!0),z(ze,null,Ot(a.value,(b,C)=>(E(),V(Uu,{key:b.fullPath,index:C,"item-data":b},null,8,["index","item-data"]))),128))])]),h[0]||(h[0]=i("div",{class:"tag-bar-operation"},null,-1))])]),_:1},8,["offset-top"])])}}});const Fu=le(Gu,[["__scopeId","data-v-509db106"]]),Vu={class:"room-options-container"},Hu=["src"],Wu={class:"link-m-t borderB"},qu={class:"room-options-main"},zu={class:"link-m-b"},Ku={class:"link-m-b-btn"},Ju=ie({__name:"force_entry",emits:["handleClose","handleJoinMeeting"],setup(e,{emit:t}){const o=t,{t:s}=Ee.exports.useI18n(),a=()=>{o("handleClose")},f=Ka(async()=>{o("handleJoinMeeting")},1e3);return(h,w)=>(E(),z("div",Vu,[i("div",{class:"room-fixed",onClick:a},[i("img",{src:M(Uo),alt:""},null,8,Hu)]),i("div",Wu,[i("span",null,A(M(s)("meeting.modal.title")),1)]),i("div",qu,[i("span",null,A(M(s)("meeting.modal.force.desc")),1)]),i("div",zu,[i("div",Ku,[i("div",{class:"link-m-b-btn-i btn-border",onClick:a},[i("span",null,A(M(s)("meeting.modal.btn.cancel")),1)]),i("div",{class:"link-m-b-btn-i btn-bg",onClick:w[0]||(w[0]=(...b)=>M(f)&&M(f)(...b))},[i("span",null,A(M(s)("meeting.modal.btn.sure")),1)])])])]))}});const Qu=le(Ju,[["__scopeId","data-v-beb61611"]]),Zu={class:"upcoming-container"},Yu={class:"upcoming-container-top"},Xu={class:"upcoming-container-top-l"},ed=["src"],td={class:"upcoming-container-top-l-r"},nd=["src"],od={class:"upcoming-container-main"},sd={class:"upcoming-container-main-top textEllipsis"},ad={class:"upcoming-container-main-bot"},rd={class:"upcoming-container-main-bot-i one"},id={class:"upcoming-container-main-bot-i"},cd={class:"upcoming-container-menu"},ld=ie({__name:"index",setup(e,{expose:t}){const{t:o}=Ee.exports.useI18n(),s=wo(),a=Eo(),l=N(""),f=C=>C?Ja(C,"HH:mm"):"",h=async C=>{if(C){const S=await a.filterMemberInfoByUserId(C);l.value=S.name}},w=()=>{s.removeUpcomingMeetingList(s.upcomingMeetingInfo),s.upcomingMeetingList.length>0?s.updateUpcomingMeetingInfo(s.upcomingMeetingList[0]):(s.updateUpcomingMeetingInfo(null),s.updateUpcomingMeetingVisible(!1))},b=async()=>{c.emit("meeting-notification-close"),c.emit("Chat-upcoming-meeting-join")};return Xe(()=>{h(s.upcomingMeetingInfo.master)}),t({handleClose:w}),(C,S)=>{var I,d,u;const O=$o,g=De;return E(),z("div",Zu,[i("div",Yu,[i("div",Xu,[i("img",{src:M(Qa),alt:""},null,8,ed),i("div",td,[i("span",null,A(M(o)("meeting.modal.upcoming.title")),1)])]),i("div",{class:"upcoming-container-top-r",onClick:w},[i("img",{src:M(Do),alt:""},null,8,nd)])]),i("div",od,[m(O,{content:(I=M(s).upcomingMeetingInfo)==null?void 0:I.subject},{default:_(()=>{var y;return[i("div",sd,A((y=M(s).upcomingMeetingInfo)==null?void 0:y.subject),1)]}),_:1},8,["content"]),i("div",ad,[i("div",rd,[i("span",null,A(M(o)("meeting.modal.upcoming.content2"))+":",1),S[0]||(S[0]=ae(" \xA0 ")),i("span",null,A(l.value),1)]),i("div",id,[i("span",null,A(M(o)("meeting.modal.upcoming.content1"))+":",1),S[1]||(S[1]=ae(" \xA0 ")),i("span",null,A(f((d=M(s).upcomingMeetingInfo)==null?void 0:d.startTime))+" - "+A(f((u=M(s).upcomingMeetingInfo)==null?void 0:u.endTime)),1)])])]),i("div",cd,[m(g,{long:"",class:"modal-btn-item",onClick:w},{default:_(()=>[ae(A(C.$t("meeting.modal.upcoming.btn1")),1)]),_:1}),m(g,{long:"",class:"modal-btn-item",type:"primary",onClick:b},{default:_(()=>[ae(A(C.$t("meeting.modal.upcoming.btn2")),1)]),_:1})])])}}});const ud=le(ld,[["__scopeId","data-v-204ae469"]]),dd={class:"ar-qr-code-modal-container"},fd=["src"],pd={class:"ar-qr-code-main"},md={class:"ar-qr-code-main-top"},hd={class:"ar-qr-code-main-mid-body"},gd={class:"ar-qr-code-main-bot"},vd={class:"ar-qr-code-main-bot-desc"},_d=ie({__name:"index",emits:["handleClose"],setup(e,{emit:t}){const o=N(null),s=t,{t:a}=Ee.exports.useI18n();N(!0);const l=()=>{s("handleClose")},f=Ye(),h=Dt(),w=N(""),b=async()=>{const S=await f.getArLoginQrCode({command:0});if(S.code!==200&&S.code!==401){W.error(S.msg);return}w.value=S.data},C=async()=>{o.value&&(await b(),o.value.innerHTML="",ca.toCanvas(w.value,{errorCorrectionLevel:"H",width:180,margin:2},(S,O)=>{var I;if(S){console.error(S);return}o.value&&o.value.appendChild(O);const g=O.getContext("2d");if(g){const u=(O.width-30)/2,y=(O.height-30)/2;g.beginPath(),g.moveTo(u+5,y),g.lineTo(u+30-5,y),g.quadraticCurveTo(u+30,y,u+30,y+5),g.lineTo(u+30,y+30-5),g.quadraticCurveTo(u+30,y+30,u+30-5,y+30),g.lineTo(u+5,y+30),g.quadraticCurveTo(u,y+30,u,y+30-5),g.lineTo(u,y+5),g.quadraticCurveTo(u,y,u+5,y),g.closePath(),g.fillStyle="#ffffff",g.fill(),g.strokeStyle="#000000",g.lineWidth=2,g.stroke();const p=new Image;p.src=(I=h.platformConfig)==null?void 0:I.oneToOneLogo,p.onload=()=>{g.drawImage(p,u+2.5,y+2.5,30-5,30-5)}}if(o.value){const d=document.createElement("div");d.textContent=f.name?f.name:"",d.style.textAlign="center",o.value.appendChild(d)}}))};return Xe(()=>{C()}),ut(()=>{w.value=""}),(S,O)=>(E(),z("div",dd,[i("div",{class:"ar-qr-code-fixed",onClick:l},[i("img",{src:M(Uo),alt:""},null,8,fd)]),i("div",pd,[i("div",md,[i("span",null,A(M(a)("ar.qr.code.modal.title")),1)]),i("div",hd,[i("div",{ref_key:"qrCodeContainer",ref:o,class:"ar-qr-code-container"},null,512)])]),i("div",gd,[i("div",vd,[i("span",null,A(M(a)("ar.qr.code.modal.desc1")),1)])])]))}});const bd=le(_d,[["__scopeId","data-v-145f1761"]]);function Cd(e,t,o,s=!1){e.addEventListener&&typeof e.addEventListener=="function"&&e.addEventListener(t,o,s)}function yd(e,t,o,s=!1){e.removeEventListener&&typeof e.removeEventListener=="function"&&e.removeEventListener(t,o,s)}const Id=992;function Td(){return document.body.getBoundingClientRect().width-1<Id}function wd(e){const t=je();function o(){if(!document.hidden){const a=Td();t.toggleDevice(a?"mobile":"desktop"),t.toggleMenu(a)}}const s=Ha(o,100);Xe(()=>{e&&s()}),Pa(()=>{Cd(window,"resize",s)}),ut(()=>{yd(window,"resize",s)})}const Ed={width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Sd(e,t){return E(),z("svg",Ed,t[0]||(t[0]=[i("circle",{cx:"28",cy:"28",r:"28",fill:"#FF7D00"},null,-1),i("path",{d:"M25.607 34a2.432 2.432 0 0 0 4.79 0l1.596-22a4.012 4.012 0 0 0-1.171-2.826A3.996 3.996 0 0 0 28.002 8a4.095 4.095 0 0 0-2.935 1.345A4.112 4.112 0 0 0 24.01 12.4L25.607 34Zm2.395 6a3.986 3.986 0 0 0-3.688 2.47 4.008 4.008 0 0 0 .865 4.358A3.988 3.988 0 0 0 31.993 44a3.786 3.786 0 0 0-1.098-2.9 3.77 3.77 0 0 0-2.893-1.1Z",fill:"#fff"},null,-1)]))}const bo={render:Sd};function Md(){const e=N("default");return Xe(()=>{"Notification"in window&&(e.value=Notification.permission)}),{permission:e,requestPermission:async()=>{if(!("Notification"in window)){console.warn("Browser does not support notifications");return}try{const s=await Notification.requestPermission();e.value=s,console.log("\u8BF7\u6C42\u901A\u77E5\u6743\u9650",e.value)}catch(s){console.error("Error requesting permission:",s)}},notify:s=>{if(e.value!=="granted"){console.warn("Notification permission not granted");return}console.log("\u53D1\u9001\u7CFB\u7EDF\u901A\u77E5",s.title,s);const a=new Notification(s.title,s);a.onclick=()=>{window.focus(),console.log("Notification clicked")},console.log("\u53D1\u9001\u7CFB\u7EDF\u901A\u77E5-notification",a)}}}const Ad=ie({__name:"page-layout",setup(e){const t=xt(),o=H(()=>t.getCacheList);return(s,a)=>{const l=Ua("router-view");return E(),V(l,null,{default:_(({Component:f,route:h})=>[m(xa,{name:"fade",mode:"out-in",appear:""},{default:_(()=>[h.meta.ignoreCache?(E(),V(Ke(f),{key:h.fullPath})):(E(),V(Da,{key:1,include:o.value},[(E(),V(Ke(f),{key:h.fullPath}))],1032,["include"]))]),_:2},1024)]),_:1})}}}),$d={key:0,class:"layout-navbar"},kd={class:"menu-wrapper"},Od={class:"modal-content"},Rd={class:"modal-content-top"},Nd={class:"modal-content-desc"},Ld={class:"modal-content-desc-b"},Pd={class:"errorMessage xxxx"},Ud={class:"modal-content-bot"},Dd={class:"modal-content"},xd={class:"modal-content-top"},jd={class:"modal-content-desc"},Bd={class:"modal-content-desc-b"},Gd={class:"errorMessage"},Fd={class:"modal-content-bot"},Vd={class:"modal-content-bot-i"},Hd={class:"modal-content-bot-i"},Wd={class:"modal-content"},qd={class:"modal-content-top"},zd={class:"modal-content-desc"},Kd={class:"modal-content-desc-b"},Jd={class:"modal-content-bot"},Qd={class:"modal-content-bot-i"},Zd={class:"modal-content-bot-i"},Yd={key:2,class:"upcoming-modal"};function Co(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!So(e)}const Xd="ChatDB",ef="60px",tf=ie({__name:"default-layout",setup(e){const{requestPermission:t,notify:o}=Md(),s=N(null),{t:a}=Ee.exports.useI18n(),{logout:l}=xo(),{addConversation:f,addMessage:h,getAllConversations:w,clearAll:b}=kt(Xd),C=Eo(),S=N(!1),O=N(0),g=je(),I=Ye(),d=To(),u=Dt(),y=et(),p=wo(),j=N(!1),K=N(!1),se=N(""),Ae=N(""),Y=N(!1),_e=N(0),fe=N(!1),pe=N(!1),Fe=N(),ne=N(!1);let be,st;const me=(n,r)=>{se.value=n,Ae.value=r};let B;const k=N(null);wd(!0);const $e=H(()=>Ue()),R=H(()=>g.navbar),G=H(()=>g.menu&&!g.topMenu),Ve=H(()=>$e.value?!1:g.hideMenu),Ce=H(()=>g.menuCollapse?48:g.menuWidth),mt=H(()=>g.menuCollapse),ke=H(()=>{const n=G.value&&!Ve.value?{paddingLeft:`${Ce.value}px`}:{},r=R.value?{paddingTop:$e.value?0:ef}:{};return{...n,...r}}),He=n=>{!S.value||g.updateSettings({menuCollapse:n})},Oe=N(!1),Re=()=>{Oe.value=!1};ja("toggleDrawerMenu",()=>{Oe.value=!Oe.value});const Ne=(n,r,v)=>{o({title:n,body:r,icon:v})},he=N(!1),at=()=>{he.value=!0},ht=()=>{he.value=!1},rt=async()=>{var v;console.log("\u5237\u65B0\u4E1A\u52A1\u7CFB\u7EDFtoken-----------");const n=Mt(),r=await I.userResetLogin({refresh_token:n});if(r.code!==200&&r.code!==401){W.error(r.msg);return}if(r.code===10909&&!j.value){me(a("error.logout.title1"),a("error.logout.tips2")),j.value=!0;return}Fn(r.data.tokenType),Vn(r.data.token),Hn(r.data.refreshToken),B==null||B.refreshToken({token:r.data.token}),(v=k.value)==null||v.refreshToken({token:r.data.token})},We=async()=>{j.value=!1,K.value=!1,await l(),b()},gt=()=>{Y.value=!1,fe.value=!1},vt=()=>{Y.value=!1};let qe;const oe=n=>{k.value.sendAssistInviteeTimeoutEvent({meetingNo:n.meetingNo,invitor:n.invitor}),p.updateAnswerInfo(null),p.updateAnswerVisible(!1)},it=n=>{if(p.answerInfo&&p.answerInfo.meetingNo||k.value&&k.value.meetingInfo&&k.value.meetingInfo.meetingNo){console.log("\u63A5\u6536\u5230\u88AB\u9080\u8BF7\u4E1A\u52A1-\u5DF2\u7ECF\u5728\u88AB\u547C\u53EB\u4E2D",n),k.value.sendAssistInviteeBusyEvent({meetingNo:n.meetingNo,invitor:n.invitor});return}const r=C.filterMemberInfoByUserId(n.invitor);p.updateAnswerInfo({...r,meetingNo:n.meetingNo}),p.updateAnswerVisible(!0),qe=setTimeout(()=>{oe(n)},1e3*p.answerTimeoutTime),Ne(a("notification.title"),a("notification.assist.title"),p.answerInfo.avatarUrl)},ge=()=>{qe&&clearTimeout(qe)},Kt=async n=>{const r=await C.filterMemberInfoByUserId(n.invitee);console.log("\u88AB\u9080\u8BF7\u4EBA\u5FD9\u788C\u4E2D-",r,r==null?void 0:r.name,n),r?W.warning(`${r.name} ${a("meeting.invite.line.msg1")}`):W.warning(`${n.invitee} ${a("meeting.invite.line.msg1")}`)},Jt=n=>{console.log("\u88AB\u9080\u8BF7\u4EBA\u8D85\u65F6\u672A\u63A5\u542C-",n);const r=C.filterMemberInfoByUserId(n.invitee);r?W.warning(`${r.name} ${a("meeting.invite.line.msg2")}`):W.warning(`${n.invitee} ${a("meeting.invite.line.msg2")}`)},Qt=()=>{W.warning(`${a("meeting.answer.msg1")}`),ge(),p.updateAnswerInfo(null),p.updateAnswerVisible(!1)},Zt=()=>{W.warning(`${a("meeting.answer.msg2")}`),ge(),p.updateAnswerInfo(null),p.updateAnswerVisible(!1)},Yt=n=>{p.answerVisible&&n.meetingNo===p.answerInfo.meetingNo&&(W.warning(a("meeting.message.over")),p.updateAnswerInfo(null),p.updateAnswerVisible(!1))},rs=()=>{pe.value=!0},Xt=n=>{pe.value=!1,u.notificationId&&Ie.remove(u.notificationId),n||localStorage.removeItem("meetingInfo")},is=async()=>{var r;Xt(!0);const n=await k.value.agreeJoinMeeting({meetingNo:p.forceEntryMeetingInfo.meetingNo,invitor:p.forceEntryMeetingInfo.userId,forceEntryStatus:1});if(n.code!==200&&n.code!==401){W.error(n.msg);return}ce.updateRoomTranslateInfo({...ce.roomTranslateInfo,...n.data,open:!!((r=n.data)!=null&&r.enableTranslation)}),k.value.setRoomOnlineListPsn(C.memberList),k.value.setRoomOnlineGroupPsn(C.memberGroupList),p.updateAnswerVisible(!1),p.updateAnswerInfo(null),p.updateForceEntryMeetingInfo(null),p.updateAssistVisible(!0)},en=()=>{ge(),rs()},tn=n=>{p.addUpcomingMeetingList(n),p.updateUpcomingMeetingInfo(n),p.updateUpcomingMeetingVisible(!0)},nn=async()=>{if(p.answerInfo&&p.answerInfo.meetingNo){W.error(a("meeting.call.message.tips"));return}const n=p.upcomingMeetingInfo,r=C.filterMemberInfoByUserId(n.master);p.updateRoomOptions({meetingName:n==null?void 0:n.subject,meetingNo:n==null?void 0:n.meetingNo,organizer:r==null?void 0:r.name,cloudRecord:(n==null?void 0:n.recordStatus)===1,abstract:(n==null?void 0:n.aiStatus)===1,escaping:n.escaping===1,video:!1,audio:!0,loudspeaker:!0}),ne.value=!0,Fe.value&&Fe.value.handleClose()},_t=()=>{ne.value=!1},bt=async n=>{var v,$,L,q;const r=await k.value.joinMeeting({meetingNo:n.meetingNo,forceEntryStatus:0,inviters:[]});if(r.code!==200&&r.code!==401){r.code===Pe.OTHER_CLIENT_JOINED_MEETING||r.code===Pe.OTHER_CLIENT_IN_MEETING?(p.updateForceEntryMeetingInfo({meetingNo:n.meetingNo,invitor:[]}),ce.updateRoomTranslateInfo({...ce.roomTranslateInfo,...r.data,open:!!((v=r.data)!=null&&v.enableTranslation)}),c.emit("Chat-Other-Client-Joined-Meeting")):W.error(r.msg);return}k.value.roomMenuOptions={video:($=p.roomOptions)==null?void 0:$.video,audio:(L=p.roomOptions)==null?void 0:L.audio,loudspeaker:(q=p.roomOptions)==null?void 0:q.loudspeaker},k.value.setRoomOnlineListPsn(C.memberList),k.value.setRoomOnlineGroupPsn(C.memberGroupList),ne.value&&_t(),ne.value&&_t(),p.updateAssistVisible(!0)},on=()=>{c.emit("meeting-list-update")},Ct=async n=>{if(console.log("\u6536\u5230 invitation-join-meeting \u4E8B\u4EF6\uFF0C\u6570\u636E:",n),n.meetingToken)try{const{joinMeeting:r}=await ma(()=>import("./invitation.113d4353.js"),["assets/invitation.113d4353.js","assets/index.ae3ddf81.js","assets/arco.22dd370d.js","assets/chart.93614b3d.js","assets/vue.141c3422.js","assets/index.96d14c08.css"]),v=await r({meetingToken:n.meetingToken});if(v.data.code===200){const $={meetingNo:v.data.data.meetingNo};await bt($)}else W.error(v.data.msg||"\u52A0\u5165\u4F1A\u8BAE\u5931\u8D25")}catch(r){console.error("\u52A0\u5165\u4F1A\u8BAE\u5931\u8D25:",r),W.error("\u52A0\u5165\u4F1A\u8BAE\u5931\u8D25")}else n.meetingNo&&await bt(n)},ce=la(),sn=n=>{n.reason===8&&(s.value=bo,me(a("error.logout.tips3"),a("error.logout.tips6")),j.value=!0),ce.updateRoomMenuOptionsVideo(!1),F.emit("th-self-menu-camera-close")},cs=async()=>{var r,v,$;const n=localStorage.getItem("meetingInfo");if(n){const L=JSON.parse(n),q=await k.value.joinMeeting({meetingNo:L.meetingNo,forceEntryStatus:0,inviters:[]});if(q.code!==200&&q.code!==401){q.code===Pe.OTHER_CLIENT_JOINED_MEETING||q.code===Pe.OTHER_CLIENT_IN_MEETING?(p.updateForceEntryMeetingInfo({meetingNo:L.meetingNo,invitor:[]}),c.emit("Chat-Other-Client-Joined-Meeting")):(Ie.remove(u.notificationId),localStorage.removeItem("meetingInfo"),F.emit("th-assist-closed"));return}k.value.roomMenuOptions={video:(r=p.roomOptions)==null?void 0:r.video,audio:(v=p.roomOptions)==null?void 0:v.audio,loudspeaker:($=p.roomOptions)==null?void 0:$.loudspeaker},k.value.setRoomOnlineListPsn(C.memberList),k.value.setRoomOnlineGroupPsn(C.memberGroupList),k.value.sendAssistMeetingStatusSyncEvent({meetingNo:L.meetingNo})}},ls=async()=>{var r,v,$,L,q,te,U;const n=localStorage.getItem("meetingInfo");if(n){const X=JSON.parse(n),re=await k.value.joinMeeting({meetingNo:X.meetingNo,forceEntryStatus:0,inviters:[]});if(re.code!==200&&re.code!==401){re.code===Pe.OTHER_CLIENT_JOINED_MEETING||re.code===Pe.OTHER_CLIENT_IN_MEETING?(p.updateForceEntryMeetingInfo({meetingNo:X.meetingNo,invitor:[]}),c.emit("Chat-Other-Client-Joined-Meeting"),ce.updateRoomTranslateInfo({...ce.roomTranslateInfo,...X,open:!!((r=re.data)!=null&&r.enableTranslation)})):(W.error(re.msg),Ie.remove(u.notificationId),localStorage.removeItem("meetingInfo"));return}ce.updateRoomTranslateInfo({...ce.roomTranslateInfo,languageType:(v=re.data)==null?void 0:v.languageType,industryType:($=re.data)==null?void 0:$.industryType,...re.data,open:!!((L=re.data)!=null&&L.enableTranslation)}),k.value.roomMenuOptions={video:(q=p.roomOptions)==null?void 0:q.video,audio:(te=p.roomOptions)==null?void 0:te.audio,loudspeaker:(U=p.roomOptions)==null?void 0:U.loudspeaker},k.value.setRoomOnlineListPsn(C.memberList),k.value.setRoomOnlineGroupPsn(C.memberGroupList),Ie.remove(u.notificationId),p.updateAssistVisible(!0)}},us=()=>{if(p.assistVisible){cs();return}u.updateNotificationId(`${Date.now()}`);const n=localStorage.getItem("meetingInfo");if(n){const r=JSON.parse(n);Ie.info({id:u.notificationId,title:a("notification.assist.join.hint"),content:`${a("notification.assist.join.title")} ${r.subject}, ${a("notification.assist.join.title1")}`,duration:0,footer:()=>{let v,$;return m(Ao,null,{default:()=>[m(De,{type:"secondary",size:"small",onClick:()=>{localStorage.removeItem("meetingInfo"),Ie.remove(u.notificationId)}},Co(v=a("notification.assist.join.label1"))?v:{default:()=>[v]}),m(De,{type:"primary",size:"small",onClick:ls},Co($=a("notification.assist.join.label2"))?$:{default:()=>[$]})]})}})}},an=async()=>{const n=await C.getContactsData();return n.code!==200&&n.code!==401||C.addMemberList(n.data),n},rn=async()=>{const n=await C.getContactsGroupData();return n.code!==200&&n.code!==401||C.addGroupMemberList(n.data),n},ds=async n=>{const r=await d.getChatMessageList(n);return r.code!==200&&r.code!==401||(console.log("\u52A0\u8F7D\u6B21\u8981\u6570\u636E--\u6700\u8FD1\u6D88\u606F-res",r),r.data&&r.data.length>0&&r.data.forEach(async(v,$)=>{if(v.messageType===5){v.content="";return}if(v.chatType===Z.GROUP_CHAT){const L={...v,parentId:`${v.chatType}_${n.groupId}`};await h(L,!1)}else{const L={...v,parentId:`${v.chatType}_${n.userId}`};await h(L,!1)}}),console.log("\u52A0\u8F7D\u6B21\u8981\u6570\u636E--\u6700\u8FD1\u6D88\u606F-res-after",r)),r},fs=async()=>{const n=await d.getChatConversationList();if(n.code!==200&&n.code!==401)return n;if(console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E--\u4F1A\u8BDD\u5217\u8868-api-res",n),n.data&&n.data.length>0){await n.data.forEach(async v=>{await f({...v,conversationId:`${v.chatType}_${v.targetId}`,status:1}),console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E--\u4F1A\u8BDD\u5217\u8868-conversation",v),await ds({...v.chatType===0&&{userId:v.targetId},...v.chatType===1&&{groupId:v.targetId},pageNo:1,pageSize:v.unreadCount?v.unreadCount:10})});const r=await w();console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E--\u4F1A\u8BDD\u5217\u8868-db-conversationList",r),d.updateConversationList(r)}return n},ps=async()=>{const n={groupId:"",userId:""},r=await d.getChatOffLineMessageList(n);return r.code!==200&&r.code!==401||(console.log("\u52A0\u8F7D\u6B21\u8981\u6570\u636E--\u79BB\u7EBF\u6D88\u606F-res",r),r.data&&r.data.length>0&&await r.data.forEach(async v=>{const $={...v,parentId:`${v.chatType}_${v.chatType===Z.GROUP_CHAT?v.recipientId:v.senderId}`};await h($,!0)})),r},cn=()=>{console.log("\u8FDC\u7A0B\u534F\u52A9-Websocket\u8FDE\u63A5\u6253\u5F00:Th-im-open-success"),k.value.login()},ln=n=>{console.log("\u8FDC\u7A0B\u534F\u52A9Websocket\u767B\u5F55\u6210\u529F:Th-login-success",n.lastLoginTime),u.updateSocketStatus(3);const r=localStorage.getItem("meetingInfo");r&&(JSON.parse(r).selfUserId===I.userId?us():localStorage.removeItem("meetingInfo"))},un=n=>{console.log("Socket\u5F02\u5E38\u8FDE\u63A5\u5173\u95ED\u89E6\u53D1-\u91CD\u65B0\u8FDE\u63A5\u4E2D-layout...",n),_e.value=n.retryCount,_e.value===0&&(Y.value=!0)},dn=n=>{Y.value&&(Y.value=!1),console.log("Socket\u5F02\u5E38\u8FDE\u63A5\u5173\u95ED-\u4E1A\u52A1\u903B\u8F91",n),fe.value=!0,B==null||B.logout()},ms=()=>{fe.value=!1,B.chatWssReconnect()},hs=()=>{F.on("ThAssistImWsOpen",cn),F.on("ThAssistLoginSuccess",ln),F.on("ThAssistInvited",it),F.on("ThAssistInviteeBeBusy",Kt),F.on("ThAssistInviteeBeTimeout",Jt),F.on("ThAssistOtherClientAccepted",Qt),F.on("ThAssistOtherClientRejected",Zt),F.on("ThAssistClosed",Yt),F.on("ThAssistAboutToBegin",tn),F.on("ThAssistPlanStatusUpdated",on),F.on("ThAssistKickOut",sn)},gs=()=>{F.off("ThAssistImWsOpen",cn),F.off("ThAssistLoginSuccess",ln),F.off("ThAssistInvited",it),F.off("ThAssistInviteeBeBusy",Kt),F.off("ThAssistInviteeBeTimeout",Jt),F.off("ThAssistOtherClientAccepted",Qt),F.off("ThAssistOtherClientRejected",Zt),F.off("ThAssistClosed",Yt),F.off("ThAssistAboutToBegin",tn),F.off("ThAssistPlanStatusUpdated",on),F.off("ThAssistKickOut",sn)};ua();const vs=async()=>{let n="";Ue()?n=`wss://${ct()}/socket`:n=`wss://${ct()}/socket`,k.value=new ha({wssUrl:n,userId:I.userId,token:St()}),p.updateThImEvent(k.value),k.value.initWss(),hs()},fn=()=>{console.log("\u5373\u65F6\u901A\u8BAF-websocket-\u8FDE\u63A5\u6253\u5F00:handleChatWsOpen"),u.updateSocketStatus(2),B.login()},pn=async n=>{await be(),u.updateLastLoginTime(n.lastLoginTime),gt(),vs()},mn=n=>{console.log("\u63A5\u6536\u5230\u767B\u51FA\u6210\u529F\u4E8B\u4EF6-\u4E1A\u52A1\u903B\u8F91",n)},hn=n=>{j.value||(console.log("\u63A5\u6536\u5230\u88AB\u8E22\u4E0B\u7EBF\u4E8B\u4EF6-\u4E1A\u52A1\u903B\u8F91",n,Wn.DUPLICATE_LOGIN),n.reason===Wn.DUPLICATE_LOGIN?(s.value=bo,me(a("error.logout.tips3"),a("error.logout.tips3")),K.value=!0):(me(a("error.logout.title"),a("error.logout.tips5")),K.value=!0),j.value=!0,B==null||B.logout())},gn=()=>{u.updateSocketStatus(1)},vn=async n=>{var q,te;const r={conversationId:`${n.chatType}_${n.targetId}`,...n,status:1,unreadCount:0},{targetAvatarUrl:v}=n;if(v&&Jn(v))try{const U=await qn({objectKeys:[v]});(te=(q=U==null?void 0:U.data)==null?void 0:q[v])!=null&&te.previewUrl&&(r.targetAvatarUrl=U.data[v].previewUrl)}catch(U){console.error("\u8F6C\u6362\u5B58\u50A8\u6876key\u4E3A\u9884\u89C8URL\u5931\u8D25:",U)}await f(r);const $=`${n.chatType}_${n.chatType===Z.GROUP_CHAT?n.targetId:n.senderId}`;await h({chatType:n.chatType,recipientId:n.targetId,content:n.content,fingerPrint:n.fp,messageType:n.messageType,sendTime:n.sendTime,senderId:ve.SERVER,parentId:$,status:0,name:"",avatarUrl:""},!d.curConversation||!d.curConversation.conversationId||d.curConversation.conversationId!==$);const L=await w();d.updateConversationList(L)},_n=async n=>{var q,te;console.log("\u7FA4\u7EC4\u4FE1\u606F\u66F4\u65B0\u4E8B\u4EF6",n,d.conversationList);const r=d.conversationList.find(U=>U.conversationId===`${Z.GROUP_CHAT}_${n.groupId}`);console.log("\u7FA4\u7EC4\u4FE1\u606F\u66F4\u65B0\u4E8B\u4EF6-conversation",r);const{avatarUrl:v,groupName:$}=n;let L=v;if(L&&Jn(L))try{const U=await qn({objectKeys:[L]});(te=(q=U==null?void 0:U.data)==null?void 0:q[L])!=null&&te.previewUrl&&(L=U.data[L].previewUrl)}catch(U){console.error("\u8F6C\u6362\u5B58\u50A8\u6876key\u4E3A\u9884\u89C8URL\u5931\u8D25:",U)}d.updateConversations({...r,targetAvatarUrl:L,targetName:$}),c.emit("group-info-change")},_s=async n=>{const r=await C.filterMemberInfoByUserId(n.senderId);Ne(a("notification.title"),n.content,r==null?void 0:r.avatarUrl)},bn=async n=>{let r;if(n.chatType===Z.GROUP_CHAT)console.log("\u63A5\u6536\u804A\u5929\u4FE1\u606F-\u7FA4\u804A",n),r={...n,parentId:`${n.chatType}_${n.recipientId}`};else if(n.chatType===Z.PRIVATE_CHAT){console.log("\u63A5\u6536\u804A\u5929\u4FE1\u606F-\u5355\u804A");const $=await C.filterMemberInfoByUserId(n.senderId);r={...n,parentId:`${n.chatType}_${n.senderId}`,sendId:n.senderId,name:$==null?void 0:$.name,avatarUrl:$==null?void 0:$.avatarUrl}}h(r,!d.curConversation||!d.curConversation.conversationId||d.curConversation.conversationId!==r.parentId);const v=await w();d.updateConversationList(v),c.emit("group-info-change"),_s(n)},Cn=n=>{C.updateMemberStatus(n,!0)},yn=n=>{C.updateMemberStatus(n,!1)},In=()=>{an(),rn()},Tn=n=>{console.log("\u7FA4\u6210\u5458\u8E22\u51FA\u4E8B\u4EF6-handleChatGroupMemberRemoved",n),h(n,!d.curConversation||!d.curConversation.conversationId||d.curConversation.conversationId!==n.parentId),c.emit("group-info-change",n)},wn=async n=>{console.log("\u7FA4\u6210\u5458\u9080\u8BF7\u4E8B\u4EF6\uFF1AhandleChatGroupMemberInvited",n),await h(n,!d.curConversation||!d.curConversation.conversationId||d.curConversation.conversationId!==n.parentId),c.emit("group-info-change",n)},En=n=>{console.log("\u7FA4\u4E3B\u53D8\u66F4\u4E8B\u4EF6\uFF1AhandleChatGroupMasterChanged",n),h(n,!d.curConversation||!d.curConversation.conversationId||d.curConversation.conversationId!==n.parentId),c.emit("group-info-change",n)},Sn=n=>{console.log("\u7FA4\u5931\u6548\u4E8B\u4EF6\uFF1AhandleChatGroupDisbanded",n),h(n,!d.curConversation||!d.curConversation.conversationId||d.curConversation.conversationId!==n.parentId),c.emit("group-info-change",n)},Mn=n=>{h(n,!d.curConversation||!d.curConversation.conversationId||d.curConversation.conversationId!==n.parentId),c.emit("group-info-change",n)},An=n=>{B.sendAckMessage(n)},$n=n=>{console.log("\u53D1\u9001\u804A\u5929\u6D88\u606F",n),B.sendMessage(n)},kn=n=>{B.sendChatReceivedMessageReadEvent({targetId:n.targetId,chatType:n.chatType})},On=()=>{u.updateSocketStatus(1)},yt=()=>{u.notificationId&&Ie.remove(u.notificationId)},bs=async()=>{c.on("ChatWsOpen",fn),c.on("ChatLoginSuccess",pn),c.on("ChatWsClose",On),c.on("im-ws-reconnect-start",un),c.on("im-ws-reconnect-failed",dn),c.on("ChatWsError",gn),c.on("ChatTokenExpirationDate",rt),c.on("ChatLogoutSucceed",mn),c.on("ChatKickOut",hn),c.on("GroupCreatedEvent",vn),c.on("GroupChatGroupInfoUpdated",_n),c.on("ChatImSendAckMessage",An),c.on("ChatSendMessage",$n),c.on("ChatConversationRead",kn),c.on("ChatMessageReceive",bn),c.on("ChatGroupMemberRemoved",Tn),c.on("ChatGroupMemberInvited",wn),c.on("ChatGroupMasterChanged",En),c.on("ChatGroupDisbanded",Sn),c.on("ChatGroupMemberQuit",Mn),c.on("ChatUserOnline",Cn),c.on("ChatUserOffline",yn),c.on("ChatContactUpdated",In),c.on("Chat-answer-agree",ge),c.on("Chat-answer-hangup",ge),c.on("Chat-Other-Client-Joined-Meeting",en),c.on("Chat-upcoming-meeting-join",nn),c.on("navbar-show-ar-login-qr-code",at),c.on("meeting-notification-close",yt)},Cs=async()=>{c.off("ChatWsOpen",fn),c.off("ChatLoginSuccess",pn),c.off("ChatWsClose",On),c.off("im-ws-reconnect-start",un),c.off("im-ws-reconnect-failed",dn),c.off("ChatWsError",gn),c.off("ChatTokenExpirationDate",rt),c.off("ChatLogoutSucceed",mn),c.off("ChatKickOut",hn),c.off("GroupCreatedEvent",vn),c.off("GroupChatGroupInfoUpdated",_n),c.off("ChatImSendAckMessage",An),c.off("ChatSendMessage",$n),c.off("ChatConversationRead",kn),c.off("ChatMessageReceive",bn),c.off("ChatGroupMemberRemoved",Tn),c.off("ChatGroupMemberInvited",wn),c.off("ChatGroupMasterChanged",En),c.off("ChatGroupDisbanded",Sn),c.off("ChatGroupMemberQuit",Mn),c.off("ChatUserOnline",Cn),c.off("ChatUserOffline",yn),c.off("ChatContactUpdated",In),c.off("Chat-answer-agree",ge),c.off("Chat-answer-hangup",ge),c.off("Chat-Other-Client-Joined-Meeting",en),c.off("Chat-upcoming-meeting-join",nn),c.off("navbar-show-ar-login-qr-code",at),c.off("meeting-notification-close",yt),c.off("invitation-join-meeting",Ct)},ys=async()=>{console.log("\u5373\u65F6\u901A\u8BAF-\u521D\u59CB\u5316\u5EFA-websocket"),u.updateSocketStatus(2);let n="";Ue()?n=`wss://${ct()}/chat-socket`:n=`wss://${ct()}/chat-socket`,B=new ur({wssUrl:n,userId:I.userId,token:St()}),B.initChatWss(),bs()},Is=()=>{be(),st()};be=async()=>{gs(),k.value&&await k.value.logout(),p.updateThImEvent(null)},st=()=>{Cs(),B&&B.logout(),d.updateChatImEvent(null)};const It=()=>{window.open("/assist/#/NoPermission","_self")},Tt=async()=>{if(u.updateSocketStatus(2),O.value+=1,O.value>3){if(me(a("error.logout.title1"),a("error.logout.tips4")),j.value)return;j.value=!0;return}const[n,r]=await Promise.all([await an(),await rn()]);if(console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E-memberRes&groupListRes",n,r),n.code===403||r.code===403){It();return}if(n.code===200&&r.code===200){const v=await fs();console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E-conversationRes",v),v.code===200?(await ps(),ys(),O.value=0):Tt()}else(n.code!==401||r.code!==401)&&Tt()},wt=()=>{console.log("handleNetworkStatusChange",navigator.onLine),u.updateNetworkStatus(navigator.onLine),C.updateMemberStatus({client:ve.PC,userId:I.userId},navigator.onLine)},Rn=()=>{wt()},Nn=()=>{wt()},Ts=()=>{window.addEventListener("online",Rn),window.addEventListener("offline",Nn)},ws=()=>{window.removeEventListener("online",Rn),window.removeEventListener("offline",Nn)},Ln=async()=>{var n;if(console.log(sessionStorage.getItem("refreshTokenStatus")),sessionStorage.getItem("refreshTokenStatus")!=="1"){sessionStorage.setItem("refreshTokenStatus","1");const r=await I.userResetLogin({refresh_token:Mt()?Mt():""});sessionStorage.setItem("refreshTokenStatus","0"),r.code===200?(Fn(r.data.tokenType),Vn(r.data.token),Hn(r.data.refreshToken),B&&k.value?(B==null||B.refreshToken({token:r.data.token}),(n=k.value)==null||n.refreshToken({token:r.data.token})):window.location.reload()):(yo(),y.push({path:"/login"}))}},Pn=()=>{j.value||(me(a("error.logout.title1"),a("error.logout.tips6")),j.value=!0)},Es=()=>{c.on("sys-user-reset-login",Ln),c.on("sys-application-disabled",Pn),c.on("sys-no-permission-access",It)},Ss=()=>{c.off("sys-user-reset-login",Ln),c.off("sys-application-disabled",Pn),c.off("sys-no-permission-access",It)};window.addEventListener("storage",n=>{if(window.location.hash.includes("#/invitation"))return;const v=N(St()),$=da(),L=fa();n.key==="token"&&($!==L?y.push({name:"login"}):(v.value=n.newValue,window.location.reload())),n.key==="ASSIST_APP"&&$!==L&&y.push({name:"login"})});async function Ms(){const n=await p.getLanguageList(),r=await p.getIndustryList();n.code===200&&r.code===200&&(p.updateLanguageList(n.data),p.updateIndustryList(r.data))}return Xe(async()=>{t(),Es(),wt(),Ts(),c.on("invitation-join-meeting",Ct),console.log("\u5DF2\u6CE8\u518C invitation-join-meeting \u4E8B\u4EF6\u76D1\u542C\u5668"),S.value||(console.log("\u9996\u6B21\u52A0\u8F7D\u91CD\u8981\u6570\u636E"),await b(),await Tt()),S.value=!0,Ms()}),ut(()=>{Ss(),Is(),yt(),ws(),c.off("invitation-join-meeting",Ct),O.value=0,S.value=!1,K.value=!1}),pa(),(n,r)=>{const v=Ba,$=Ga,L=Fa,q=Va,te=De,U=Ro;return E(),V(q,{class:jt({layout:!0,mobile:M(g).hideMenu,"remote-micro-app-layout":$e.value})},{default:_(()=>[R.value&&!$e.value?(E(),z("div",$d,[m(Nu)])):Q("",!0),m(q,null,{default:_(()=>[m(q,null,{default:_(()=>[G.value?No((E(),V(v,{key:0,class:"layout-sider",breakpoint:"xl",collapsed:mt.value,collapsible:!0,width:Ce.value,style:zn({paddingTop:R.value?"60px":""}),"hide-trigger":!0,onCollapse:He},{default:_(()=>[i("div",kd,[m(Ut)])]),_:1},8,["collapsed","width","style"])),[[Lo,!Ve.value]]):Q("",!0),Ve.value?(E(),V($,{key:1,visible:Oe.value,placement:"left",footer:!1,"mask-closable":"",closable:!1,onCancel:Re},{default:_(()=>[m(Ut)]),_:1},8,["visible"])):Q("",!0),m(q,{class:"layout-content",style:zn(ke.value)},{default:_(()=>[M(g).tabBar?(E(),V(Fu,{key:0})):Q("",!0),m(L,null,{default:_(()=>[m(Ad)]),_:1})]),_:1},8,["style"])]),_:1})]),_:1}),m(U,{visible:j.value,"onUpdate:visible":r[0]||(r[0]=X=>j.value=X),closable:!1,"esc-to-close":!1,"hide-cancel":!0,"mask-closable":!1,footer:!1},{default:_(()=>[i("div",Od,[i("div",Rd,[(E(),V(Ke(M(ir))))]),i("div",Nd,[i("div",Ld,[i("span",null,A(se.value),1)])]),i("div",Pd,A(Ae.value),1),i("div",Ud,[m(te,{type:"primary",onClick:We},{default:_(()=>[ae(A(n.$t("error.logout.btn.label1")),1)]),_:1})])])]),_:1},8,["visible"]),m(U,{visible:Y.value,"onUpdate:visible":r[1]||(r[1]=X=>Y.value=X),"modal-class":"custom-modal",width:"398px",closable:!1,"esc-to-close":!1,"hide-cancel":!0,"mask-closable":!1,footer:!1},{default:_(()=>[i("div",Dd,[i("div",xd,[(E(),V(Ke(M(tr))))]),i("div",jd,[i("div",Bd,[i("span",null,A(n.$t("error.logout.tip10")),1)])]),i("div",Gd,A(n.$t("error.logout.tip9"))+" ("+A(_e.value)+"/30)",1),i("div",Fd,[i("div",Vd,[m(te,{type:"outline",onClick:vt},{default:_(()=>[ae(A(n.$t("error.logout.btn.label2")),1)]),_:1})]),i("div",Hd,[m(te,{type:"primary",onClick:We},{default:_(()=>[ae(A(n.$t("error.logout.btn.label3")),1)]),_:1})])])])]),_:1},8,["visible"]),m(U,{visible:fe.value,"onUpdate:visible":r[2]||(r[2]=X=>fe.value=X),"modal-class":"custom-modal",width:"398px",closable:!1,"esc-to-close":!1,"hide-cancel":!0,"mask-closable":!1,footer:!1},{default:_(()=>[i("div",Wd,[i("div",qd,[(E(),V(Ke(M(sr))))]),i("div",zd,[i("div",Kd,[i("span",null,A(n.$t("error.logout.tip11")),1)])]),i("div",Jd,[i("div",Qd,[m(te,{type:"outline",onClick:ms},{default:_(()=>[ae(A(n.$t("error.logout.btn.label4")),1)]),_:1})]),i("div",Zd,[m(te,{type:"primary",onClick:We},{default:_(()=>[ae(A(n.$t("error.logout.btn.label3")),1)]),_:1})])])])]),_:1},8,["visible"]),pe.value?(E(),V(U,{key:1,visible:pe.value,"onUpdate:visible":r[3]||(r[3]=X=>pe.value=X),footer:!1,closable:!1,class:"customModal"},{default:_(()=>[pe.value?(E(),V(Qu,{key:0,onHandleClose:Xt,onHandleJoinMeeting:is})):Q("",!0)]),_:1},8,["visible"])):Q("",!0),M(p).upcomingMeetingVisible?(E(),z("div",Yd,[M(p).upcomingMeetingVisible?(E(),V(ud,{key:0,ref_key:"upcomingModalRef",ref:Fe},null,512)):Q("",!0)])):Q("",!0),ne.value?(E(),V(U,{key:3,visible:ne.value,"onUpdate:visible":r[4]||(r[4]=X=>ne.value=X),footer:!1,closable:!1,class:"customModal"},{default:_(()=>[ne.value?(E(),V(Za,{key:0,onHandleClose:_t,onHandleJoinMeeting:bt})):Q("",!0)]),_:1},8,["visible"])):Q("",!0),he.value?(E(),V(U,{key:4,visible:he.value,"onUpdate:visible":r[5]||(r[5]=X=>he.value=X),footer:!1,closable:!1,class:"customModal"},{default:_(()=>[he.value?(E(),V(bd,{key:0,onHandleClose:ht})):Q("",!0)]),_:1},8,["visible"])):Q("",!0)]),_:1},8,["class"])}}});const pf=le(tf,[["__scopeId","data-v-b7a0ac39"]]);export{pf as default};
