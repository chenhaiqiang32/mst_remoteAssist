import{e as Je,Q as Se,aa as me,v as ue,M as Ie,h as Y,E as H,_ as oe,u as Ye,a9 as dt,ac as ut,d as mt,C as ee,x as pt,ao as vt,ah as Fe}from"./index.56b53071.js";/* empty css               */import{d as ae,j as C,w as ke,o as ge,b as he,C as s,aE as B,aH as O,E as e,aN as h,aI as y,D as c,aK as F,aJ as W,F as se,u as n,aF as D,aS as ye,bH as _t,bG as Ce,bK as ze,H as gt,a as ht,G as Ee,aW as x,ac as we,b3 as $e,b0 as ft,b1 as bt,b7 as Ze,ag as It,aX as yt,bP as Ct,c as $t,b6 as At,aD as Mt,bQ as Gt,bc as Tt,n as kt}from"./arco.7c13ffb5.js";import{n as X,O as Ne,d as Nt,s as St}from"./icon_volume_1.11c747fb.js";import{o as Et}from"./index.4818ad0f.js";import{S as Qe,a as je,o as wt,h as Ut,I as Dt}from"./invite.42d13073.js";import{c as Ae}from"./icon_close.f7fee805.js";import"./chart.a30fa8da.js";import"./vue.671e172d.js";const Ot="/assist/assets/no_chat.3fc2e4cf.png",Rt={class:"chat-panel-top"},Bt={class:"chat-panel-top-left"},Lt={class:"chat-panel-top-right"},Ht={key:0,class:"chat-panel-content wsl-scroll"},xt=["onClick"],Pt={class:"chat-panel-content-item-left"},Vt=["src"],Ft={class:"chat-panel-content-item-right",fill:""},Qt={class:"chat-panel-content-item-right-top"},jt={class:"chat-panel-content-item-right-top-name textEllipsis"},Jt={class:"chat-panel-content-item-right-top-time"},Yt={class:"chat-panel-content-item-right-bot"},zt={class:"chat-panel-content-item-right-bot-left"},Zt={key:0,class:"chat-panel-content-item-right-bot-right"},Kt={key:1,class:"no-data"},qt={class:"no-data-body"},Xt=["src"],Wt={class:"no-data-body-text"},es="ChatDB",ts=ae({__name:"chat",setup(Q){const{getAllConversations:$,updateConversations:T}=Je(es),d=Se(),A=me(),m=C(d.conversationList),{t:M}=ue.exports.useI18n(),u=C({condition:""}),t=S=>{const{messageType:p,content:r}=S;try{if(p===Ie.SYSTEM){const _=JSON.parse(r),{eventType:J,eventData:a}=_;switch(J){case Y.CHAT_GROUP_CREATED:{const g=a.masterName||A.filterMemberInfoByUserId(a.masterId).name,k=a.names||X(a.userIds.map(f=>A.memberList.find(I=>I.userId===f)).filter(Boolean),"name").join("\u3001");return`${g} ${M("message.invite.join.group.menu.invite")} ${k} ${M("message.chat.room.message.tips.create.group2")}`}case Y.CHAT_GROUP_INFO_UPDATED:return`${a.updatedName||A.filterMemberInfoByUserId(a.updateUserId).name} ${M("message.chat.room.message.tips.update.group")}`;case Y.CHAT_GROUP_MEMBER_INVITED:{const g=a.invitorName||A.filterMemberInfoByUserId(a.invitorUserId).name,k=a.inviteeNames||X(a.inviteeUserIds.map(f=>A.memberList.find(I=>I.userId===f)).filter(Boolean),"name").join("\u3001");return`${g} ${M("message.chat.room.message.tips.invite.group")} ${k} ${M("message.chat.room.message.tips.invite.group2")}`}case Y.CHAT_GROUP_MEMBER_REMOVED:{const g=a.masterName||A.filterMemberInfoByUserId(a.masterId).name,k=a.removedNames||X(a.removedUserIds.map(f=>A.memberList.find(I=>I.userId===f)).filter(Boolean),"name").join("\u3001");return`${g} ${M("message.chat.room.message.tips.remove.group")} ${k}`}case Y.CHAT_GROUP_MEMBER_QUIT:return`${a.quitName||A.filterMemberInfoByUserId(a.quitUserId).name} ${M("message.chat.room.message.tips.quit.group")}`;case Y.CHAT_GROUP_MASTER_CHANGED:{const g=a.oldMasterName||A.filterMemberInfoByUserId(a.oldMasterId).name,k=a.newMasterName||A.filterMemberInfoByUserId(a.newMasterId).name;return`${g} ${M("message.chat.room.message.tips.change.group")} ${k}`}case Y.CHAT_GROUP_DISBANDED:return`${a.masterName||A.filterMemberInfoByUserId(a.masterId).name} ${M("message.chat.room.message.tips.disbanded.group")}`;default:return _}}else return r}catch{return r}},i=S=>{const p=ye(),r=ye(S),_=r.format("YYYY-MM-DD HH:mm");return r.isSame(p,"day")?`${M("today")} ${r.format("HH:mm")}`:r.isSame(p.add(1,"day"),"day")?`${M("tomorrow")} ${r.format("HH:mm")}`:r.isSame(p.subtract(1,"day"),"day")?`${M("yesterday")} ${r.format("HH:mm")}`:_},v=async()=>{m.value=await $(),d.updateConversationList(m.value),console.log("handleGetConversationList",m.value)},U=()=>{if(!u.value.condition)return d.conversationList;const S=u.value.condition.toLowerCase();return d.conversationList.filter(p=>p.targetName.toLowerCase().includes(S)||p.content.toLowerCase().includes(S))},N=()=>{m.value=U()},R=()=>{d.groupChatSettingVisible&&d.updateGroupChatSettingVisible(!1)},P=async S=>{S&&(S.unreadCount=0,T(S),d.updateCurConversation(Ne(S)),H.emit("ChatConversationRead",S)),R()},V=()=>{P(d.curConversation)},Z=()=>{H.on("group-info-change",v),H.on("send-refresh-chat-room",v),H.on("event-exit-group-chat",V),H.on("event-disband-group-chat",V)},G=()=>{H.off("group-info-change",v),H.off("send-refresh-chat-room",v),H.off("event-exit-group-chat",V),H.off("event-disband-group-chat",V)};return ke(()=>d.conversationList,()=>{N()},{deep:!0,immediate:!0}),ge(async()=>{v(),Z()}),he(()=>{G()}),(S,p)=>{const r=_t,_=Ce,J=ze;return s(),B(J,{class:"general-card chat-panel",bordered:!1,"body-style":{height:"100%",display:"flex",padding:0,flexFlow:"column"}},{default:O(()=>[e("div",Rt,[e("div",Bt,[e("span",null,h(S.$t("message.chat.title")),1)]),e("div",Lt,[y(r,{modelValue:u.value.condition,"onUpdate:modelValue":p[0]||(p[0]=a=>u.value.condition=a),style:{width:"100%"},placeholder:S.$t("message.chat.search"),onInput:N},null,8,["modelValue","placeholder"])])]),y(_,{margin:0}),m.value&&m.value.length>0?(s(),c("div",Ht,[(s(!0),c(F,null,W(m.value,(a,g)=>{var k;return s(),c("div",{key:`group_${g}`,class:se(["chat-panel-content-item",((k=n(d).curConversation)==null?void 0:k.conversationId)===a.conversationId?"active":""]),onClick:f=>P(a)},[e("div",Pt,[e("img",{src:a.targetAvatarUrl,alt:""},null,8,Vt)]),e("div",Ft,[e("div",Qt,[e("div",jt,h(a.targetName),1),e("div",Jt,h(i(a.sendTime)),1)]),e("div",Yt,[e("div",zt,h(t(a)),1),a.unreadCount>0?(s(),c("div",Zt,[e("span",null,h(a.unreadCount),1)])):D("",!0)])])],10,xt)}),128))])):(s(),c("div",Kt,[e("div",qt,[e("img",{src:n(Ot),alt:""},null,8,Xt),e("div",Wt,h(S.$t("meeting.no.data.text")),1)])]))]),_:1})}}});const ss=oe(ts,[["__scopeId","data-v-f4e64ea2"]]);const ns={width:"24",height:"24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function os(Q,$){return s(),c("svg",ns,$[0]||($[0]=[e("g",{stroke:"#314669","stroke-width":"1.5"},[e("path",{d:"M21.97 18.33c0 .36-.08.73-.25 1.09-.17.36-.39.7-.68 1.02-.49.54-1.03.93-1.64 1.18-.6.25-1.25.38-1.95.38-1.02 0-2.11-.24-3.26-.73s-2.3-1.15-3.44-1.98a28.75 28.75 0 0 1-3.28-2.8 28.414 28.414 0 0 1-2.79-3.27c-.82-1.14-1.48-2.28-1.96-3.41C2.24 8.67 2 7.58 2 6.54c0-.68.12-1.33.36-1.93.24-.61.62-1.17 1.15-1.67C4.15 2.31 4.85 2 5.59 2c.28 0 .56.06.81.18.26.12.49.3.67.56l2.32 3.27c.18.25.31.48.4.7.09.21.14.42.14.61 0 .24-.07.48-.21.71-.13.23-.32.47-.56.71l-.76.79c-.11.11-.16.24-.16.4 0 .08.01.15.03.23.03.08.06.14.08.2.18.33.49.76.93 1.28.45.52.93 1.05 1.45 1.58.54.53 1.06 1.02 1.59 1.47.52.44.95.74 1.29.92.05.02.11.05.18.08.08.03.16.04.25.04.17 0 .3-.06.41-.17l.76-.75c.25-.25.49-.44.72-.56.23-.14.46-.21.71-.21.19 0 .39.04.61.13.22.09.45.22.7.39l3.31 2.35c.26.18.44.39.55.64.1.25.16.5.16.78Z","stroke-miterlimit":"10"}),e("path",{d:"M18.5 9c0-.6-.47-1.52-1.17-2.27-.64-.69-1.49-1.23-2.33-1.23M22 9c0-3.87-3.13-7-7-7","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))}const as={render:os},rs={width:"24",height:"24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function is(Q,$){return s(),c("svg",rs,$[0]||($[0]=[gt('<g stroke="#314769" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10ZM3.41 22c0-3.87 3.85-7 8.59-7 .96 0 1.89.13 2.76.37"></path><path d="M22 18c0 .32-.04.63-.12.93-.09.4-.25.79-.46 1.13A3.97 3.97 0 0 1 18 22a3.92 3.92 0 0 1-2.66-1.03c-.3-.26-.56-.57-.76-.91A3.92 3.92 0 0 1 14 18a3.995 3.995 0 0 1 4-4c1.18 0 2.25.51 2.97 1.33.64.71 1.03 1.65 1.03 2.67Z" stroke-miterlimit="10"></path><g stroke-miterlimit="10"><path d="M19.492 17.98h-2.98M18 16.52v2.99"></path></g></g>',1)]))}const ls={render:is},cs={width:"24",height:"24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function ds(Q,$){return s(),c("svg",cs,$[0]||($[0]=[e("g",{stroke:"#314669","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M9 22h6c5 0 7-2 7-7V9c0-5-2-7-7-7H9C4 2 2 4 2 9v6c0 5 2 7 7 7Z"}),e("path",{d:"M15.57 18.5v-3.9M15.57 7.45V5.5M15.569 12.65a2.6 2.6 0 1 0 0-5.2 2.6 2.6 0 0 0 0 5.2ZM8.43 18.5v-1.95M8.43 9.4V5.5M8.428 16.55a2.6 2.6 0 1 0 0-5.2 2.6 2.6 0 0 0 0 5.2Z","stroke-miterlimit":"10"})],-1)]))}const us={render:ds},ms="/assist/assets/no_message.49d2ffdd.png",ps={width:"56",height:"44",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function vs(Q,$){return s(),c("svg",ps,$[0]||($[0]=[e("rect",{width:"56",height:"44",rx:"4",fill:"#165DFF"},null,-1),e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M37.334 23.273a3.001 3.001 0 0 1-1.197 1.197l-10.7 5.836a3 3 0 0 1-4.303-3.516l1.524-4.954-1.524-4.954a3 3 0 0 1 4.303-3.516l10.7 5.836a3 3 0 0 1 1.197 4.07Zm-1.756-.958a1 1 0 0 0-.3-1.295l-.099-.062-10.7-5.836a1 1 0 0 0-1.462 1.059l.028.113 1.449 4.71h5.256a1 1 0 0 1 .117 1.992l-.117.007h-5.359l-1.346 4.375a1 1 0 0 0 1.329 1.222l.106-.05 10.7-5.836a1 1 0 0 0 .398-.4Z",fill:"#fff"},null,-1)]))}const _s={render:vs},gs={class:"system-container"},hs={class:"system-message"},fs=ae({__name:"system",props:{message:{}},setup(Q){const{t:$}=ue.exports.useI18n(),T=me(),d=Q,A=C(d.message),m=M=>{const{eventType:u,eventData:t}=M;switch(u){case Y.CHAT_GROUP_CREATED:{let i;t.masterName?i=t.masterName:i=T.filterMemberInfoByUserId(t.masterId).name;let v;if(t.names)v=t.names;else{const U=t.userIds.map(N=>T.memberList.find(R=>R.userId===N)).filter(Boolean);v=X(U,"name").join("\u3001")}return`${i} ${$("message.invite.join.group.menu.invite")} ${v} ${$("message.chat.room.message.tips.create.group2")}`}case Y.CHAT_GROUP_INFO_UPDATED:{let i;return t.updatedName?i=t.updatedName:i=T.filterMemberInfoByUserId(t.updateUserId).name,`${i} ${$("message.chat.room.message.tips.update.group")}`}case Y.CHAT_GROUP_MEMBER_INVITED:{let i;t.invitorName?i=t.invitorName:i=T.filterMemberInfoByUserId(t.invitorUserId).name;let v;if(t.inviteeNames)v=t.inviteeNames;else{const U=t.inviteeUserIds.map(N=>T.memberList.find(R=>R.userId===N)).filter(Boolean);v=X(U,"name").join("\u3001")}return`${i} ${$("message.chat.room.message.tips.invite.group")} ${v} ${$("message.chat.room.message.tips.invite.group2")}`}case Y.CHAT_GROUP_MEMBER_REMOVED:{let i;t.masterName?i=t.masterName:i=T.filterMemberInfoByUserId(t.masterId).name;let v;if(t.removedNames)v=t.removedNames;else{const U=t.removedUserIds.map(N=>T.memberList.find(R=>R.userId===N)).filter(Boolean);v=X(U,"name").join("\u3001")}return`${i} ${$("message.chat.room.message.tips.remove.group")} ${v}`}case Y.CHAT_GROUP_MASTER_CHANGED:{let i;t.oldMasterName?i=t.oldMasterName:i=T.filterMemberInfoByUserId(t.oldMasterId).name;let v;return t.newMasterName?v=t.newMasterName:v=T.filterMemberInfoByUserId(t.newMasterId).name,`${i} ${$("message.chat.room.message.tips.change.group")} ${v}`}case Y.CHAT_GROUP_DISBANDED:{let i;return t.masterName?i=t.masterName:i=T.filterMemberInfoByUserId(t.masterId).name,`${i} ${$("message.chat.room.message.tips.disbanded.group")}`}case Y.CHAT_GROUP_MEMBER_QUIT:{let i;return t.quitName?i=t.quitName:i=T.filterMemberInfoByUserId(t.quitUserId).name,`${i} ${$("message.chat.room.message.tips.quit.group")}`}default:return M}};return ht(()=>{A.value=d.message}),(M,u)=>(s(),c("div",gs,[e("div",hs,[e("span",null,h(m(A.value)),1)])]))}});const bs=oe(fs,[["__scopeId","data-v-909e595d"]]),Ke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAAXNSR0IArs4c6QAAAL9JREFUOE9j3L//PoeQJMtkBob/IQwMjAIM+MB/hi8MjP/nvHv+t5Lx4o1H/Qz/GVXYGBgTNDVl3uLTd/3JE+FfX/8vYPjP8ILx4o3Hn9n+MyoQ0gQz8MzNmyIs/zlvgzT+19eQZcTrRDRJkJ5RjThCbMAC59H731++q5qYqL8hJi5BCYD1H9d9UDzOZvjPIPH767dEQprPnLkpwsrNNZ+B8f8dRkgiZ25nYGBMYWBg4MGfxv9/YGRgXPPu+Z9cANw1hWlIktI3AAAAAElFTkSuQmCC",qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAOCAYAAADwikbvAAAAAXNSR0IArs4c6QAAAQpJREFUOE+d0j1LQlEYwPH/c25DSx+hSSKpxU1sk7ulW1hDZE5eB6PNoUERBwcncVJocQkCp96WPoARfYGWoJZcQhwMQn1CJezlivd2tsM5v/O8nEcALEeTCjlgc7xfsF4EisO6nIrl6LbC1SLx+1yEPTFpbSIc+MUq3IzxOULCN1YePOPDCJzdw8dgGka94lYG7CCs56HTm4NXluEyC7kW3D1NL10fQSQA4TI8dmbF/Ym8ZEF1F1JbEKtBPg6hVQiV4PntZ1dc07YMVHbg2IbuO2wUZql+53NrNgLZKDTb0O27/4PnhrnxL/y/IYELwVHbwK3fIRkp+zJBGU0Z5QRY8/DI60gp0JDGJ7LiaVUfadx2AAAAAElFTkSuQmCC",Is={class:"remove-modal-container"},ys=["src"],Cs={class:"remove-m-t"},$s={class:"remove-m-s"},As={class:"remove-m-m wsl-scroll"},Ms=["onClick"],Gs={class:"remove-m-m-i-l"},Ts=["src"],ks={class:"remove-m-m-i-r"},Ns={class:"remove-m-m-i-rl"},Ss=["src"],Es={class:"remove-m-m-i-rr"},ws={class:"remove-m-m-i-rr-t"},Us={class:"remove-m-m-i-rr-b"},Ds={class:"remove-m-b"},Os={class:"remove-m-b-l"},Rs=["src"],Bs={class:"remove-m-b-r"},Ls=ae({__name:"remove",props:{members:{}},emits:["handleClose","handleSureRemove"],setup(Q,{emit:$}){const T=me(),d=$,{t:A}=ue.exports.useI18n(),m=()=>{d("handleClose")},M=Q,u=C([]),t=p=>u.value.some(r=>r.userId===p),i=p=>{const r=u.value.findIndex(_=>_.userId===p.userId);r===-1?u.value.push(p):u.value.splice(r,1)},v=C(20),U=p=>({zIndex:p,left:`${p*v.value}px`}),N=C([]),R=C({condition:""}),P=()=>{if(!R.value.condition)return M.members;const p=R.value.condition.toLowerCase();return M.members.filter(r=>r.name.toLowerCase().includes(p))},V=()=>{N.value=P(),console.log("\u67E5\u8BE2\u4EBA\u5458\u4E8B\u4EF6",N.value)},Z=p=>{const r=C("");return p.pcOnline||p.androidOnline||p.glassOnline?r.value="online":r.value="outline",r.value},G=()=>{u.value&&u.value.length>0?d("handleSureRemove",u.value):x.warning(A("message.invite.join.group.select.psn.warning"))},S=()=>{u.value=[]};return ge(()=>{V()}),he(()=>{S()}),(p,r)=>{const _=we,J=$e;return s(),c("div",Is,[e("div",{class:"remove-fixed",onClick:m},[e("img",{src:n(Ae),alt:""},null,8,ys)]),e("div",Cs,h(p.$t("meeting.select.tr.title")),1),e("div",$s,[y(J,{modelValue:R.value.condition,"onUpdate:modelValue":r[0]||(r[0]=a=>R.value.condition=a),class:"search-input",onInput:V},{prefix:O(()=>[y(_)]),_:1},8,["modelValue"])]),e("div",As,[(s(!0),c(F,null,W(N.value,(a,g)=>(s(),c("div",{key:`invite_psn_${g}_${a.userId}`,class:"remove-m-m-i",onClick:k=>i(a)},[e("div",Gs,[e("img",{src:t(a.userId)?n(qe):n(Ke),alt:"avatar"},null,8,Ts)]),e("div",ks,[e("div",Ns,[e("img",{src:a.avatarUrl,alt:""},null,8,Ss),e("div",{class:se(["remove-m-m-i-rl-s",Z(a)])},null,2)]),e("div",Es,[e("div",ws,[e("span",null,h(a.name),1)]),e("div",Us,[e("span",null,h(a.alias),1)])])])],8,Ms))),128))]),e("div",Ds,[e("div",Os,[(s(!0),c(F,null,W(u.value,(a,g)=>(s(),c(F,{key:`invite_m_icon_${g}`},[g<n(T).limitMember?(s(),c("div",{key:0,class:"remove-m-b-l-i",style:Ee(U(g))},[e("img",{src:a.avatarUrl,alt:""},null,8,Rs)],4)):D("",!0)],64))),128))]),e("div",Bs,[e("div",{class:"remove-m-b-r-btn",onClick:G},[e("span",null,h(n(A)("meeting.menu.btn.remove")),1)])])])])}}});const Hs=oe(Ls,[["__scopeId","data-v-7c724d57"]]),xs={class:"invite-join-group-modal-container"},Ps=["src"],Vs={class:"invite-m-t"},Fs={class:"invite-m-tabs"},Qs={class:"invite-m-tabs-main"},js={class:"invite-m-s"},Js={class:"invite-m-main wsl-scroll"},Ys=["onClick"],zs={class:"invite-m-main-i-l"},Zs={class:"invite-m-main-i-r"},Ks={class:"invite-m-main-i-rl"},qs=["src"],Xs={class:"invite-m-main-i-rr"},Ws={class:"invite-m-main-i-rr-t"},en={class:"invite-m-main-i-rr-b"},tn=["onClick"],sn={class:"header-main-left"},nn={class:"header-main-left-i"},on=["src"],an={class:"header-main-title"},rn={class:"invite-main-group-body"},ln=["onClick"],cn={class:"invite-m-main-i-l"},dn={class:"invite-m-main-i-r"},un={class:"invite-m-main-i-rl"},mn=["src"],pn={class:"invite-m-main-i-rr"},vn={class:"invite-m-main-i-rr-t"},_n={class:"invite-m-main-i-rr-b"},gn={class:"invite-m-bot"},hn={class:"invite-m-bot-l"},fn=["src"],bn={class:"invite-m-bot-r"},In=ae({__name:"invite-join-group",props:{members:{},groupMembers:{}},emits:["handleClose","handleInvite"],setup(Q,{emit:$}){const T=Q,d=C(T.members),A=C(T.groupMembers),m=me(),M=$,{t:u}=ue.exports.useI18n(),t=()=>{M("handleClose")},i=C({condition:""}),v=C(1),U=C({}),N=f=>{U.value[f]=!U.value[f]},R=f=>{const I=C("");switch(f.role){case 1:I.value=u("meeting.invite.psn.type.normal");break;case 2:I.value=u("meeting.invite.psn.type.product");break;case 3:I.value=u("meeting.invite.psn.type.technology");break;case 4:I.value=u("meeting.invite.psn.type.super");break}return I.value},P=f=>{const I=C("");return f.pcOnline||f.androidOnline||f.glassOnline?I.value="online":I.value="outline",I.value},V=C(20),Z=f=>({zIndex:f,left:`${f*V.value}px`}),G=()=>{if(!i.value.condition)return T.members;const f=i.value.condition.toLowerCase();return T.members.filter(I=>I.name.toLowerCase().includes(f))},S=async()=>{if(!i.value.condition)return T.groupMembers;const f=i.value.condition.toLowerCase();return T.groupMembers.map(I=>({...I,contacts:I.contacts.filter(re=>re.name.toLowerCase().includes(f))})).filter(I=>I.contacts.length>0)},p=async()=>{v.value===1?d.value=G():v.value===2&&(A.value=await S())},r=f=>{v.value=f,i.value.condition="",p()},_=C([]),J=f=>_.value.some(I=>I.userId===f),a=f=>{const I=_.value.findIndex(re=>re.userId===f.userId);I===-1?_.value.push(f):_.value.splice(I,1)},g=()=>{_.value&&_.value.length>0?M("handleInvite",_.value):x.warning(u("message.invite.join.group.select.psn.warning"))},k=()=>{_.value=[]};return ge(()=>{p()}),he(()=>{k()}),(f,I)=>{const re=we,Me=$e;return s(),c("div",xs,[e("div",{class:"invite-fixed",onClick:t},[e("img",{src:n(Ae),alt:""},null,8,Ps)]),e("div",Vs,h(f.$t("message.invite.join.group.title")),1),e("div",Fs,[e("div",Qs,[e("div",{class:se(["invite-m-tabs-i",v.value===1?"active":""]),onClick:I[0]||(I[0]=L=>r(1))},[e("span",null,h(f.$t("message.invite.join.group.tabs.all")),1)],2),e("div",{class:se(["invite-m-tabs-i",v.value===2?"active":""]),onClick:I[1]||(I[1]=L=>r(2))},[e("span",null,h(f.$t("message.invite.join.group.tabs.group")),1)],2)])]),e("div",js,[y(Me,{modelValue:i.value.condition,"onUpdate:modelValue":I[2]||(I[2]=L=>i.value.condition=L),class:"search-input",onInput:p},{prefix:O(()=>[y(re)]),_:1},8,["modelValue"])]),e("div",Js,[v.value===1?(s(!0),c(F,{key:0},W(d.value,(L,K)=>(s(),c("div",{key:`psn_${K}_${L.userId}`,class:"invite-m-main-i",onClick:j=>a(L)},[e("div",zs,[J(L.userId)?(s(),B(n(Qe),{key:0})):(s(),B(n(je),{key:1}))]),e("div",Zs,[e("div",Ks,[e("img",{src:L.avatarUrl,alt:""},null,8,qs),e("div",{class:se(["invite-m-main-i-rl-s",P(L)])},null,2)]),e("div",Xs,[e("div",Ws,[e("span",null,h(L.name),1)]),e("div",en,[e("span",null,h(R(L)),1)])])])],8,Ys))),128)):D("",!0),v.value===2?(s(!0),c(F,{key:1},W(A.value,(L,K)=>(s(),c("div",{key:`group_${K}`,class:"invite-m-main-group"},[e("div",{class:"invite-main-group-header",onClick:j=>N(K)},[e("div",sn,[e("div",nn,[e("img",{src:n(wt),alt:""},null,8,on)]),e("div",an,[e("span",null,h(L.groupName)+" ("+h(L.contacts.length)+")",1)])]),e("div",{class:se(["header-main-right",{"rotate-icon":U.value[K]}])},[y(n(Ut))],2)],8,tn),ft(e("div",rn,[(s(!0),c(F,null,W(L.contacts,(j,ie)=>(s(),c("div",{key:`group_psn_${ie}_${j.userId}`,class:"invite-m-main-i",onClick:ne=>a(j)},[e("div",cn,[J(j.userId)?(s(),B(n(Qe),{key:0})):(s(),B(n(je),{key:1}))]),e("div",dn,[e("div",un,[e("img",{src:j.avatarUrl,alt:""},null,8,mn),e("div",{class:se(["invite-m-main-i-rl-s",P(j)])},null,2)]),e("div",pn,[e("div",vn,[e("span",null,h(j.name),1)]),e("div",_n,[e("span",null,h(R(j)),1)])])])],8,ln))),128))],512),[[bt,U.value[K]]])]))),128)):D("",!0)]),e("div",gn,[e("div",hn,[(s(!0),c(F,null,W(_.value,(L,K)=>(s(),c(F,{key:`invite_m_icon_${K}`},[K<n(m).showLimitMember?(s(),c("div",{key:0,class:"invite-m-bot-l-i",style:Ee(Z(K))},[e("img",{src:L.avatarUrl,alt:""},null,8,fn)],4)):D("",!0)],64))),128))]),e("div",bn,[e("div",{class:"invite-m-bot-r-btn",onClick:g},[e("span",null,h(n(u)("message.invite.join.group.menu.invite")),1)])])])])}}});const yn=oe(In,[["__scopeId","data-v-c35a03ed"]]);const Cn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAAAXNSR0IArs4c6QAAAStJREFUKFOdki1IQ2EUhp9zGduCYaBhTSxiMBgEkzCDIBZvM1huunfNHzD4U4QLq84wvMNgsQgDw4JJByaDRQxiMxgEw4LBgXxH7ub129gG6hfPd57z977CP570Mb6OOQ4lDEvAhTGEnMhrd56FCppyJlkH9hFyXUnvJo61iDiVjzjegTzNS5prEaaGTavwoMoCVXlrQ46vAcJxAmwtQsmF7RocXdkyRilSlagDBRqPdZh814rgzkD9HlYqPb03TCTlgdD4KKzOwtktvDR/AWVTsLsMcxNw9wwHdWh9/oC2E74GzvdOwTxU1mz1zXO7V89OeJqTDDcC00OvpzyqoRBrZnXyNEuGQCAUGElgVZoKIU+UaUh70H5HeJonzZ6Aq3AJ7MTaDHbEHzz4BWPfYg4WmCA2AAAAAElFTkSuQmCC",$n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAHFJREFUSEtjZKAxYKSx+QyjFhAMYZKC6MSZG/kgEy1MNCYSNBmqgFQL9kMtcBy1AGsInDhzY4gEETS1BGB4g5HRACz2//8FLF7cgC11YU1FNLcAVxIcOnEw6gPkECC1LKJtYUdsAUe2D0YtICcECOoBAKnhQBlcrxl4AAAAAElFTkSuQmCC",An="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAFBJREFUSEtjZKAxYKSx+QyjFhAM4dEgGg0igiFAUAHWVHTizI18BgaGAIK6URVssDDRmIiuZ2AsINHleJWPZjSCoTkaRKNBRDAECCqgeSoCACxGChn+C3lNAAAAAElFTkSuQmCC",Mn={class:"group-container"},Gn={class:"group-container-top"},Tn={class:"group-container-top-left"},kn=["src"],Nn={class:"group-container-main"},Sn={class:"group-container-main-top"},En={class:"group-container-main-top-left"},wn=["src"],Un={class:"group-container-main-top-right"},Dn={class:"group-container-main-top-right-n"},On={class:"group-container-main-divider"},Rn={class:"group-container-main-mid"},Bn={class:"group-container-main-mid-top"},Ln={class:"group-container-main-mid-body wsl-scroll"},Hn={class:"group-container-main-mid-body-item-top"},xn=["src"],Pn={key:0,class:"group-container-main-mid-body-item-top-fixed"},Vn=["src"],Fn={class:"group-container-main-mid-body-item-bot"},Qn={key:"group_add",class:"group-container-main-mid-body-item"},jn=["src"],Jn={key:"group_layoff",class:"group-container-main-mid-body-item"},Yn=["src"],zn={class:"group-container-main-divider"},Zn={class:"group-container-main-menu"},Kn=ae({__name:"group-setting",emits:["handleClose","handleRemoveGroup","handleInviteJoinGroup","handleTransferOpen","handleSureExitGroup","handleSureDisbandGroup"],setup(Q,{emit:$}){const{t:T}=ue.exports.useI18n(),d=Se(),A=Ye(),m=$,M=()=>{m("handleClose")},u=C(),t=C(!1),i=()=>{t.value=!0,setTimeout(()=>{u==null||u.value.focus()},100)},v=()=>{d.updateCurConversation({...d.curConversation,targetName:d.curGroupDetail.groupName}),d.conversationList.forEach(G=>{G.targetId===d.curGroupDetail.groupId&&(G.targetName=d.curGroupDetail.groupName)})},U=async()=>{if(!d.curGroupDetail.groupName){x.error(T("message.chat.group.revamp.name.tips"));return}const G=await d.revampGroupName({groupId:d.curGroupDetail.groupId,groupName:d.curGroupDetail.groupName});if(G.code!==200&&G.code!==401){x.error(G.msg);return}x.success(T("message.chat.group.revamp.name")),t.value=!1,v()},N=()=>{m("handleRemoveGroup")},R=()=>{m("handleInviteJoinGroup")},P=()=>{m("handleTransferOpen")},V=()=>{m("handleSureExitGroup")},Z=()=>{m("handleSureDisbandGroup")};return(G,S)=>{const p=Ce,r=Ze,_=It,J=$e,a=yt,g=Ct;return s(),c("div",Mn,[e("div",Gn,[e("div",Tn,[e("span",null,h(G.$t("message.chat.group.title")),1)]),e("div",{class:"group-container-top-right",onClick:M},[e("img",{src:n(Ae),alt:""},null,8,kn)])]),y(p,{margin:0}),e("div",Nn,[e("div",Sn,[e("div",En,[e("img",{src:n(d).curGroupDetail.avatarUrl,alt:""},null,8,wn)]),e("div",Un,[t.value?(s(),B(J,{key:1,ref_key:"GroupInfoNameRef",ref:u,modelValue:n(d).curGroupDetail.groupName,"onUpdate:modelValue":S[0]||(S[0]=k=>n(d).curGroupDetail.groupName=k),onBlur:U},null,8,["modelValue"])):(s(),c(F,{key:0},[y(r,{content:n(d).curGroupDetail.groupName},{default:O(()=>[e("div",Dn,h(n(d).curGroupDetail.groupName),1)]),_:1},8,["content"]),y(r,{content:n(T)("message.chat.group.revamp.name.btn")},{default:O(()=>[n(d).curGroupDetail.masterId===n(A).userId?(s(),B(_,{key:0,onClick:i})):D("",!0)]),_:1},8,["content"])],64))])]),e("div",On,[y(p,{margin:0})]),e("div",Rn,[e("div",Bn,h(G.$t("message.chat.group.mid.top"))+" ("+h(n(d).curGroupDetail.members.length)+h(G.$t("message.chat.group.mid.dw"))+") ",1),e("div",Ln,[(s(!0),c(F,null,W(n(d).curGroupDetail.members,(k,f)=>(s(),c("div",{key:`group_psn_${f}_${k.userId}`,class:"group-container-main-mid-body-item"},[e("div",Hn,[e("img",{src:k.avatarUrl,alt:""},null,8,xn),k.isMaster==1?(s(),c("div",Pn,[y(r,{content:G.$t("message.chat.group.owner")},{default:O(()=>[e("img",{src:n(Cn),alt:""},null,8,Vn)]),_:1},8,["content"])])):D("",!0)]),y(r,{content:k.name},{default:O(()=>[e("div",Fn,h(k.name),1)]),_:2},1032,["content"])]))),128)),e("div",Qn,[e("div",{class:"group-container-main-mid-body-item-top btn",onClick:R},[e("img",{src:n($n),alt:""},null,8,jn)])]),n(d).curGroupDetail.masterId===n(A).userId?(s(),c("div",Jn,[e("div",{class:"group-container-main-mid-body-item-top btn",onClick:N},[e("img",{src:n(An),alt:""},null,8,Yn)])])):D("",!0)])]),e("div",zn,[y(p,{margin:0})]),e("div",Zn,[n(d).curGroupDetail.masterId===n(A).userId?(s(),B(a,{key:0,onClick:P},{default:O(()=>[e("span",null,h(G.$t("meeting.menu.btn.transfer")),1)]),_:1})):D("",!0),n(d).curGroupDetail.masterId===n(A).userId?(s(),B(g,{key:1,content:`${G.$t("message.chat.group.js.tips")}`,type:"warning","ok-text":G.$t("message.chat.group.exit.ok"),"cancel-text":G.$t("message.chat.group.exit.cancel"),onOk:Z},{default:O(()=>[y(a,{type:"primary",status:"danger"},{default:O(()=>[e("span",null,h(G.$t("message.chat.group.js.btn")),1)]),_:1})]),_:1},8,["content","ok-text","cancel-text"])):(s(),B(g,{key:2,content:`${G.$t("message.chat.group.exit.tips")}`,type:"warning","ok-text":G.$t("message.chat.group.exit.ok"),"cancel-text":G.$t("message.chat.group.exit.cancel"),onOk:V},{default:O(()=>[y(a,{type:"primary",status:"danger"},{default:O(()=>[e("span",null,h(G.$t("meeting.menu.btn.exit")),1)]),_:1})]),_:1},8,["content","ok-text","cancel-text"]))])])])}}});const qn=oe(Kn,[["__scopeId","data-v-5413673f"]]),Xn={class:"transfer-modal-container"},Wn=["src"],eo={class:"transfer-m-t"},to={class:"transfer-m-s"},so={class:"transfer-m-m wsl-scroll"},no=["onClick"],oo={class:"transfer-m-m-i-l"},ao=["src"],ro={class:"transfer-m-m-i-r"},io={class:"transfer-m-m-i-rl"},lo=["src"],co={class:"transfer-m-m-i-rr"},uo={class:"transfer-m-m-i-rr-t"},mo={class:"transfer-m-m-i-rr-b"},po={class:"transfer-m-b"},vo={class:"transfer-m-b-l"},_o=["src"],go={class:"transfer-m-b-r"},ho=ae({__name:"transfer",props:{members:{}},emits:["handleClose","handleSureTransfer"],setup(Q,{emit:$}){const T=me(),d=$,{t:A}=ue.exports.useI18n(),m=()=>{d("handleClose")},M=Q,u=C([]),t=r=>u.value.some(_=>_.userId===r),i=r=>{u.value=[r]},v=C(20),U=r=>({zIndex:r,left:`${r*v.value}px`}),N=C([]),R=C({condition:""}),P=()=>{if(!R.value.condition)return M.members;const r=R.value.condition.toLowerCase();return M.members.filter(_=>_.name.toLowerCase().includes(r))},V=()=>{console.log("\u67E5\u8BE2\u4EBA\u5458\u4E8B\u4EF6"),N.value=P()},Z=r=>{const _=C("");return r.pcOnline||r.androidOnline||r.glassOnline?_.value="online":_.value="outline",_.value},G=r=>{const _=C("");switch(r.role){case 1:_.value=A("meeting.invite.psn.type.normal");break;case 2:_.value=A("meeting.invite.psn.type.product");break;case 3:_.value=A("meeting.invite.psn.type.technology");break;case 4:_.value=A("meeting.invite.psn.type.super");break}return _.value},S=()=>{d("handleSureTransfer",u.value)},p=()=>{u.value=[]};return ge(()=>{V()}),he(()=>{p()}),(r,_)=>{const J=we,a=$e;return s(),c("div",Xn,[e("div",{class:"transfer-fixed",onClick:m},[e("img",{src:n(Ae),alt:""},null,8,Wn)]),e("div",eo,h(r.$t("message.chat.group.transfer.title")),1),e("div",to,[y(a,{modelValue:R.value.condition,"onUpdate:modelValue":_[0]||(_[0]=g=>R.value.condition=g),class:"search-input",onInput:V},{prefix:O(()=>[y(J)]),_:1},8,["modelValue"])]),e("div",so,[(s(!0),c(F,null,W(N.value,(g,k)=>(s(),c("div",{key:`invite_psn_${k}_${g.userId}`,class:"transfer-m-m-i",onClick:f=>i(g)},[e("div",oo,[e("img",{src:t(g.userId)?n(qe):n(Ke),alt:"avatar"},null,8,ao)]),e("div",ro,[e("div",io,[e("img",{src:g.avatarUrl,alt:""},null,8,lo),e("div",{class:se(["transfer-m-m-i-rl-s",Z(g)])},null,2)]),e("div",co,[e("div",uo,[e("span",null,h(g.name),1)]),e("div",mo,[e("span",null,h(G(g)),1)])])])],8,no))),128))]),e("div",po,[e("div",vo,[(s(!0),c(F,null,W(u.value,(g,k)=>(s(),c(F,{key:`invite_m_icon_${k}`},[k<n(T).limitMember?(s(),c("div",{key:0,class:"transfer-m-b-l-i",style:Ee(U(k))},[e("img",{src:g.avatarUrl,alt:""},null,8,_o)],4)):D("",!0)],64))),128))]),e("div",go,[e("div",{class:"transfer-m-b-r-btn",onClick:S},[e("span",null,h(n(A)("message.chat.group.transfer.btn")),1)])])])])}}});const fo=oe(ho,[["__scopeId","data-v-79a04b20"]]),bo={key:0,class:"detail-panel"},Io={class:"detail-panel-top"},yo={class:"detail-panel-top-title"},Co={class:"detail-panel-top-title-left"},$o=["src"],Ao={class:"detail-panel-top-title-right textEllipsis"},Mo={key:0,class:"detail-panel-top-title-right"},Go={class:"detail-panel-top-btn"},To={class:"detail-panel-main"},ko={class:"detail-panel-main-left"},No={class:"chat-c-m-i-i-l"},So=["src"],Eo={class:"chat-c-m-i-r"},wo={class:"chat-c-m-i-r-t"},Uo={class:"name"},Do={class:"time"},Oo={class:"chat-c-m-i-r-m"},Ro={key:0,class:"chat-c-m-i-r-m-l"},Bo={key:1,class:"chat-c-m-i-r-m-l"},Lo={class:"chat-c-m-i-r-m-b"},Ho={key:0,class:"detail-panel-main-left-send"},xo={key:1,class:"detail-panel-main-left-no"},Po={key:0,class:"detail-panel-main-right"},Vo={key:1,class:"no-data"},Fo={class:"no-data-body"},Qo=["src"],jo={class:"no-data-body-text"},Jo="ChatDB",Yo=ae({__name:"detail",setup(Q){const{addMessage:$,getAllMessages:T,updateMessageByFingerPrint:d,updateConversations:A}=Je(Jo),m=dt(),M=ut(),u=me(),t=Se(),i=Ye(),v=mt(),{locale:U,t:N}=ue.exports.useI18n(),R=o=>JSON.parse(o),P=C(null),V=$t(()=>t.messageList),Z=async o=>{o||await St(1e3*.5),kt(()=>{P.value&&P.value.scrollTo({top:P.value.scrollHeight,behavior:"smooth"})})},G=async()=>{if(!t.curConversation||!t.curConversation.conversationId)return;const o=await T(t.curConversation.conversationId);o.forEach(l=>{l.status===1&&d(l.fingerPrint,{...l,status:2})}),t.updateMessageList(Ne(o)),Z()},S=o=>{const l=ye(),b=ye(o),E=b.format("YYYY-MM-DD HH:mm");return b.isSame(l,"day")?`${N("today")} ${b.format("HH:mm")}`:b.isSame(l.add(1,"day"),"day")?`${N("tomorrow")} ${b.format("HH:mm")}`:b.isSame(l.subtract(1,"day"),"day")?`${N("yesterday")} ${b.format("HH:mm")}`:E},p=C(""),r=async()=>{try{if(p.value.trim()!==""){const o=pt(),l=Date.now(),b={fingerPrint:o,chatType:t.curConversation.chatType,recipientId:t.curConversation.targetId,name:i.name,avatarUrl:i.avatarUrl,parentId:`${t.curConversation.chatType}_${t.curConversation.targetId}`,senderId:i.userId,messageType:Ie.TEXT,content:p.value.trim(),sendTime:l,status:1};await $(b,!1),H.emit("ChatSendMessage",{fingerPrint:o,recipientId:t.curConversation.targetId,chatType:t.curConversation.chatType,messageType:Ie.TEXT,content:p.value.trim()}),p.value="",H.emit("send-refresh-chat-room"),Z(!0)}}catch(o){console.error("Error adding chat session:",o)}},_=Nt(r,1e3),J=o=>{o.key==="Enter"&&o.ctrlKey?p.value+=`
`:o.key==="Enter"&&(o.preventDefault(),r())},a=C(!1),g=C(!1),k=()=>{m.updateRoomOptions(null),m.updateRoomInvitePsn(null),a.value=!1},f=o=>{a.value=!0,m.updateRoomInvitePsn(o),m.updateRoomOptions({meetingName:`${i.name} ${N("meeting.room.option.meetingName")}`,video:!1,audio:!0,loudspeaker:!0,cloudRecord:!1,escaping:!1,abstract:!1,organizer:i.name})},I=async o=>{var l,b,E,q;try{const z=await m.ThImEvent.joinMeeting({meetingNo:o.meetingNo,forceEntryStatus:0,inviters:X(m.roomInvitePsn,"userId")});if(M.updateRoomTranslateInfo({...M.roomTranslateInfo,...z.data,open:!!((l=z.data)!=null&&l.enableTranslation)}),v.updateBtnLoading(!1),z.code!==200&&z.code!==401){z.code===Fe.OTHER_CLIENT_JOINED_MEETING||z.code===Fe.OTHER_CLIENT_IN_MEETING?H.emit("Chat-Other-Client-Joined-Meeting"):x.error(z.msg);return}m.ThImEvent.roomMenuOptions={video:(b=m.roomOptions)==null?void 0:b.video,audio:(E=m.roomOptions)==null?void 0:E.audio,loudspeaker:(q=m.roomOptions)==null?void 0:q.loudspeaker},m.ThImEvent.setRoomOnlineListPsn(u.memberList),m.ThImEvent.setRoomOnlineGroupPsn(u.memberGroupList),k(),m.updateAssistVisible(!0)}catch{v.updateBtnLoading(!1)}},re=async()=>{var o,l,b,E,q,z,fe;try{const de=await m.createRealtimeMeeting({aiStatus:(o=m.roomOptions)!=null&&o.abstract?"1":"0",recordStatus:(l=m.roomOptions)!=null&&l.cloudRecord?"1":"0",escaping:(b=m.roomOptions)!=null&&b.escaping?"1":"0",subject:(E=m.roomOptions)==null?void 0:E.meetingName,userIds:X(m.roomInvitePsn,"userId"),enableTranslation:(q=m.roomOptions)!=null&&q.escaping?"1":"0",languageType:(z=M.roomTranslateInfo)==null?void 0:z.languageType,industryType:(fe=M.roomTranslateInfo)==null?void 0:fe.industryType});if(de.code!==200&&de.code!==401){v.updateBtnLoading(!1),x.error(de.msg);return}I(de.data)}catch{v.updateBtnLoading(!1)}},Me=()=>{if(m.answerInfo&&m.answerInfo.meetingNo){x.error(N("meeting.call.message.tips"));return}t.curConversation.chatType===ee.PRIVATE_CHAT?f([{userId:t.curConversation.targetId,name:t.curConversation.name}]):t.curConversation.chatType===ee.GROUP_CHAT&&(g.value=!0)},L=()=>{g.value=!1},K=o=>{L(),f(o)},j=C(null),ie=C(null),ne=C(!1),pe=C(!0),te=async()=>{if(await G(),!t.curConversation||t.curConversation.chatType!==ee.GROUP_CHAT)return;const o=await t.getGroupDetail({groupId:t.curConversation.targetId});if(o.code!==200&&o.code!==401){x.error(o.msg),o.code===20201&&(pe.value=!1);return}o.data.status===1?pe.value=!1:pe.value=!0;const l=o.data.members;await u.memberList.forEach(b=>{const E=l.find(q=>q.userId===b.userId);E&&(E.pcOnline=b.pcOnline,E.glassOnline=b.glassOnline,E.androidOnline=b.androidOnline)}),l.sort((b,E)=>{const q=b.pcOnline||b.glassOnline||b.androidOnline?1:0;return(E.pcOnline||E.glassOnline||E.androidOnline?1:0)-q}),t.updateCurGroupDetail({...o.data,members:l})},Ue=()=>{t.curConversation.chatType!==ee.GROUP_CHAT?(j.value=u.memberList,ie.value=u.memberGroupList):t.curGroupDetail&&t.curGroupDetail.members?(j.value=u.filterMembersNotInList(t.curGroupDetail.members,u.memberList),ie.value=u.filterMembersNotInGroups(t.curGroupDetail.members,u.memberGroupList)):(j.value=u.memberList,ie.value=u.memberGroupList),ne.value=!0},ve=()=>{ne.value=!1,j.value=null,ie.value=null},Xe=async o=>{if(t.curConversation.chatType===ee.GROUP_CHAT){const l=await t.inviteGroupMember({groupId:t.curGroupDetail.groupId,userIds:X(o,"userId")});if(l.code!==200&&l.code!==401){x.error(l.msg);return}te(),ve()}else if(o.length>0){let b=X(o,"name").join("\u3001");b=b.length>50?`${b.substring(0,46)}...`:b;const E=await t.createGroup({groupName:b,userIds:X(o,"userId")});if(E.code!==200&&E.code!==401){x.error(E.msg);return}x.success(N("meeting.member.create.group.success")),t.updateCurConversation({targetId:E.data.groupId,targetName:E.data.groupName,chatType:ee.GROUP_CHAT,conversationId:`${ee.GROUP_CHAT}_${E.data.groupId}`,targetAvatarUrl:E.data.avatarUrl}),te(),ve()}else x.warning(N("message.invite.join.group.select.psn.warning"))},We=async()=>{t.updateGroupChatSettingVisible(!0)},De=()=>{t.updateGroupChatSettingVisible(!1)},le=C(!1),et=()=>{le.value=!0},Ge=()=>{le.value=!1},tt=async o=>{const l=await t.removeGroupMember({groupId:t.curGroupDetail.groupId,userIds:X(o,"userId")});if(l.code!==200&&l.code!==401){x.error(l.msg);return}te(),Ge()},ce=C(!1),st=()=>{ce.value=!0},Te=()=>{ce.value=!1},nt=async o=>{const l=await t.transferGroupMaster({groupId:t.curGroupDetail.groupId,userId:o[0].userId});if(l.code!==200&&l.code!==401){x.error(l.msg);return}Te(),te()},ot=async()=>{const o=await t.leaveGroup({groupId:t.curGroupDetail.groupId});if(o.code!==200&&o.code!==401){x.error(o.msg);return}te(),ve(),H.emit("event-exit-group-chat")},at=async()=>{const o=await t.disbandGroup({groupId:t.curGroupDetail.groupId});if(o.code!==200&&o.code!==401){x.error(o.msg);return}H.emit("event-disband-group-chat")},Oe=(o,l)=>u.filterMemberInfoByUserId(o.senderId)[l],Re=async o=>{const{fp:l,status:b}=o;console.log("\u4F1A\u8BDD\u4E2D\u6D88\u606F\u72B6\u6001\u53D8\u66F4-handleChatMessageStatus",l,b),await d(l,{status:b?0:2}),G()},rt=()=>{H.on("group-info-change",te),H.on("ChatMessageStatus",Re)},it=()=>{H.off("group-info-change",te),H.off("ChatMessageStatus",Re)},lt=()=>{t.groupChatSettingVisible&&De(),a.value&&k(),g.value&&L(),ne.value&&ve(),le.value&&Ge(),ce.value&&Te()};return ge(()=>{console.log("\u8BE6\u60C5\u9875\u9762-updateConversations",t.curConversation),t.curConversation&&A({...Ne(t.curConversation),unreadCount:0}),te(),rt()}),he(()=>{lt(),it()}),ke(()=>U,()=>{G()},{deep:!0}),ke(()=>t.curConversation,()=>{console.log("\u76D1\u542C\u4F1A\u8BDD\u53D8\u66F4"),te()},{deep:!0}),(o,l)=>{const b=Ze,E=At,q=Ce,z=Mt,fe=vt,de=Gt,_e=Tt,ct=ze;return s(),B(ct,{bordered:!1,class:"message-detail-container","body-style":{padding:0,height:"100%"}},{default:O(()=>[n(t).curConversation?(s(),c("div",bo,[e("div",Io,[e("div",yo,[y(E,{size:16},{default:O(()=>{var w,be,Be,Le,He,xe,Pe;return[e("div",Co,[e("img",{src:n(t).curConversation.chatType!==ee.GROUP_CHAT?n(t).curConversation.targetAvatarUrl:(w=n(t).curGroupDetail)==null?void 0:w.avatarUrl,alt:""},null,8,$o)]),y(b,{position:"bottom",content:n(t).curConversation.chatType!==ee.GROUP_CHAT?n(t).curConversation.targetName:(be=n(t).curGroupDetail)==null?void 0:be.groupName},{default:O(()=>{var Ve;return[e("div",Ao,[e("span",null,h(n(t).curConversation.chatType!==ee.GROUP_CHAT?n(t).curConversation.targetName:(Ve=n(t).curGroupDetail)==null?void 0:Ve.groupName),1)])]}),_:1},8,["content"]),(Le=(Be=n(t))==null?void 0:Be.curGroupDetail)!=null&&Le.members?(s(),c("div",Mo,[e("span",null,h(n(t).curConversation.chatType===1?`(${(Pe=(xe=(He=n(t))==null?void 0:He.curGroupDetail)==null?void 0:xe.members)==null?void 0:Pe.length})`:""),1)])):D("",!0)]}),_:1})]),e("div",Go,[pe.value?(s(),B(E,{key:0,size:16},{default:O(()=>[y(b,{content:o.$t("meeting.tooltip.btn.send.meeting"),position:"bottom"},{default:O(()=>[e("div",{class:"detail-panel-top-btn-item",onClick:Me},[y(n(as),{class:"svg-icon"})])]),_:1},8,["content"]),y(b,{position:"bottom",content:n(t).curConversation.chatType===1?o.$t("meeting.tooltip.btn.invite.member"):n(N)("message.chat.room.message.tips.create.group1")},{default:O(()=>[e("div",{class:"detail-panel-top-btn-item",onClick:Ue},[y(n(ls),{class:"svg-icon"})])]),_:1},8,["content"]),n(t).curConversation.chatType===1?(s(),B(b,{key:0,content:o.$t("meeting.tooltip.btn.group.setting"),position:"bottom"},{default:O(()=>[e("div",{class:"detail-panel-top-btn-item",onClick:We},[y(n(us),{class:"svg-icon"})])]),_:1},8,["content"])):D("",!0)]),_:1})):D("",!0)])]),y(q,{margin:0}),e("div",To,[e("div",ko,[e("div",{ref_key:"chatContainer",ref:P,class:"detail-panel-main-left-body wsl-scroll"},[(s(!0),c(F,null,W(V.value,(w,be)=>(s(),c("div",{key:be,class:se(["chat-c-m-i",w.senderId==n(i).userId?"my-message":"other-message"])},[w.messageType===Ie.SYSTEM?(s(),B(bs,{key:0,message:R(w.content)},null,8,["message"])):(s(),c(F,{key:1},[e("div",No,[e("img",{src:Oe(w,"avatarUrl"),alt:"avatar",class:"avatar"},null,8,So)]),e("div",Eo,[e("div",wo,[e("span",Uo,h(Oe(w,"name")),1),e("span",Do,h(S(w.sendTime)),1)]),e("div",Oo,[w.status===1?(s(),c("div",Ro,[y(z)])):D("",!0),w.status===2?(s(),c("div",Bo,[y(fe,{color:"red"})])):D("",!0),e("div",Lo,h(w.content),1)])])],64))],2))),128))],512),pe.value?(s(),c("div",Ho,[y(de,{modelValue:p.value,"onUpdate:modelValue":l[0]||(l[0]=w=>p.value=w),"auto-size":{minRows:2,maxRows:2},"max-length":n(v).textInputMaxLength,class:"ChatMessageSendTextarea",placeholder:o.$t("message.chat.text.placeholder"),onKeydown:J},null,8,["modelValue","max-length","placeholder"]),e("div",{class:"detail-panel-main-left-send-btn",onClick:l[1]||(l[1]=(...w)=>n(_)&&n(_)(...w))},[y(n(_s))])])):(s(),c("div",xo,[e("span",null,h(o.$t("message.chat.room.send.area.no")),1)]))]),y(q,{direction:"vertical",margin:0}),n(t).groupChatSettingVisible?(s(),c("div",Po,[y(qn,{onHandleClose:De,onHandleRemoveGroup:et,onHandleInviteJoinGroup:Ue,onHandleTransferOpen:st,onHandleSureExitGroup:ot,onHandleSureDisbandGroup:at})])):D("",!0)])])):(s(),c("div",Vo,[e("div",Fo,[e("img",{src:n(ms),alt:""},null,8,Qo),e("div",jo,h(o.$t("message.chat.detail.no.data")),1)])])),a.value?(s(),B(_e,{key:2,visible:a.value,"onUpdate:visible":l[2]||(l[2]=w=>a.value=w),footer:!1,closable:!1,class:"customModal"},{default:O(()=>[y(Et,{onHandleCall:re,onHandleClose:k})]),_:1},8,["visible"])):D("",!0),g.value?(s(),B(_e,{key:3,visible:g.value,"onUpdate:visible":l[3]||(l[3]=w=>g.value=w),footer:!1,closable:!1,class:"customModal"},{default:O(()=>[g.value?(s(),B(Dt,{key:0,"select-psn":[{userId:n(i).userId,name:n(i).name,avatarUrl:n(i).avatarUrl}],onHandleInvite:K,onHandleClose:L},null,8,["select-psn"])):D("",!0)]),_:1},8,["visible"])):D("",!0),ne.value?(s(),B(_e,{key:4,visible:ne.value,"onUpdate:visible":l[4]||(l[4]=w=>ne.value=w),footer:!1,closable:!1,class:"customModal"},{default:O(()=>[ne.value?(s(),B(yn,{key:0,members:j.value,"group-members":ie.value,onHandleInvite:Xe,onHandleClose:ve},null,8,["members","group-members"])):D("",!0)]),_:1},8,["visible"])):D("",!0),le.value?(s(),B(_e,{key:5,visible:le.value,"onUpdate:visible":l[5]||(l[5]=w=>le.value=w),footer:!1,closable:!1,class:"customModal"},{default:O(()=>[le.value?(s(),B(Hs,{key:0,members:n(t).curGroupDetail.members,onHandleSureRemove:tt,onHandleClose:Ge},null,8,["members"])):D("",!0)]),_:1},8,["visible"])):D("",!0),ce.value?(s(),B(_e,{key:6,visible:ce.value,"onUpdate:visible":l[6]||(l[6]=w=>ce.value=w),footer:!1,closable:!1,class:"customModal"},{default:O(()=>[ce.value?(s(),B(fo,{key:0,members:n(t).curGroupDetail.members,onHandleSureTransfer:nt,onHandleClose:Te},null,8,["members"])):D("",!0)]),_:1},8,["visible"])):D("",!0)]),_:1})}}});const zo=oe(Yo,[["__scopeId","data-v-b84d53c3"]]),Zo={class:"container"},Ko={class:"layout"},qo={class:"layout-left-side"},Xo={class:"layout-content"},Wo=ae({__name:"index",setup(Q){return($,T)=>{const d=Ce;return s(),c("div",Zo,[e("div",Ko,[e("div",qo,[y(ss)]),y(d,{direction:"vertical",style:{margin:0}}),e("div",Xo,[y(zo)])])])}}});const ca=oe(Wo,[["__scopeId","data-v-e8a9eebc"]]);export{ca as default};
