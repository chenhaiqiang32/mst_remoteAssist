var ks=Object.defineProperty;var Os=(e,t,o)=>t in e?ks(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var q=(e,t,o)=>(Os(e,typeof t!="symbol"?t+"":t,o),o);import{u as Xe,j as Io,E as c,P as Y,k as P,A as St,L as T,l as Rs,T as Ns,m as Ls,K as Ps,U as Us,n as Ds,G as xs,C as J,M as Le,o as js,p as Bs,q as ve,r as Gs,t as Fs,w as Vs,x as Hs,y as Ws,H as jn,z as ye,B as Bn,D as Gn,F as Fn,I as Vn,J as Hn,N as qs,O as zs,Q as je,v as Ee,i as Ue,R as To,_ as ce,d as xt,S as wo,V as Js,e as Ot,W as Ks,X as Qs,Y as Zs,Z as Ys,$ as Xs,a0 as ea,a1 as ta,a2 as jt,a3 as na,a4 as oa,a5 as sa,a6 as aa,a7 as ra,a8 as ia,a9 as ca,aa as la,ab as Eo,ac as So,f as ua,ad as da,ae as fa,g as Mt,af as pa,ag as ha,ah as ma,ai as Pe,aj as ga,ak as j,al as lt,am as $t,a as Wn,b as qn,c as zn,an as Jn,ao as va}from"./index.9499b39e.js";/* empty css              */import{C as E,D as H,E as i,H as _a,c as G,d as ae,j as N,aI as p,bm as ba,bn as Mo,h as Ca,bo as ya,bp as Ia,bq as Ta,b as dt,u as M,aN as $,aH as v,aM as oe,aW as F,bj as wa,bc as Ea,bd as Sa,aX as De,i as Ma,w as $o,aE as B,aF as z,aK as Je,aJ as Rt,F as Bt,Q as $a,b8 as Ao,b9 as ko,br as Oo,bs as Ro,bt as Aa,bu as ka,be as No,a$ as Gt,b0 as Ft,b2 as Lo,b3 as Po,a0 as Oa,bv as Ra,b4 as Na,a2 as La,bw as Pa,bx as Ua,o as et,by as Da,bh as xa,bz as Ke,bA as ja,bB as Ba,p as Ga,G as Kn,bC as Ie,bD as Fa,aZ as Va,bE as Ha,bF as Wa}from"./arco.638965b6.js";import{f as tt,g as Uo,i as qa}from"./vue.125da600.js";import{i as nt,b as ot,r as le,a as st,f as za,S as Qn,c as Ja,o as Ka,d as Qa,e as Do,g as Za}from"./icon_volume_1.fb774a2c.js";import{l as Ya,j as Xa}from"./html2canvas.esm.25c8c7a9.js";import{l as er}from"./logo.fa0f260a.js";import{c as xo}from"./icon_close.f7fee805.js";import"./chart.ffc0c533.js";function jo(){const e=tt(),t=Xe();return{logout:async s=>{await t.logout();const a=e.currentRoute.value;Io(),e.push({name:s&&typeof s=="string"?s:"login",query:{...e.currentRoute.value.query,redirect:a.name}}),window.location.reload()}}}const tr={width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},nr=i("rect",{width:"56",height:"56",rx:"8",fill:"#0267FF"},null,-1),or=i("path",{d:"m28.065 31.061-2.238 1.965a1.48 1.48 0 0 1-.121 2.102l-5.597 4.91a1.509 1.509 0 0 1-2.117-.136l-3.994-4.478a1.48 1.48 0 0 1 .12-2.102l5.597-4.91a1.51 1.51 0 0 1 2.118.136l2.239-1.964-.999-1.12c-1.103-1.236-2.999-1.36-4.235-.274l-7.835 6.876a2.96 2.96 0 0 0-.242 4.203l5.99 6.717c1.104 1.236 3 1.36 4.236.274l7.835-6.876a2.96 2.96 0 0 0 .242-4.203l-.999-1.12Zm17.719-5.69-3.344-8.368c-.615-1.54-2.355-2.306-3.887-1.71l-9.704 3.774c-1.53.596-2.273 2.327-1.658 3.867l.557 1.395 2.773-1.079a1.478 1.478 0 0 1 .83-1.933l6.93-2.696a1.511 1.511 0 0 1 1.944.855l2.229 5.579a1.477 1.477 0 0 1-.83 1.933l-6.93 2.696a1.511 1.511 0 0 1-1.944-.855l-2.773 1.078.558 1.395c.615 1.54 2.355 2.306 3.886 1.71l9.705-3.774c1.53-.596 2.273-2.327 1.658-3.867ZM21.59 32.75c.552.619 1.5.68 2.118.138l3.398-2.982-2.031-2.21-3.364 2.953a1.48 1.48 0 0 0-.12 2.102Zm11.988-5.856a1.478 1.478 0 0 0 .83-1.933 1.511 1.511 0 0 0-1.944-.856l-4.126 1.605 1.035 2.82 4.205-1.636Zm-5.287-14.252L27.012 12l-1.755 4.747 1.28.642 1.755-4.746Zm-7.508 9.286-.293-1.498-6.337 1.227.291 1.499 6.34-1.228Zm2.015-4.074-2.662-5.037-1.305.814 2.661 5.037 1.306-.814Z",fill:"#fff"},null,-1),sr=[nr,or];function ar(e,t){return E(),H("svg",tr,[...sr])}const rr={render:ar},ir={width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},cr=_a('<rect width="56" height="56" rx="8" fill="#FF3939"></rect><g fill="#fff"><path d="M28 10c9.941 0 18 8.059 18 18s-8.059 18-18 18-18-8.059-18-18 8.059-18 18-18Zm0 2.667c-8.468 0-15.333 6.865-15.333 15.333S19.532 43.333 28 43.333 43.333 36.468 43.333 28 36.468 12.667 28 12.667Z"></path><path d="M36.6 19.276c.629.629.629 1.257 0 1.886L21.162 36.6c-.629.629-1.257.629-1.886 0-.628-.628-.628-1.257 0-1.885l15.439-15.439c.628-.628 1.257-.628 1.885 0Z"></path><path d="M19.276 19.276c.629-.628 1.257-.628 1.886 0L36.6 34.715c.629.628.629 1.257 0 1.885-.628.629-1.257.629-1.885 0L19.276 21.162c-.628-.629-.628-1.257 0-1.886Z"></path></g>',2),lr=[cr];function ur(e,t){return E(),H("svg",ir,[...lr])}const dr={render:ur},fr={height:"56",viewBox:"0 0 56 56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},pr=i("circle",{cx:"28",cy:"28",r:"28",fill:"#FF1500"},null,-1),hr=i("path",{d:"M25.607 34a2.432 2.432 0 0 0 4.79 0l1.596-22a4.012 4.012 0 0 0-1.171-2.826A3.996 3.996 0 0 0 28.002 8a4.095 4.095 0 0 0-2.935 1.345A4.112 4.112 0 0 0 24.01 12.4L25.607 34Zm2.395 6a3.986 3.986 0 0 0-3.688 2.47 4.008 4.008 0 0 0 .865 4.358A3.988 3.988 0 0 0 31.993 44a3.786 3.786 0 0 0-1.098-2.9 3.77 3.77 0 0 0-2.893-1.1Z",fill:"#fff"},null,-1),mr=[pr,hr];function gr(e,t){return E(),H("svg",fr,[...mr])}const vr={render:gr};class _r{constructor(t){q(this,"websocket",null);q(this,"reconnectTimeout");q(this,"retryCount",0);q(this,"maxRetries",30);q(this,"initialReconnectDelay",3e3);q(this,"maxReconnectDelay",6e4);q(this,"wsUrl");q(this,"isConnected",!1);q(this,"isReConnect",!0);this.wsUrl=t,this.connect()}connect(){this.websocket||(console.log("222222222wsUrl>>>>",this.wsUrl),this.websocket=new WebSocket(this.wsUrl),this.websocket.binaryType="arraybuffer",this.websocket.addEventListener("open",this.onOpen.bind(this)),this.websocket.addEventListener("message",this.onMessage.bind(this)),this.websocket.addEventListener("close",this.onClose.bind(this)),this.websocket.addEventListener("error",this.onError.bind(this)))}onOpen(){console.log("\u5373\u65F6\u901A\u8BAF-WebSocket-websocketService connection open"),this.isConnected=!0,this.retryCount=0,this.clearReconnectTimeout(),c.emit("im-ws-open")}onMessage(t){const o=new Uint8Array(t.data);c.emit("im-ws-message",{data:o,_self:this})}onClose(t){console.log(`IM-Connection closed with code: ${t.code}`),this.isReConnect&&this.reconnect()}onError(t){console.error("IM-WebSocket error",t),c.emit("im-ws-error",{error:t,event:this})}reconnect(){if(!this.isReConnect){console.log("Max retries reached or reconnection is disabled.");return}if(console.log(`IM WebSocket reconnecting in ${this.initialReconnectDelay} ms... \u91CD\u8BD5\u6B21\u6570\uFF1A`,this.retryCount),this.retryCount>this.maxRetries){this.stopReconnect(),c.emit("im-ws-reconnect-failed");return}this.websocket=null,c.emit("im-ws-reconnect-start",{retryCount:this.retryCount}),this.reconnectTimeout=window.setTimeout(()=>{this.retryCount+=1,this.connect()},this.initialReconnectDelay)}stopReconnect(){console.log("IM WebSocket stop reconnect"),this.isReConnect=!1,this.retryCount=0,this.clearReconnectTimeout()}clearReconnectTimeout(){this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0)}sendMessage(t){this.websocket&&this.isConnected?this.websocket.send(t):console.warn("WebSocket is not connected. Message not sent.",t)}close(){console.log("IM WebSocket close"),this.stopReconnect(),this.websocket&&(this.websocket.close(),this.websocket=null)}}const br=e=>new _r(e);class Cr{constructor(t){q(this,"webSocketService",null);q(this,"wssUrl");q(this,"userId");q(this,"token");q(this,"intervalHeart",null);q(this,"lastLoginTime");q(this,"messageMap",new Map);const{wssUrl:o,userId:s,token:a}=t;this.wssUrl=o,this.userId=s,this.token=a,this.handleChatWsOpen=this.handleChatWsOpen.bind(this),this.handleChatWsMessage=this.handleChatWsMessage.bind(this),this.handleChatWsClose=this.handleChatWsClose.bind(this),this.handleChatWsError=this.handleChatWsError.bind(this)}handleChatWsOpen(){c.emit("ChatWsOpen","Chat WebSocket connection opened")}handleChatWsMessage(t){const{data:o}=t;console.log("chat-message--handleChatWsMessage",o);const s=Y.decode(o);if(P.ACK===s.type){const a=St.decode(s.event),l=this.messageMap.get(a.fp);console.log("ChatPB.EventType.ACK",l),l&&(this.messageMap.delete(a.fp),c.emit("ChatMessageStatus",{fp:a.fp,status:!0}))}if(P.ACK!==s.type&&P.HEARTBEAT_PONG!==s.type&&this.sendAckMessage({fp:s.fp,timestamp:T.fromValue(s.timestamp).toNumber()}),P.LOGIN_SUCCEED===s.type){const a=Rs.decode(s.event);this.lastLoginTime=T.fromValue(a.lastLoginTime).toNumber(),console.log("\u5373\u65F6\u901A\u8BAF-websocket-\u767B\u5F55\u6210\u529F-\u670D\u52A1\u7AEF\u8FD4\u56DE\u503C",{...a,lastLoginTime:T.fromValue(a.lastLoginTime).toNumber()}),c.emit("ChatLoginSuccess",{...a,lastLoginTime:T.fromValue(a.lastLoginTime).toNumber()}),this.heartInterval()}if(P.TOKEN_EXPIRATION_DATE===s.type){const a=Ns.decode(s.event);console.log("\u63A5\u6536\u5230Token\u4E8B\u4EF6-TOKEN_EXPIRATION_DATE",a),c.emit("ChatTokenExpirationDate",a)}if(P.LOGOUT_SUCCEED===s.type){const a=Ls.decode(s.event);console.log("\u63A5\u6536\u5230\u767B\u51FA\u6210\u529F\u4E8B\u4EF6-LOGOUT_SUCCEED",a),c.emit("ChatLogoutSucceed",a)}if(P.KICK_OUT===s.type){const a=Ps.decode(s.event);console.log("\u8E22\u4E0B\u7EBF\u4E8B\u4EF6-KICK_OUT",a),c.emit("ChatKickOut",a)}if(P.CONTACT_UPDATED===s.type&&(console.log("\u901A\u8BAF\u5F55\u53D1\u751F\u53D8\u5316-CONTACT_UPDATED",s),c.emit("ChatContactUpdated")),P.CHAT_USER_ONLINE===s.type){const a=Us.decode(s.event);c.emit("ChatUserOnline",{client:a.client,userId:T.fromValue(a.userId).toNumber()})}if(P.CHAT_USER_OFFLINE===s.type){const a=Ds.decode(s.event);console.log("\u7528\u6237\u4E0B\u7EBF-CHAT_USER_OFFLINE",a,{client:a.client,userId:T.fromValue(a.userId).toNumber()}),c.emit("ChatUserOffline",{client:a.client,userId:T.fromValue(a.userId).toNumber()})}if(P.CHAT_GROUP_CREATED===s.type){const a=xs.decode(s.event);console.log("\u7FA4\u7EC4\u521B\u5EFA\u4E8B\u4EF6-CHAT_GROUP_CREATED-dataContent",a);const l=[];a.userIds.forEach(m=>{l.push(T.fromValue(m).toNumber())});const d={eventType:s.type,eventData:{...a,groupId:T.fromValue(a.groupId).toNumber(),masterId:T.fromValue(a.masterId).toNumber(),timestamp:T.fromValue(a.timestamp).toNumber(),userIds:l}};c.emit("GroupCreatedEvent",{fp:s.fp,targetId:T.fromValue(a.groupId).toNumber(),chatType:J.GROUP_CHAT,targetAvatarUrl:a.avatarUrl,targetName:a.groupName,name:"",messageType:Le.SYSTEM,content:JSON.stringify(d),sendTime:T.fromValue(a.timestamp).toNumber(),unreadCount:0})}if(P.CHAT_GROUP_INFO_UPDATED===s.type){const a=js.decode(s.event);console.log("\u7FA4\u7EC4\u4FE1\u606F\u66F4\u65B0\u4E8B\u4EF6-CHAT_GROUP_INFO_UPDATED",a),c.emit("GroupChatGroupInfoUpdated",{...a,groupId:T.fromValue(a.groupId).toNumber()})}if(P.CHAT_GROUP_MEMBER_REMOVED===s.type){const a=Bs.decode(s.event);console.log("\u7FA4\u7EC4\u6210\u5458\u8E22\u51FA\u4E8B\u4EF6-CHAT_GROUP_MEMBER_REMOVED-dataContent",a);const l=[];a.removedUserIds.forEach(m=>{l.push(T.fromValue(m).toNumber())});const d={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),masterId:T.fromValue(a.masterId).toNumber(),removedUserIds:l}};c.emit("ChatGroupMemberRemoved",{fingerPrint:s.fp,chatType:J.GROUP_CHAT,content:JSON.stringify(d),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${J.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(P.CHAT_GROUP_MEMBER_INVITED===s.type){const a=Gs.decode(s.event);console.log("\u7FA4\u7EC4\u9080\u8BF7\u6210\u5458\u4E8B\u4EF6-CHAT_GROUP_MEMBER_INVITED",a);const l=[];a.invitedUserIds.forEach(m=>{l.push(T.fromValue(m).toNumber())});const d={eventType:s.type,eventData:{...a,timestamp:T.fromValue(a.timestamp).toNumber,groupId:T.fromValue(a.groupId).toNumber(),groupName:a.groupName,inviteeUserIds:l,invitorUserId:T.fromValue(a.invitorUserId).toNumber()}};c.emit("ChatGroupMemberInvited",{fingerPrint:s.fp,chatType:J.GROUP_CHAT,content:JSON.stringify(d),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${J.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(P.CHAT_GROUP_MASTER_CHANGED===s.type){const a=Fs.decode(s.event);console.log("\u7FA4\u4E3B\u53D8\u66F4\u4E8B\u4EF6-CHAT_GROUP_MASTER_CHANGED",a);const l={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),newMasterId:T.fromValue(a.newMasterId).toNumber(),oldMasterId:T.fromValue(a.oldMasterId).toNumber()}};c.emit("ChatGroupMasterChanged",{fingerPrint:s.fp,chatType:J.GROUP_CHAT,content:JSON.stringify(l),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${J.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(P.CHAT_GROUP_DISBANDED===s.type){const a=Vs.decode(s.event);console.log("\u7FA4\u89E3\u6563\u4E8B\u4EF6-CHAT_GROUP_DISBANDED",a);const l={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),masterId:T.fromValue(a.masterId).toNumber(),timestamp:T.fromValue(a.timestamp).toNumber()}};c.emit("ChatGroupDisbanded",{fingerPrint:s.fp,chatType:J.GROUP_CHAT,content:JSON.stringify(l),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${J.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(P.CHAT_GROUP_MEMBER_QUIT===s.type){const a=Hs.decode(s.event);console.log("\u7FA4\u7EC4\u4EBA\u5458\u9000\u51FA-CHAT_GROUP_MEMBER_QUIT-dataContent",a);const l={eventType:s.type,eventData:{groupId:T.fromValue(a.groupId).toNumber(),quitUserId:T.fromValue(a.quitUserId).toNumber(),timestamp:T.fromValue(a.timestamp).toNumber()}};c.emit("ChatGroupMemberQuit",{fingerPrint:s.fp,chatType:J.GROUP_CHAT,content:JSON.stringify(l),messageType:Le.SYSTEM,recipientId:T.fromValue(a.groupId).toNumber(),senderId:ve.SERVER,sendTime:T.fromValue(a.timestamp).toNumber(),parentId:`${J.GROUP_CHAT}_${T.fromValue(a.groupId).toNumber()}`})}if(P.CHAT_MESSAGE_RECEIVED===s.type){const a=Ws.decode(s.event);console.log("\u6D88\u606F\u63A5\u6536\u4E8B\u4EF6-CHAT_MESSAGE_RECEIVED",a),this.sendAckMessage({fp:s.fp,timestamp:T.fromValue(a.timestamp).toNumber()}),c.emit("ChatMessageReceive",{fingerPrint:s.fp,chatType:a.chatType,content:a.content,messageType:a.messageType,recipientId:T.fromValue(a.recipientId).toNumber(),senderId:T.fromValue(a.senderId).toNumber(),sendTime:T.fromValue(a.timestamp).toNumber()})}}handleChatWsError(t){this.clearHeartInterval(),c.emit("ChatWsError",t)}handleChatWsClose(t){console.log("ChatWebSocket \u8FDE\u63A5\u5DF2\u5173\u95ED",t,this),this.clearHeartInterval(),c.emit("ChatWsClose","Chat WebSocket connection closed")}clearHeartInterval(){this.intervalHeart&&clearInterval(this.intervalHeart)}heartInterval(){this.intervalHeart=setInterval(()=>{if(!this.webSocketService){this.clearHeartInterval();return}const t=Date.now(),o=jn.create(),s=jn.encode(o).finish(),a=Y.create({type:P.HEARTBEAT_PING,fp:ye(),event:s,timestamp:t}),l=Y.encode(a).finish();this.webSocketService.sendMessage(l)},1e3*30)}login(){var d;let t;this.lastLoginTime?t=this.lastLoginTime:t=Date.now(),console.log("Chat-login----lastLoginTime",this.lastLoginTime);const o=Bn.create({userId:this.userId,client:ve.PC,token:this.token,lastLoginTime:t}),s=Bn.encode(o).finish(),a=Y.create({type:P.LOGIN_REQUEST,fp:ye(),event:s,timestamp:t}),l=Y.encode(a).finish();(d=this.webSocketService)==null||d.sendMessage(l)}refreshToken(t){console.log("Chat-refresh-token",t);const o=Date.now(),s=Gn.create({token:t.token}),a=Gn.encode(s).finish(),l=Y.create({type:P.TOKEN_REFRESH,fp:ye(),event:a,timestamp:o}),d=Y.encode(l).finish();this.webSocketService.sendMessage(d)}sendLogoutMessage(){const t=Date.now(),o=Fn.create(),s=Fn.encode(o).finish(),a=Y.create({type:P.LOGOUT_REQUEST,fp:ye(),event:s,timestamp:t}),l=Y.encode(a).finish();this.webSocketService.sendMessage(l)}logout(){this.webSocketService&&(this.clearHeartInterval(),this.handleOffEventBus(),this.sendLogoutMessage(),this.webSocketService.close())}handleOnEventBus(){c.on("im-ws-open",this.handleChatWsOpen),c.on("im-ws-message",this.handleChatWsMessage),c.on("im-ws-close",this.handleChatWsClose),c.on("im-ws-error",this.handleChatWsError)}handleOffEventBus(){c.off("im-ws-open",this.handleChatWsOpen),c.off("im-ws-message",this.handleChatWsMessage),c.off("im-ws-close",this.handleChatWsClose),c.off("im-ws-error",this.handleChatWsError)}initChatWss(){this.webSocketService=br(this.wssUrl),this.webSocketService.connect(),this.handleOnEventBus()}chatWssReconnect(){this.webSocketService&&(this.webSocketService.stopReconnect(),this.initChatWss())}sendMessage(t){var g;const{fingerPrint:o,recipientId:s,chatType:a,messageType:l,content:d}=t,m=Date.now(),w=o||ye(),_=Vn.create({recipientId:s,chatType:a,messageType:l,content:d}),b=Vn.encode(_).finish(),S=Y.create({type:P.CHAT_MESSAGE_SEND,fp:w,event:b,timestamp:m}),O=Y.encode(S).finish();this.messageMap.set(w,{timestamp:m,retries:0,data:O}),(g=this.webSocketService)==null||g.sendMessage(O),this.retryMessage(w)}retryMessage(t){!this.messageMap.get(t)||setTimeout(()=>{const s=this.messageMap.get(t);if(!!s){if(s.retries>=3){this.messageMap.delete(t),c.emit("ChatMessageStatus",{fp:t,status:!1});return}console.log(`\u6B63\u5728\u91CD\u8BD5\u6D88\u606F ${t}, \u5C1D\u8BD5\u6B21\u6570 ${s.retries+1}`),this.webSocketService.sendMessage(s.data),this.messageMap.set(t,{...s,retries:s.retries+1}),this.retryMessage(t)}},3e3)}sendAckMessage(t){var m;const o=Date.now(),s=St.create(t),a=St.encode(s).finish(),l=Y.create({type:P.ACK,fp:ye(),event:a,timestamp:o}),d=Y.encode(l).finish();(m=this.webSocketService)==null||m.sendMessage(d)}sendChatReceivedMessageReadEvent(t){var m;const o=Date.now(),s=Hn.create(t),a=Hn.encode(s).finish(),l=Y.create({type:P.CHAT_MESSAGE_READ,fp:ye(),event:a,timestamp:o}),d=Y.encode(l).finish();(m=this.webSocketService)==null||m.sendMessage(d)}}function yr(){return{accessRouter(e){var t,o,s,a;return!((t=e.meta)!=null&&t.requiresAuth)||!((o=e.meta)!=null&&o.roles)||((a=(s=e.meta)==null?void 0:s.roles)==null?void 0:a.includes("*"))},findFirstPermissionRoute(e,t="admin"){var s,a;const o=[...e];for(;o.length;){const l=o.shift();if((a=(s=l==null?void 0:l.meta)==null?void 0:s.roles)!=null&&a.find(d=>d.includes("*")||d.includes(t)))return{name:l.name};l!=null&&l.children&&o.push(...l.children)}return null}}}const Ir=[...qs,...zs],Tr=Ir.map(e=>{const{name:t,path:o,meta:s,redirect:a,children:l}=e;return{name:t,path:o,meta:s,redirect:a,children:l}}),wr=Tr;var Er=Array.isArray;const Vt=Er;var Sr="[object AsyncFunction]",Mr="[object Function]",$r="[object GeneratorFunction]",Ar="[object Proxy]";function Bo(e){if(!nt(e))return!1;var t=ot(e);return t==Mr||t==$r||t==Sr||t==Ar}var kr=le["__core-js_shared__"];const At=kr;var Zn=function(){var e=/[^.]+$/.exec(At&&At.keys&&At.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Or(e){return!!Zn&&Zn in e}var Rr=Function.prototype,Nr=Rr.toString;function Se(e){if(e!=null){try{return Nr.call(e)}catch{}try{return e+""}catch{}}return""}var Lr=/[\\^$.*+?()[\]{}|]/g,Pr=/^\[object .+?Constructor\]$/,Ur=Function.prototype,Dr=Object.prototype,xr=Ur.toString,jr=Dr.hasOwnProperty,Br=RegExp("^"+xr.call(jr).replace(Lr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Gr(e){if(!nt(e)||Or(e))return!1;var t=Bo(e)?Br:Pr;return t.test(Se(e))}function Fr(e,t){return e==null?void 0:e[t]}function Me(e,t){var o=Fr(e,t);return Gr(o)?o:void 0}var Vr=Me(le,"WeakMap");const Nt=Vr;var Yn=Object.create,Hr=function(){function e(){}return function(t){if(!nt(t))return{};if(Yn)return Yn(t);e.prototype=t;var o=new e;return e.prototype=void 0,o}}();const Wr=Hr;function qr(e,t){var o=-1,s=e.length;for(t||(t=Array(s));++o<s;)t[o]=e[o];return t}var zr=function(){try{var e=Me(Object,"defineProperty");return e({},"",{}),e}catch{}}();const Xn=zr;function Jr(e,t){for(var o=-1,s=e==null?0:e.length;++o<s&&t(e[o],o,e)!==!1;);return e}var Kr=9007199254740991,Qr=/^(?:0|[1-9]\d*)$/;function Zr(e,t){var o=typeof e;return t=t==null?Kr:t,!!t&&(o=="number"||o!="symbol"&&Qr.test(e))&&e>-1&&e%1==0&&e<t}function Go(e,t,o){t=="__proto__"&&Xn?Xn(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}function Fo(e,t){return e===t||e!==e&&t!==t}var Yr=Object.prototype,Xr=Yr.hasOwnProperty;function Vo(e,t,o){var s=e[t];(!(Xr.call(e,t)&&Fo(s,o))||o===void 0&&!(t in e))&&Go(e,t,o)}function ft(e,t,o,s){var a=!o;o||(o={});for(var l=-1,d=t.length;++l<d;){var m=t[l],w=s?s(o[m],e[m],m,o,e):void 0;w===void 0&&(w=e[m]),a?Go(o,m,w):Vo(o,m,w)}return o}var ei=9007199254740991;function Ho(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=ei}function Wo(e){return e!=null&&Ho(e.length)&&!Bo(e)}var ti=Object.prototype;function Ht(e){var t=e&&e.constructor,o=typeof t=="function"&&t.prototype||ti;return e===o}function ni(e,t){for(var o=-1,s=Array(e);++o<e;)s[o]=t(o);return s}var oi="[object Arguments]";function eo(e){return st(e)&&ot(e)==oi}var qo=Object.prototype,si=qo.hasOwnProperty,ai=qo.propertyIsEnumerable,ri=eo(function(){return arguments}())?eo:function(e){return st(e)&&si.call(e,"callee")&&!ai.call(e,"callee")};const ii=ri;function ci(){return!1}var zo=typeof exports=="object"&&exports&&!exports.nodeType&&exports,to=zo&&typeof module=="object"&&module&&!module.nodeType&&module,li=to&&to.exports===zo,no=li?le.Buffer:void 0,ui=no?no.isBuffer:void 0,di=ui||ci;const Jo=di;var fi="[object Arguments]",pi="[object Array]",hi="[object Boolean]",mi="[object Date]",gi="[object Error]",vi="[object Function]",_i="[object Map]",bi="[object Number]",Ci="[object Object]",yi="[object RegExp]",Ii="[object Set]",Ti="[object String]",wi="[object WeakMap]",Ei="[object ArrayBuffer]",Si="[object DataView]",Mi="[object Float32Array]",$i="[object Float64Array]",Ai="[object Int8Array]",ki="[object Int16Array]",Oi="[object Int32Array]",Ri="[object Uint8Array]",Ni="[object Uint8ClampedArray]",Li="[object Uint16Array]",Pi="[object Uint32Array]",U={};U[Mi]=U[$i]=U[Ai]=U[ki]=U[Oi]=U[Ri]=U[Ni]=U[Li]=U[Pi]=!0;U[fi]=U[pi]=U[Ei]=U[hi]=U[Si]=U[mi]=U[gi]=U[vi]=U[_i]=U[bi]=U[Ci]=U[yi]=U[Ii]=U[Ti]=U[wi]=!1;function Ui(e){return st(e)&&Ho(e.length)&&!!U[ot(e)]}function Wt(e){return function(t){return e(t)}}var Ko=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Qe=Ko&&typeof module=="object"&&module&&!module.nodeType&&module,Di=Qe&&Qe.exports===Ko,kt=Di&&za.process,xi=function(){try{var e=Qe&&Qe.require&&Qe.require("util").types;return e||kt&&kt.binding&&kt.binding("util")}catch{}}();const xe=xi;var oo=xe&&xe.isTypedArray,ji=oo?Wt(oo):Ui;const Bi=ji;var Gi=Object.prototype,Fi=Gi.hasOwnProperty;function Qo(e,t){var o=Vt(e),s=!o&&ii(e),a=!o&&!s&&Jo(e),l=!o&&!s&&!a&&Bi(e),d=o||s||a||l,m=d?ni(e.length,String):[],w=m.length;for(var _ in e)(t||Fi.call(e,_))&&!(d&&(_=="length"||a&&(_=="offset"||_=="parent")||l&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||Zr(_,w)))&&m.push(_);return m}function Zo(e,t){return function(o){return e(t(o))}}var Vi=Zo(Object.keys,Object);const Hi=Vi;var Wi=Object.prototype,qi=Wi.hasOwnProperty;function zi(e){if(!Ht(e))return Hi(e);var t=[];for(var o in Object(e))qi.call(e,o)&&o!="constructor"&&t.push(o);return t}function qt(e){return Wo(e)?Qo(e):zi(e)}function Ji(e){var t=[];if(e!=null)for(var o in Object(e))t.push(o);return t}var Ki=Object.prototype,Qi=Ki.hasOwnProperty;function Zi(e){if(!nt(e))return Ji(e);var t=Ht(e),o=[];for(var s in e)s=="constructor"&&(t||!Qi.call(e,s))||o.push(s);return o}function zt(e){return Wo(e)?Qo(e,!0):Zi(e)}var Yi=Me(Object,"create");const Ze=Yi;function Xi(){this.__data__=Ze?Ze(null):{},this.size=0}function ec(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var tc="__lodash_hash_undefined__",nc=Object.prototype,oc=nc.hasOwnProperty;function sc(e){var t=this.__data__;if(Ze){var o=t[e];return o===tc?void 0:o}return oc.call(t,e)?t[e]:void 0}var ac=Object.prototype,rc=ac.hasOwnProperty;function ic(e){var t=this.__data__;return Ze?t[e]!==void 0:rc.call(t,e)}var cc="__lodash_hash_undefined__";function lc(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Ze&&t===void 0?cc:t,this}function we(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var s=e[t];this.set(s[0],s[1])}}we.prototype.clear=Xi;we.prototype.delete=ec;we.prototype.get=sc;we.prototype.has=ic;we.prototype.set=lc;function uc(){this.__data__=[],this.size=0}function pt(e,t){for(var o=e.length;o--;)if(Fo(e[o][0],t))return o;return-1}var dc=Array.prototype,fc=dc.splice;function pc(e){var t=this.__data__,o=pt(t,e);if(o<0)return!1;var s=t.length-1;return o==s?t.pop():fc.call(t,o,1),--this.size,!0}function hc(e){var t=this.__data__,o=pt(t,e);return o<0?void 0:t[o][1]}function mc(e){return pt(this.__data__,e)>-1}function gc(e,t){var o=this.__data__,s=pt(o,e);return s<0?(++this.size,o.push([e,t])):o[s][1]=t,this}function ue(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var s=e[t];this.set(s[0],s[1])}}ue.prototype.clear=uc;ue.prototype.delete=pc;ue.prototype.get=hc;ue.prototype.has=mc;ue.prototype.set=gc;var vc=Me(le,"Map");const Ye=vc;function _c(){this.size=0,this.__data__={hash:new we,map:new(Ye||ue),string:new we}}function bc(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function ht(e,t){var o=e.__data__;return bc(t)?o[typeof t=="string"?"string":"hash"]:o.map}function Cc(e){var t=ht(this,e).delete(e);return this.size-=t?1:0,t}function yc(e){return ht(this,e).get(e)}function Ic(e){return ht(this,e).has(e)}function Tc(e,t){var o=ht(this,e),s=o.size;return o.set(e,t),this.size+=o.size==s?0:1,this}function Be(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var s=e[t];this.set(s[0],s[1])}}Be.prototype.clear=_c;Be.prototype.delete=Cc;Be.prototype.get=yc;Be.prototype.has=Ic;Be.prototype.set=Tc;function Yo(e,t){for(var o=-1,s=t.length,a=e.length;++o<s;)e[a+o]=t[o];return e}var wc=Zo(Object.getPrototypeOf,Object);const Xo=wc;function Ec(){this.__data__=new ue,this.size=0}function Sc(e){var t=this.__data__,o=t.delete(e);return this.size=t.size,o}function Mc(e){return this.__data__.get(e)}function $c(e){return this.__data__.has(e)}var Ac=200;function kc(e,t){var o=this.__data__;if(o instanceof ue){var s=o.__data__;if(!Ye||s.length<Ac-1)return s.push([e,t]),this.size=++o.size,this;o=this.__data__=new Be(s)}return o.set(e,t),this.size=o.size,this}function Ge(e){var t=this.__data__=new ue(e);this.size=t.size}Ge.prototype.clear=Ec;Ge.prototype.delete=Sc;Ge.prototype.get=Mc;Ge.prototype.has=$c;Ge.prototype.set=kc;function Oc(e,t){return e&&ft(t,qt(t),e)}function Rc(e,t){return e&&ft(t,zt(t),e)}var es=typeof exports=="object"&&exports&&!exports.nodeType&&exports,so=es&&typeof module=="object"&&module&&!module.nodeType&&module,Nc=so&&so.exports===es,ao=Nc?le.Buffer:void 0,ro=ao?ao.allocUnsafe:void 0;function Lc(e,t){if(t)return e.slice();var o=e.length,s=ro?ro(o):new e.constructor(o);return e.copy(s),s}function Pc(e,t){for(var o=-1,s=e==null?0:e.length,a=0,l=[];++o<s;){var d=e[o];t(d,o,e)&&(l[a++]=d)}return l}function ts(){return[]}var Uc=Object.prototype,Dc=Uc.propertyIsEnumerable,io=Object.getOwnPropertySymbols,xc=io?function(e){return e==null?[]:(e=Object(e),Pc(io(e),function(t){return Dc.call(e,t)}))}:ts;const Jt=xc;function jc(e,t){return ft(e,Jt(e),t)}var Bc=Object.getOwnPropertySymbols,Gc=Bc?function(e){for(var t=[];e;)Yo(t,Jt(e)),e=Xo(e);return t}:ts;const ns=Gc;function Fc(e,t){return ft(e,ns(e),t)}function os(e,t,o){var s=t(e);return Vt(e)?s:Yo(s,o(e))}function Vc(e){return os(e,qt,Jt)}function Hc(e){return os(e,zt,ns)}var Wc=Me(le,"DataView");const Lt=Wc;var qc=Me(le,"Promise");const Pt=qc;var zc=Me(le,"Set");const Ut=zc;var co="[object Map]",Jc="[object Object]",lo="[object Promise]",uo="[object Set]",fo="[object WeakMap]",po="[object DataView]",Kc=Se(Lt),Qc=Se(Ye),Zc=Se(Pt),Yc=Se(Ut),Xc=Se(Nt),Te=ot;(Lt&&Te(new Lt(new ArrayBuffer(1)))!=po||Ye&&Te(new Ye)!=co||Pt&&Te(Pt.resolve())!=lo||Ut&&Te(new Ut)!=uo||Nt&&Te(new Nt)!=fo)&&(Te=function(e){var t=ot(e),o=t==Jc?e.constructor:void 0,s=o?Se(o):"";if(s)switch(s){case Kc:return po;case Qc:return co;case Zc:return lo;case Yc:return uo;case Xc:return fo}return t});const Kt=Te;var el=Object.prototype,tl=el.hasOwnProperty;function nl(e){var t=e.length,o=new e.constructor(t);return t&&typeof e[0]=="string"&&tl.call(e,"index")&&(o.index=e.index,o.input=e.input),o}var ol=le.Uint8Array;const ho=ol;function Qt(e){var t=new e.constructor(e.byteLength);return new ho(t).set(new ho(e)),t}function sl(e,t){var o=t?Qt(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}var al=/\w*$/;function rl(e){var t=new e.constructor(e.source,al.exec(e));return t.lastIndex=e.lastIndex,t}var mo=Qn?Qn.prototype:void 0,go=mo?mo.valueOf:void 0;function il(e){return go?Object(go.call(e)):{}}function cl(e,t){var o=t?Qt(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}var ll="[object Boolean]",ul="[object Date]",dl="[object Map]",fl="[object Number]",pl="[object RegExp]",hl="[object Set]",ml="[object String]",gl="[object Symbol]",vl="[object ArrayBuffer]",_l="[object DataView]",bl="[object Float32Array]",Cl="[object Float64Array]",yl="[object Int8Array]",Il="[object Int16Array]",Tl="[object Int32Array]",wl="[object Uint8Array]",El="[object Uint8ClampedArray]",Sl="[object Uint16Array]",Ml="[object Uint32Array]";function $l(e,t,o){var s=e.constructor;switch(t){case vl:return Qt(e);case ll:case ul:return new s(+e);case _l:return sl(e,o);case bl:case Cl:case yl:case Il:case Tl:case wl:case El:case Sl:case Ml:return cl(e,o);case dl:return new s;case fl:case ml:return new s(e);case pl:return rl(e);case hl:return new s;case gl:return il(e)}}function Al(e){return typeof e.constructor=="function"&&!Ht(e)?Wr(Xo(e)):{}}var kl="[object Map]";function Ol(e){return st(e)&&Kt(e)==kl}var vo=xe&&xe.isMap,Rl=vo?Wt(vo):Ol;const Nl=Rl;var Ll="[object Set]";function Pl(e){return st(e)&&Kt(e)==Ll}var _o=xe&&xe.isSet,Ul=_o?Wt(_o):Pl;const Dl=Ul;var xl=1,jl=2,Bl=4,ss="[object Arguments]",Gl="[object Array]",Fl="[object Boolean]",Vl="[object Date]",Hl="[object Error]",as="[object Function]",Wl="[object GeneratorFunction]",ql="[object Map]",zl="[object Number]",rs="[object Object]",Jl="[object RegExp]",Kl="[object Set]",Ql="[object String]",Zl="[object Symbol]",Yl="[object WeakMap]",Xl="[object ArrayBuffer]",eu="[object DataView]",tu="[object Float32Array]",nu="[object Float64Array]",ou="[object Int8Array]",su="[object Int16Array]",au="[object Int32Array]",ru="[object Uint8Array]",iu="[object Uint8ClampedArray]",cu="[object Uint16Array]",lu="[object Uint32Array]",L={};L[ss]=L[Gl]=L[Xl]=L[eu]=L[Fl]=L[Vl]=L[tu]=L[nu]=L[ou]=L[su]=L[au]=L[ql]=L[zl]=L[rs]=L[Jl]=L[Kl]=L[Ql]=L[Zl]=L[ru]=L[iu]=L[cu]=L[lu]=!0;L[Hl]=L[as]=L[Yl]=!1;function ut(e,t,o,s,a,l){var d,m=t&xl,w=t&jl,_=t&Bl;if(o&&(d=a?o(e,s,a,l):o(e)),d!==void 0)return d;if(!nt(e))return e;var b=Vt(e);if(b){if(d=nl(e),!m)return qr(e,d)}else{var S=Kt(e),O=S==as||S==Wl;if(Jo(e))return Lc(e,m);if(S==rs||S==ss||O&&!a){if(d=w||O?{}:Al(e),!m)return w?Fc(e,Rc(d,e)):jc(e,Oc(d,e))}else{if(!L[S])return a?e:{};d=$l(e,S,m)}}l||(l=new Ge);var g=l.get(e);if(g)return g;l.set(e,d),Dl(e)?e.forEach(function(u){d.add(ut(u,t,o,u,e,l))}):Nl(e)&&e.forEach(function(u,y){d.set(y,ut(u,t,o,y,e,l))});var I=_?w?Hc:Vc:w?zt:qt,h=b?void 0:I(e);return Jr(h||e,function(u,y){h&&(y=u,u=e[y]),Vo(d,y,ut(u,t,o,y,e,l))}),d}var uu=1,du=4;function fu(e){return ut(e,uu|du)}function pu(){const e=yr(),t=je(),o=G(()=>t.menuFromServer?t.appAsyncMenus:wr);return{menuTree:G(()=>{const a=fu(o.value);a.sort((d,m)=>(d.meta.order||0)-(m.meta.order||0));function l(d,m){return d?d.map(_=>{var S,O;if(!e.accessRouter(_))return null;if(((S=_.meta)==null?void 0:S.hideChildrenInMenu)||!_.children)return _.children=[],_;_.children=_.children.filter(g=>{var I;return((I=g.meta)==null?void 0:I.hideInMenu)!==!0});const b=l(_.children,m+1);return b.length||m>1?(_.children=b,_):((O=_.meta)==null?void 0:O.hideInMenu)===!1?_:null}).filter(Boolean):null}return l(a,0)})}}function hu(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Mo(e)}const mu=ae({emit:["collapse"],setup(){const{t:e}=Ee.exports.useI18n(),t=je(),o=tt(),s=Uo(),{menuTree:a}=pu(),l=G({get(){return Ue()||t.device==="desktop"?t.menuCollapse:!1},set(g){t.updateSettings({menuCollapse:g})}}),d=G(()=>t.topMenu),m=N([]),w=N([]),_=g=>{if(Ja.test(g.path)){Ka(g.path),w.value=[g.name];return}const{hideInMenu:I,activeMenu:h}=g.meta;if(s.name===g.name&&!I&&!h){w.value=[g.name];return}o.push({name:g.name})},b=g=>{const I=[];let h=!1;const u=(y,f)=>{var D;if(y.name===g){h=!0,I.push(...f);return}(D=y.children)!=null&&D.length&&y.children.forEach(W=>{u(W,[...f,W.name])})};return a.value.forEach(y=>{h||u(y,[y.name])}),I};To(g=>{const{requiresAuth:I,activeMenu:h,hideInMenu:u}=g.meta;if(I&&(!u||h)){const y=b(h||g.name),f=new Set([...y,...m.value]);m.value=[...f],w.value=[h||y[y.length-1]]}},!0);const S=g=>{Ue()&&t.updateSettings({menuCollapse:g}),t.device==="desktop"&&t.updateSettings({menuCollapse:g})},O=()=>{function g(I,h=[]){return I&&I.forEach(u=>{var D,W;const y=(D=u==null?void 0:u.meta)!=null&&D.icon?(W=u==null?void 0:u.meta)==null?void 0:W.icon:"",f=(u==null?void 0:u.children)&&(u==null?void 0:u.children.length)!==0?p(Ia,{key:u==null?void 0:u.name},{default:()=>[g(u==null?void 0:u.children)],icon:()=>p("i",{class:`iconfont ${y}`},null),title:()=>{var ne;return Ca(ya(e(((ne=u==null?void 0:u.meta)==null?void 0:ne.locale)||"")))}}):p(Ta,{key:u==null?void 0:u.name,onClick:()=>_(u)},{default:()=>{var ne;return[e(((ne=u==null?void 0:u.meta)==null?void 0:ne.locale)||"")]},icon:()=>p("i",{class:`iconfont ${y}`},null)});h.push(f)}),h}return g(a.value)};return()=>{let g;return p(ba,{mode:d.value?"horizontal":"vertical",collapsed:l.value,"onUpdate:collapsed":I=>l.value=I,"open-keys":m.value,"onUpdate:open-keys":I=>m.value=I,"show-collapse-button":Ue()?!0:t.device!=="mobile","auto-open":!1,"selected-keys":w.value,"auto-open-selected":!0,"level-indent":34,style:"height: 100%;width:100%;",onCollapse:S},hu(g=O())?g:{default:()=>[g]})}}});const Dt=ce(mu,[["__scopeId","data-v-7bbdf8b6"]]),gu={class:"change-password-container modal-container"},vu=["src"],_u={class:"modal-title"},bu={class:"modal-main wsl-scroll"},Cu={class:"modal-bot"},yu=ae({__name:"chang",emits:["handleClose","handleConfirmation"],setup(e,{emit:t}){const{t:o}=Ee.exports.useI18n(),s=t,a=Xe(),l=N({password:"",surePassword:""}),d=()=>{l.value={password:"",surePassword:""}},m=()=>{d(),s("handleClose")},w=async()=>{if(!l.value.password){F.warning(o("password.modal.placeholder.new"));return}if(!l.value.surePassword){F.warning(o("password.modal.placeholder.sure"));return}if(l.value.password!==l.value.surePassword){F.warning(o("password.form.btn.inconformity"));return}const _=await a.revampPassword({newPassword:l.value.password});if(_.code!==200&&_.code!==401){F.error(_.msg);return}F.success(o("password.form.btn.success")),m(),s("handleConfirmation")};return dt(()=>{d()}),(_,b)=>{const S=wa,O=Ea,g=Sa,I=De;return E(),H("div",gu,[i("div",{class:"modal-fixed",onClick:m},[i("img",{src:M(xo),alt:""},null,8,vu)]),i("div",_u,$(_.$t("password.modal.title")),1),i("div",bu,[p(g,{model:l.value,layout:"vertical"},{default:v(()=>[p(O,{field:"password",label:_.$t("password.modal.new")},{default:v(()=>[p(S,{modelValue:l.value.password,"onUpdate:modelValue":b[0]||(b[0]=h=>l.value.password=h),placeholder:_.$t("password.modal.placeholder.new"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p(O,{field:"surePassword",label:_.$t("password.modal.sure")},{default:v(()=>[p(S,{modelValue:l.value.surePassword,"onUpdate:modelValue":b[1]||(b[1]=h=>l.value.surePassword=h),placeholder:_.$t("password.modal.placeholder.sure"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),i("div",Cu,[p(I,{class:"modal-btn-item",onClick:m},{default:v(()=>[oe($(_.$t("password.form.btn.cancel")),1)]),_:1}),p(I,{class:"modal-btn-item",disabled:!l.value.password||!l.value.surePassword,type:"primary",onClick:w},{default:v(()=>[oe($(_.$t("password.form.btn.sure")),1)]),_:1},8,["disabled"])])])}}});const Iu=ce(yu,[["__scopeId","data-v-a9f3d9bb"]]),Tu={width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},wu=i("g",{"fill-rule":"evenodd","clip-rule":"evenodd",fill:"#4E5969"},[i("path",{d:"M12.834 3.167a4.546 4.546 0 0 0-7.556 4.565.5.5 0 0 1-.124.501l-3.13 3.13a.766.766 0 0 0-.146.27.718.718 0 0 0-.043.301v.004l.2 1.449a.719.719 0 0 0 .207.375c.12.12.255.186.367.202l1.457.2c.066.01.179.003.305-.038a.662.662 0 0 0 .257-.141l.006-.006 3.14-3.133a.5.5 0 0 1 .502-.124A4.55 4.55 0 0 0 12.841 9.6a4.552 4.552 0 0 0-.007-6.432Zm-7.133-.708a5.55 5.55 0 0 1 7.846 7.847v.001a5.55 5.55 0 0 1-5.274 1.453l-2.93 2.924c-.186.19-.432.318-.663.393a1.719 1.719 0 0 1-.758.077l-1.45-.2a1.674 1.674 0 0 1-.938-.487 1.712 1.712 0 0 1-.488-.932l-.001-.007-.2-1.45v-.002c-.037-.259.008-.53.084-.76.077-.23.203-.47.38-.651l.004-.006 2.928-2.927A5.541 5.541 0 0 1 5.7 2.46Z"}),i("path",{d:"M4.24 11.307a.5.5 0 0 1 .707 0l1.534 1.533a.5.5 0 1 1-.707.707L4.24 12.014a.5.5 0 0 1 0-.707ZM9.668 5.834a.5.5 0 1 0 0 1 .5.5 0 0 0 0-1Zm-1.5.5a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"})],-1),Eu=[wu];function Su(e,t){return E(),H("svg",Tu,[...Eu])}const Mu={render:Su},is=e=>(Gt("data-v-44879333"),e=e(),Ft(),e),$u={class:"navbar"},Au={class:"left-side"},ku=is(()=>i("img",{alt:"logo",src:er},null,-1)),Ou={class:"center-side"},Ru={class:"right-side"},Nu={class:"quick_access_main"},Lu=["onClick"],Pu={class:"quick_access_main_item_main"},Uu=["src"],Du={class:"quick_access_main_item_m_label"},xu=["src"],ju={class:"user-info"},Bu={class:"user-info-name"},Gu={class:"user-info-bot"},Fu={class:"user-info-bot-l"},Vu=is(()=>i("div",{class:"user-info-bot-i outline"},null,-1)),Hu={class:"user-info-bot-l"},Wu=["src"],bo="ChatDB",qu=ae({__name:"index",setup(e){const t=je(),o=Xe(),s=xt(),a=wo(),l=Js(),d=tt(),{t:m,locale:w}=Ee.exports.useI18n(),{getAllConversations:_}=Ot(bo),{clearAll:b}=Ot(bo),{logout:S}=jo(),{changeLocale:O,currentLocale:g}=Ks(),I=[...ta],h=G(()=>o.avatarUrl),u=G(()=>o.name),y=G(()=>s.socketStatus===1?m("socket.status1"):s.socketStatus===2?m("socket.status2"):""),f=G(()=>t.topMenu&&t.menu),D=N(),W=async()=>{await S(),b()},ne=()=>{const R=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});D.value.dispatchEvent(R)},$e=Ma("toggleDrawerMenu"),K=N(!1),_e=()=>{K.value=!0},de=()=>{K.value=!1},fe=()=>{de()},Ve=()=>{c.emit("navbar-show-ar-login-qr-code")},ee=N(0),be=N([]),at=async()=>{ee.value=0,be.value=await _(),be.value?be.value.forEach(R=>{ee.value+=R.unreadCount}):ee.value=0},pe=R=>JSON.parse(R.entryName)[w.value],x=async R=>{if(console.log("handleInitQuitList",R),R){const V=await l.getQuickList();if(V.code!==200&&V.code!==401){if(V.code===20408)return;F.error(V.msg);return}l.updateQuickEnters(V.data)}},A=async R=>{if(R.isOwnApp===0)window.open(R.entryUri,"_blank");else{const V=await o.getApplicationCode({client_id:R.appId,redirect_uri:R.entryUri,scope:"snsapi_base"});if(V.code!==200&&V.code!==401)return V.code===20408||F.error(V.msg),!1;window.open(`${R.entryUri}?code=${V.data.code}`,"_blank")}return!1},Ae=R=>{d.push({path:R})};return $o(()=>a.conversationList,R=>{R&&at()},{deep:!0,immediate:!0}),(R,V)=>{const He=$a,Ce=Ao,mt=Qs,ke=De,We=ko,Oe=Oa,Re=Oo,Ne=Ro,he=Zs,rt=Ys,gt=Aa,it=Xs,qe=ka,vt=Ra,_t=ea,ze=No;return E(),H("div",$u,[i("div",Au,[p(Ce,null,{default:v(()=>[ku,!f.value&&M(t).device==="mobile"?(E(),B(He,{key:0,style:{"font-size":"22px",cursor:"pointer"},onClick:M($e)},null,8,["onClick"])):z("",!0)]),_:1})]),i("div",Ou,[f.value?(E(),B(Dt,{key:0})):z("",!0)]),i("ul",Ru,[i("li",null,[p(We,{content:R.$t("settings.language")},{default:v(()=>[p(ke,{class:"nav-btn",type:"outline",shape:"circle",onClick:ne},{icon:v(()=>[p(mt)]),_:1})]),_:1},8,["content"]),p(Ne,{trigger:"click",onSelect:M(O)},{content:v(()=>[(E(),H(Je,null,Rt(I,te=>p(Re,{key:te.value,value:te.value},{icon:v(()=>[Lo(p(Oe,null,null,512),[[Po,te.value===M(g)]])]),default:v(()=>[oe(" "+$(te.label),1)]),_:2},1032,["value"])),64))]),default:v(()=>[i("div",{ref_key:"triggerBtn",ref:D,class:"trigger-btn"},null,512)]),_:1},8,["onSelect"])]),i("li",null,[p(Ne,{onPopupVisibleChange:x},{content:v(()=>[i("div",Nu,[(E(!0),H(Je,null,Rt(M(l).quickEnters,(te,ct)=>(E(),H("div",{key:`quick_${ct}`,class:"quick_access_main_item",onClick:me=>A(te)},[i("div",Pu,[i("img",{class:"quick_access_main_item_m_icon",src:te.iconUrl,alt:""},null,8,Uu),i("div",Du,[i("span",null,$(pe(te)),1)])])],8,Lu))),128))])]),default:v(()=>[p(We,{content:R.$t("settings.application")},{default:v(()=>[p(ke,{class:"nav-btn",type:"outline",shape:"circle"},{icon:v(()=>[p(he)]),_:1})]),_:1},8,["content"])]),_:1})]),i("li",null,[p(gt,{count:ee.value,dot:""},{default:v(()=>[p(ke,{class:"nav-btn",type:"outline",shape:"circle",onClick:V[0]||(V[0]=te=>Ae("/Message-List"))},{default:v(()=>[p(rt)]),_:1})]),_:1},8,["count"])]),i("li",null,[p(We,{content:R.$t("messageBox.ar.logo.title")},{default:v(()=>[p(ke,{class:"nav-btn",type:"outline",shape:"circle",onClick:Ve},{icon:v(()=>[p(it)]),_:1})]),_:1},8,["content"])]),i("li",null,[p(qe,{size:32,style:{marginRight:"8px",cursor:"pointer"}},{default:v(()=>[i("img",{alt:"avatar",src:h.value},null,8,xu)]),_:1}),p(Ne,{trigger:"click",position:"br"},{content:v(()=>[p(Re,null,{default:v(()=>[p(Ce,null,{default:v(()=>[i("img",{style:{width:"14px",height:"14px",borderRadius:"50%"},src:h.value,alt:""},null,8,Wu),i("span",null,$(u.value),1)]),_:1})]),_:1}),p(Re,{onClick:_e},{default:v(()=>[p(Ce,null,{default:v(()=>[p(M(Mu)),i("span",null,$(R.$t("messageBox.change.password")),1)]),_:1})]),_:1}),p(Re,{onClick:W},{default:v(()=>[p(Ce,null,{default:v(()=>[p(_t),i("span",null,$(R.$t("messageBox.logout")),1)]),_:1})]),_:1})]),default:v(()=>[i("div",ju,[i("div",Bu,[i("span",null,$(u.value),1)]),i("div",Gu,[M(s).networkStatus?(E(),H(Je,{key:0},[M(s).socketStatus==3?(E(),H("div",{key:0,class:Bt(["user-info-bot-i",M(s).networkStatus?"online":"outline"])},null,2)):z("",!0),M(s).socketStatus===2?(E(),B(vt,{key:1,size:12})):z("",!0),i("div",Fu,$(M(s).socketStatus===2?y.value:R.$t("meeting.invite.line.status.online")),1)],64)):(E(),H(Je,{key:1},[Vu,i("div",Hu,$(R.$t("meeting.invite.line.status.outline")),1)],64))])])]),_:1})])]),K.value?(E(),B(ze,{key:0,visible:K.value,"onUpdate:visible":V[1]||(V[1]=te=>K.value=te),footer:!1,closable:!1,class:"customModal"},{default:v(()=>[p(Iu,{onHandleClose:de,onHandleConfirmation:fe})]),_:1},8,["visible"])):z("",!0)])}}});const zu=ce(qu,[["__scopeId","data-v-44879333"]]);const Fe=e=>(Gt("data-v-17257cfa"),e=e(),Ft(),e),Ju={class:"tag-link"},Ku=Fe(()=>i("span",null,"\u91CD\u65B0\u52A0\u8F7D",-1)),Qu=Fe(()=>i("span",null,"\u5173\u95ED\u5F53\u524D\u6807\u7B7E\u9875",-1)),Zu=Fe(()=>i("span",null,"\u5173\u95ED\u5DE6\u4FA7\u6807\u7B7E\u9875",-1)),Yu=Fe(()=>i("span",null,"\u5173\u95ED\u53F3\u4FA7\u6807\u7B7E\u9875",-1)),Xu=Fe(()=>i("span",null,"\u5173\u95ED\u5176\u5B83\u6807\u7B7E\u9875",-1)),ed=Fe(()=>i("span",null,"\u5173\u95ED\u5168\u90E8\u6807\u7B7E\u9875",-1)),td=ae({__name:"tab-item",props:{itemData:{type:Object,default(){return[]}},index:{type:Number,default:0}},setup(e){const t=e,o=tt(),s=Uo(),a=jt(),l=I=>{o.push({...I})},d=G(()=>a.getTabList),m=G(()=>t.itemData.fullPath!==s.fullPath),w=G(()=>t.index===0),_=G(()=>[0,1].includes(t.index)),b=G(()=>t.index===d.value.length-1),S=(I,h)=>{if(a.deleteTag(h,I),t.itemData.fullPath===s.fullPath){const u=d.value[h-1];o.push({name:u.name})}},O=()=>d.value.findIndex(I=>I.fullPath===s.fullPath),g=async I=>{const{itemData:h,index:u}=t,y=[...d.value];if(I==="current")S(h,u);else if(I==="left"){const f=O();y.splice(1,t.index-1),a.freshTabList(y),f<u&&o.push({name:h.name})}else if(I==="right"){const f=O();y.splice(t.index+1),a.freshTabList(y),f>u&&o.push({name:h.name})}else if(I==="others"){const f=d.value.filter((D,W)=>W===0||W===t.index);a.freshTabList(f),o.push({name:h.name})}else I==="reload"?(a.deleteCache(h),await o.push({name:na,params:{path:s.fullPath}}),a.addCache(h.name)):(a.resetTabList(),o.push({name:oa}))};return(I,h)=>{const u=La,y=sa,f=Oo,D=aa,W=ra,ne=ia,$e=ca,K=Ro;return E(),B(K,{trigger:"contextMenu","popup-max-height":!1,onSelect:g},{content:v(()=>[p(f,{disabled:m.value,value:"reload"},{default:v(()=>[p(y),Ku]),_:1},8,["disabled","value"]),p(f,{class:"sperate-line",disabled:w.value,value:"current"},{default:v(()=>[p(u),Qu]),_:1},8,["disabled","value"]),p(f,{disabled:_.value,value:"left"},{default:v(()=>[p(D),Zu]),_:1},8,["disabled","value"]),p(f,{class:"sperate-line",disabled:b.value,value:"right"},{default:v(()=>[p(W),Yu]),_:1},8,["disabled","value"]),p(f,{value:"others"},{default:v(()=>[p(ne),Xu]),_:1},8,["value"]),p(f,{value:"all"},{default:v(()=>[p($e),ed]),_:1},8,["value"])]),default:v(()=>[i("span",{class:Bt(["arco-tag arco-tag-size-medium arco-tag-checked",{"link-activated":e.itemData.fullPath===I.$route.fullPath}]),onClick:h[1]||(h[1]=_e=>l(e.itemData))},[i("span",Ju,$(I.$t(e.itemData.title)),1),i("span",{class:"arco-icon-hover arco-tag-icon-hover arco-icon-hover-size-medium arco-tag-close-btn",onClick:h[0]||(h[0]=Na(_e=>S(e.itemData,e.index),["stop"]))},[p(u)])],2)]),_:1})}}});const nd=ce(td,[["__scopeId","data-v-17257cfa"]]),od=e=>(Gt("data-v-509db106"),e=e(),Ft(),e),sd={class:"tab-bar-container"},ad={class:"tab-bar-box"},rd={class:"tab-bar-scroll"},id={class:"tags-wrap"},cd=od(()=>i("div",{class:"tag-bar-operation"},null,-1)),ld=ae({__name:"index",setup(e){const t=je(),o=jt(),s=N(),a=G(()=>o.getTabList),l=G(()=>t.navbar?60:0);return $o(()=>t.navbar,()=>{s.value.updatePosition()}),To(d=>{!d.meta.noAffix&&!a.value.some(m=>m.fullPath===d.fullPath)&&o.updateTabList(d)},!0),Pa(()=>{la()}),(d,m)=>{const w=Ua;return E(),H("div",sd,[p(w,{ref_key:"affixRef",ref:s,"offset-top":l.value},{default:v(()=>[i("div",ad,[i("div",rd,[i("div",id,[(E(!0),H(Je,null,Rt(a.value,(_,b)=>(E(),B(nd,{key:_.fullPath,index:b,"item-data":_},null,8,["index","item-data"]))),128))])]),cd])]),_:1},8,["offset-top"])])}}});const ud=ce(ld,[["__scopeId","data-v-509db106"]]),dd={class:"room-options-container"},fd=["src"],pd={class:"link-m-t borderB"},hd={class:"room-options-main"},md={class:"link-m-b"},gd={class:"link-m-b-btn"},vd=ae({__name:"force_entry",emits:["handleClose","handleJoinMeeting"],setup(e,{emit:t}){const o=t,{t:s}=Ee.exports.useI18n(),a=()=>{o("handleClose")},d=Qa(async()=>{o("handleJoinMeeting")},1e3);return(m,w)=>(E(),H("div",dd,[i("div",{class:"room-fixed",onClick:a},[i("img",{src:M(Do),alt:""},null,8,fd)]),i("div",pd,[i("span",null,$(M(s)("meeting.modal.title")),1)]),i("div",hd,[i("span",null,$(M(s)("meeting.modal.force.desc")),1)]),i("div",md,[i("div",gd,[i("div",{class:"link-m-b-btn-i btn-border",onClick:a},[i("span",null,$(M(s)("meeting.modal.btn.cancel")),1)]),i("div",{class:"link-m-b-btn-i btn-bg",onClick:w[0]||(w[0]=(..._)=>M(d)&&M(d)(..._))},[i("span",null,$(M(s)("meeting.modal.btn.sure")),1)])])])]))}});const _d=ce(vd,[["__scopeId","data-v-beb61611"]]),bd={class:"upcoming-container"},Cd={class:"upcoming-container-top"},yd={class:"upcoming-container-top-l"},Id=["src"],Td={class:"upcoming-container-top-l-r"},wd=["src"],Ed={class:"upcoming-container-main"},Sd={class:"upcoming-container-main-top textEllipsis"},Md={class:"upcoming-container-main-bot"},$d={class:"upcoming-container-main-bot-i one"},Ad={class:"upcoming-container-main-bot-i"},kd={class:"upcoming-container-menu"},Od=ae({__name:"index",setup(e,{expose:t}){const{t:o}=Ee.exports.useI18n(),s=Eo(),a=So(),l=N(""),d=b=>b?Za(b,"HH:mm"):"",m=async b=>{if(b){const S=await a.filterMemberInfoByUserId(b);l.value=S.name}},w=()=>{s.removeUpcomingMeetingList(s.upcomingMeetingInfo),s.upcomingMeetingList.length>0?s.updateUpcomingMeetingInfo(s.upcomingMeetingList[0]):(s.updateUpcomingMeetingInfo(null),s.updateUpcomingMeetingVisible(!1))},_=async()=>{c.emit("meeting-notification-close"),c.emit("Chat-upcoming-meeting-join")};return et(()=>{m(s.upcomingMeetingInfo.master)}),t({handleClose:w}),(b,S)=>{var I,h,u;const O=ko,g=De;return E(),H("div",bd,[i("div",Cd,[i("div",yd,[i("img",{src:M(Ya),alt:""},null,8,Id),i("div",Td,[i("span",null,$(M(o)("meeting.modal.upcoming.title")),1)])]),i("div",{class:"upcoming-container-top-r",onClick:w},[i("img",{src:M(xo),alt:""},null,8,wd)])]),i("div",Ed,[p(O,{content:(I=M(s).upcomingMeetingInfo)==null?void 0:I.subject},{default:v(()=>{var y;return[i("div",Sd,$((y=M(s).upcomingMeetingInfo)==null?void 0:y.subject),1)]}),_:1},8,["content"]),i("div",Md,[i("div",$d,[i("span",null,$(M(o)("meeting.modal.upcoming.content2"))+":",1),oe(" \xA0 "),i("span",null,$(l.value),1)]),i("div",Ad,[i("span",null,$(M(o)("meeting.modal.upcoming.content1"))+":",1),oe(" \xA0 "),i("span",null,$(d((h=M(s).upcomingMeetingInfo)==null?void 0:h.startTime))+" - "+$(d((u=M(s).upcomingMeetingInfo)==null?void 0:u.endTime)),1)])])]),i("div",kd,[p(g,{long:"",class:"modal-btn-item",onClick:w},{default:v(()=>[oe($(b.$t("meeting.modal.upcoming.btn1")),1)]),_:1}),p(g,{long:"",class:"modal-btn-item",type:"primary",onClick:_},{default:v(()=>[oe($(b.$t("meeting.modal.upcoming.btn2")),1)]),_:1})])])}}});const Rd=ce(Od,[["__scopeId","data-v-204ae469"]]),Nd={class:"ar-qr-code-modal-container"},Ld=["src"],Pd={class:"ar-qr-code-main"},Ud={class:"ar-qr-code-main-top"},Dd={class:"ar-qr-code-main-mid-body"},xd={class:"ar-qr-code-main-bot"},jd={class:"ar-qr-code-main-bot-desc"},Bd=ae({__name:"index",emits:["handleClose"],setup(e,{emit:t}){const o=N(null),s=t,{t:a}=Ee.exports.useI18n();N(!0);const l=()=>{s("handleClose")},d=Xe(),m=xt(),w=N(""),_=async()=>{const S=await d.getArLoginQrCode({command:0});if(S.code!==200&&S.code!==401){F.error(S.msg);return}w.value=S.data},b=async()=>{o.value&&(await _(),o.value.innerHTML="",ua.toCanvas(w.value,{errorCorrectionLevel:"H",width:180,margin:2},(S,O)=>{var I;if(S){console.error(S);return}o.value&&o.value.appendChild(O);const g=O.getContext("2d");if(g){const u=(O.width-30)/2,y=(O.height-30)/2;g.beginPath(),g.moveTo(u+5,y),g.lineTo(u+30-5,y),g.quadraticCurveTo(u+30,y,u+30,y+5),g.lineTo(u+30,y+30-5),g.quadraticCurveTo(u+30,y+30,u+30-5,y+30),g.lineTo(u+5,y+30),g.quadraticCurveTo(u,y+30,u,y+30-5),g.lineTo(u,y+5),g.quadraticCurveTo(u,y,u+5,y),g.closePath(),g.fillStyle="#ffffff",g.fill(),g.strokeStyle="#000000",g.lineWidth=2,g.stroke();const f=new Image;f.src=(I=m.platformConfig)==null?void 0:I.oneToOneLogo,f.onload=()=>{g.drawImage(f,u+2.5,y+2.5,30-5,30-5)}}if(o.value){const h=document.createElement("div");h.textContent=d.name?d.name:"",h.style.textAlign="center",o.value.appendChild(h)}}))};return et(()=>{b()}),dt(()=>{w.value=""}),(S,O)=>(E(),H("div",Nd,[i("div",{class:"ar-qr-code-fixed",onClick:l},[i("img",{src:M(Do),alt:""},null,8,Ld)]),i("div",Pd,[i("div",Ud,[i("span",null,$(M(a)("ar.qr.code.modal.title")),1)]),i("div",Dd,[i("div",{ref_key:"qrCodeContainer",ref:o,class:"ar-qr-code-container"},null,512)])]),i("div",xd,[i("div",jd,[i("span",null,$(M(a)("ar.qr.code.modal.desc1")),1)])])]))}});const Gd=ce(Bd,[["__scopeId","data-v-145f1761"]]);function Fd(e,t,o,s=!1){e.addEventListener&&typeof e.addEventListener=="function"&&e.addEventListener(t,o,s)}function Vd(e,t,o,s=!1){e.removeEventListener&&typeof e.removeEventListener=="function"&&e.removeEventListener(t,o,s)}const Hd=992;function Wd(){return document.body.getBoundingClientRect().width-1<Hd}function qd(e){const t=je();function o(){if(!document.hidden){const a=Wd();t.toggleDevice(a?"mobile":"desktop"),t.toggleMenu(a)}}const s=qa(o,100);et(()=>{e&&s()}),Da(()=>{Fd(window,"resize",s)}),dt(()=>{Vd(window,"resize",s)})}const zd={width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Jd=i("circle",{cx:"28",cy:"28",r:"28",fill:"#FF7D00"},null,-1),Kd=i("path",{d:"M25.607 34a2.432 2.432 0 0 0 4.79 0l1.596-22a4.012 4.012 0 0 0-1.171-2.826A3.996 3.996 0 0 0 28.002 8a4.095 4.095 0 0 0-2.935 1.345A4.112 4.112 0 0 0 24.01 12.4L25.607 34Zm2.395 6a3.986 3.986 0 0 0-3.688 2.47 4.008 4.008 0 0 0 .865 4.358A3.988 3.988 0 0 0 31.993 44a3.786 3.786 0 0 0-1.098-2.9 3.77 3.77 0 0 0-2.893-1.1Z",fill:"#fff"},null,-1),Qd=[Jd,Kd];function Zd(e,t){return E(),H("svg",zd,[...Qd])}const Co={render:Zd};function Yd(){const e=N("default");return et(()=>{"Notification"in window&&(e.value=Notification.permission)}),{permission:e,requestPermission:async()=>{if(!("Notification"in window)){console.warn("Browser does not support notifications");return}try{const s=await Notification.requestPermission();e.value=s,console.log("\u8BF7\u6C42\u901A\u77E5\u6743\u9650",e.value)}catch(s){console.error("Error requesting permission:",s)}},notify:s=>{if(e.value!=="granted"){console.warn("Notification permission not granted");return}console.log("\u53D1\u9001\u7CFB\u7EDF\u901A\u77E5",s.title,s);const a=new Notification(s.title,s);a.onclick=()=>{window.focus(),console.log("Notification clicked")},console.log("\u53D1\u9001\u7CFB\u7EDF\u901A\u77E5-notification",a)}}}const Xd=ae({__name:"page-layout",setup(e){const t=jt(),o=G(()=>t.getCacheList);return(s,a)=>{const l=xa("router-view");return E(),B(l,null,{default:v(({Component:d,route:m})=>[p(Ba,{name:"fade",mode:"out-in",appear:""},{default:v(()=>[m.meta.ignoreCache?(E(),B(Ke(d),{key:m.fullPath})):(E(),B(ja,{key:1,include:o.value},[(E(),B(Ke(d),{key:m.fullPath}))],1032,["include"]))]),_:2},1024)]),_:1})}}}),ef={key:0,class:"layout-navbar"},tf={class:"menu-wrapper"},nf={class:"modal-content"},of={class:"modal-content-top"},sf={class:"modal-content-desc"},af={class:"modal-content-desc-b"},rf={class:"errorMessage xxxx"},cf={class:"modal-content-bot"},lf={class:"modal-content"},uf={class:"modal-content-top"},df={class:"modal-content-desc"},ff={class:"modal-content-desc-b"},pf={class:"errorMessage"},hf={class:"modal-content-bot"},mf={class:"modal-content-bot-i"},gf={class:"modal-content-bot-i"},vf={class:"modal-content"},_f={class:"modal-content-top"},bf={class:"modal-content-desc"},Cf={class:"modal-content-desc-b"},yf={class:"modal-content-bot"},If={class:"modal-content-bot-i"},Tf={class:"modal-content-bot-i"},wf={key:2,class:"upcoming-modal"};function yo(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Mo(e)}const Ef="ChatDB",Sf="60px",Mf=ae({__name:"default-layout",setup(e){const{requestPermission:t,notify:o}=Yd(),s=N(null),{t:a}=Ee.exports.useI18n(),{logout:l}=jo(),{addConversation:d,addMessage:m,getAllConversations:w,clearAll:_}=Ot(Ef),b=So(),S=N(!1),O=N(0),g=je(),I=Xe(),h=wo(),u=xt(),y=tt(),f=Eo(),D=N(!1),W=N(!1),ne=N(""),$e=N(""),K=N(!1),_e=N(0),de=N(!1),fe=N(!1),Ve=N(),ee=N(!1);let be,at;const pe=(n,r)=>{ne.value=n,$e.value=r};let x;const A=N(null);qd(!0);const Ae=G(()=>Ue()),R=G(()=>g.navbar),V=G(()=>g.menu&&!g.topMenu),He=G(()=>Ae.value?!1:g.hideMenu),Ce=G(()=>g.menuCollapse?48:g.menuWidth),mt=G(()=>g.menuCollapse),ke=G(()=>{const n=V.value&&!He.value?{paddingLeft:`${Ce.value}px`}:{},r=R.value?{paddingTop:Ae.value?0:Sf}:{};return{...n,...r}}),We=n=>{!S.value||g.updateSettings({menuCollapse:n})},Oe=N(!1),Re=()=>{Oe.value=!1};Ga("toggleDrawerMenu",()=>{Oe.value=!Oe.value});const Ne=(n,r,C)=>{o({title:n,body:r,icon:C})},he=N(!1),rt=()=>{he.value=!0},gt=()=>{he.value=!1},it=async()=>{var C;console.log("\u5237\u65B0\u4E1A\u52A1\u7CFB\u7EDFtoken-----------");const n=$t(),r=await I.userResetLogin({refresh_token:n});if(r.code!==200&&r.code!==401){F.error(r.msg);return}if(r.code===10909&&!D.value){pe(a("error.logout.title1"),a("error.logout.tips2")),D.value=!0;return}Wn(r.data.tokenType),qn(r.data.token),zn(r.data.refreshToken),x==null||x.refreshToken({token:r.data.token}),(C=A.value)==null||C.refreshToken({token:r.data.token})},qe=async()=>{D.value=!1,W.value=!1,await l(),_()},vt=()=>{K.value=!1,de.value=!1},_t=()=>{K.value=!1};let ze;const te=n=>{A.value.sendAssistInviteeTimeoutEvent({meetingNo:n.meetingNo,invitor:n.invitor}),f.updateAnswerInfo(null),f.updateAnswerVisible(!1)},ct=n=>{if(f.answerInfo&&f.answerInfo.meetingNo||A.value&&A.value.meetingInfo&&A.value.meetingInfo.meetingNo){console.log("\u63A5\u6536\u5230\u88AB\u9080\u8BF7\u4E1A\u52A1-\u5DF2\u7ECF\u5728\u88AB\u547C\u53EB\u4E2D",n),A.value.sendAssistInviteeBusyEvent({meetingNo:n.meetingNo,invitor:n.invitor});return}const r=b.filterMemberInfoByUserId(n.invitor);f.updateAnswerInfo({...r,meetingNo:n.meetingNo}),f.updateAnswerVisible(!0),ze=setTimeout(()=>{te(n)},1e3*f.answerTimeoutTime),Ne(a("notification.title"),a("notification.assist.title"),f.answerInfo.avatarUrl)},me=()=>{ze&&clearTimeout(ze)},Zt=async n=>{const r=await b.filterMemberInfoByUserId(n.invitee);console.log("\u88AB\u9080\u8BF7\u4EBA\u5FD9\u788C\u4E2D-",r,r==null?void 0:r.name,n),r?F.warning(`${r.name} ${a("meeting.invite.line.msg1")}`):F.warning(`${n.invitee} ${a("meeting.invite.line.msg1")}`)},Yt=n=>{console.log("\u88AB\u9080\u8BF7\u4EBA\u8D85\u65F6\u672A\u63A5\u542C-",n);const r=b.filterMemberInfoByUserId(n.invitee);r?F.warning(`${r.name} ${a("meeting.invite.line.msg2")}`):F.warning(`${n.invitee} ${a("meeting.invite.line.msg2")}`)},Xt=()=>{F.warning(`${a("meeting.answer.msg1")}`),me(),f.updateAnswerInfo(null),f.updateAnswerVisible(!1)},en=()=>{F.warning(`${a("meeting.answer.msg2")}`),me(),f.updateAnswerInfo(null),f.updateAnswerVisible(!1)},tn=n=>{f.answerVisible&&n.meetingNo===f.answerInfo.meetingNo&&(F.warning(a("meeting.message.over")),f.updateAnswerInfo(null),f.updateAnswerVisible(!1))},cs=()=>{fe.value=!0},nn=n=>{fe.value=!1,u.notificationId&&Ie.remove(u.notificationId),n||localStorage.removeItem("meetingInfo")},ls=async()=>{var r;nn(!0);const n=await A.value.agreeJoinMeeting({meetingNo:f.forceEntryMeetingInfo.meetingNo,invitor:f.forceEntryMeetingInfo.userId,forceEntryStatus:1});if(n.code!==200&&n.code!==401){F.error(n.msg);return}re.updateRoomTranslateInfo({...re.roomTranslateInfo,...n.data,open:!!((r=n.data)!=null&&r.enableTranslation)}),A.value.setRoomOnlineListPsn(b.memberList),A.value.setRoomOnlineGroupPsn(b.memberGroupList),f.updateAnswerVisible(!1),f.updateAnswerInfo(null),f.updateForceEntryMeetingInfo(null),f.updateAssistVisible(!0)},on=()=>{me(),cs()},sn=n=>{f.addUpcomingMeetingList(n),f.updateUpcomingMeetingInfo(n),f.updateUpcomingMeetingVisible(!0)},an=async()=>{if(f.answerInfo&&f.answerInfo.meetingNo){F.error(a("meeting.call.message.tips"));return}const n=f.upcomingMeetingInfo,r=b.filterMemberInfoByUserId(n.master);f.updateRoomOptions({meetingName:n==null?void 0:n.subject,meetingNo:n==null?void 0:n.meetingNo,organizer:r==null?void 0:r.name,cloudRecord:(n==null?void 0:n.recordStatus)===1,abstract:(n==null?void 0:n.aiStatus)===1,escaping:n.escaping===1,video:!1,audio:!0,loudspeaker:!0}),ee.value=!0,Ve.value&&Ve.value.handleClose()},bt=()=>{ee.value=!1},Ct=async n=>{var C,k,X,Q;const r=await A.value.joinMeeting({meetingNo:n.meetingNo,forceEntryStatus:0,inviters:[]});if(r.code!==200&&r.code!==401){r.code===Pe.OTHER_CLIENT_JOINED_MEETING||r.code===Pe.OTHER_CLIENT_IN_MEETING?(f.updateForceEntryMeetingInfo({meetingNo:n.meetingNo,invitor:[]}),re.updateRoomTranslateInfo({...re.roomTranslateInfo,...r.data,open:!!((C=r.data)!=null&&C.enableTranslation)}),c.emit("Chat-Other-Client-Joined-Meeting")):F.error(r.msg);return}A.value.roomMenuOptions={video:(k=f.roomOptions)==null?void 0:k.video,audio:(X=f.roomOptions)==null?void 0:X.audio,loudspeaker:(Q=f.roomOptions)==null?void 0:Q.loudspeaker},A.value.setRoomOnlineListPsn(b.memberList),A.value.setRoomOnlineGroupPsn(b.memberGroupList),ee.value&&bt(),ee.value&&bt(),f.updateAssistVisible(!0)},rn=()=>{c.emit("meeting-list-update")},yt=async n=>{if(console.log("\u6536\u5230 invitation-join-meeting \u4E8B\u4EF6\uFF0C\u6570\u636E:",n),n.meetingToken)try{const{joinMeeting:r}=await ga(()=>import("./invitation.becff913.js"),["assets/invitation.becff913.js","assets/index.9499b39e.js","assets/arco.638965b6.js","assets/chart.ffc0c533.js","assets/vue.125da600.js","assets/index.ee04fad8.css"]),C=await r({meetingToken:n.meetingToken});if(C.data.code===200){const k={meetingNo:C.data.data.meetingNo};await Ct(k)}else F.error(C.data.msg||"\u52A0\u5165\u4F1A\u8BAE\u5931\u8D25")}catch(r){console.error("\u52A0\u5165\u4F1A\u8BAE\u5931\u8D25:",r),F.error("\u52A0\u5165\u4F1A\u8BAE\u5931\u8D25")}else n.meetingNo&&await Ct(n)},re=da(),cn=n=>{n.reason===8&&(s.value=Co,pe(a("error.logout.tips3"),a("error.logout.tips6")),D.value=!0),re.updateRoomMenuOptionsVideo(!1),j.emit("th-self-menu-camera-close")},us=async()=>{var r,C,k;const n=localStorage.getItem("meetingInfo");if(n){const X=JSON.parse(n),Q=await A.value.joinMeeting({meetingNo:X.meetingNo,forceEntryStatus:0,inviters:[]});if(Q.code!==200&&Q.code!==401){Q.code===Pe.OTHER_CLIENT_JOINED_MEETING||Q.code===Pe.OTHER_CLIENT_IN_MEETING?(f.updateForceEntryMeetingInfo({meetingNo:X.meetingNo,invitor:[]}),c.emit("Chat-Other-Client-Joined-Meeting")):(Ie.remove(u.notificationId),localStorage.removeItem("meetingInfo"),j.emit("th-assist-closed"));return}A.value.roomMenuOptions={video:(r=f.roomOptions)==null?void 0:r.video,audio:(C=f.roomOptions)==null?void 0:C.audio,loudspeaker:(k=f.roomOptions)==null?void 0:k.loudspeaker},A.value.setRoomOnlineListPsn(b.memberList),A.value.setRoomOnlineGroupPsn(b.memberGroupList),A.value.sendAssistMeetingStatusSyncEvent({meetingNo:X.meetingNo})}},ds=async()=>{var r,C,k,X,Q,ge,ie;const n=localStorage.getItem("meetingInfo");if(n){const Z=JSON.parse(n),se=await A.value.joinMeeting({meetingNo:Z.meetingNo,forceEntryStatus:0,inviters:[]});if(se.code!==200&&se.code!==401){se.code===Pe.OTHER_CLIENT_JOINED_MEETING||se.code===Pe.OTHER_CLIENT_IN_MEETING?(f.updateForceEntryMeetingInfo({meetingNo:Z.meetingNo,invitor:[]}),c.emit("Chat-Other-Client-Joined-Meeting"),re.updateRoomTranslateInfo({...re.roomTranslateInfo,...Z,open:!!((r=se.data)!=null&&r.enableTranslation)})):(F.error(se.msg),Ie.remove(u.notificationId),localStorage.removeItem("meetingInfo"));return}re.updateRoomTranslateInfo({...re.roomTranslateInfo,languageType:(C=se.data)==null?void 0:C.languageType,industryType:(k=se.data)==null?void 0:k.industryType,...se.data,open:!!((X=se.data)!=null&&X.enableTranslation)}),A.value.roomMenuOptions={video:(Q=f.roomOptions)==null?void 0:Q.video,audio:(ge=f.roomOptions)==null?void 0:ge.audio,loudspeaker:(ie=f.roomOptions)==null?void 0:ie.loudspeaker},A.value.setRoomOnlineListPsn(b.memberList),A.value.setRoomOnlineGroupPsn(b.memberGroupList),Ie.remove(u.notificationId),f.updateAssistVisible(!0)}},fs=()=>{if(f.assistVisible){us();return}u.updateNotificationId(`${Date.now()}`);const n=localStorage.getItem("meetingInfo");if(n){const r=JSON.parse(n);Ie.info({id:u.notificationId,title:a("notification.assist.join.hint"),content:`${a("notification.assist.join.title")} ${r.subject}, ${a("notification.assist.join.title1")}`,duration:0,footer:()=>{let C,k;return p(Ao,null,{default:()=>[p(De,{type:"secondary",size:"small",onClick:()=>{localStorage.removeItem("meetingInfo"),Ie.remove(u.notificationId)}},yo(C=a("notification.assist.join.label1"))?C:{default:()=>[C]}),p(De,{type:"primary",size:"small",onClick:ds},yo(k=a("notification.assist.join.label2"))?k:{default:()=>[k]})]})}})}},ln=async()=>{const n=await b.getContactsData();return n.code!==200&&n.code!==401||b.addMemberList(n.data),n},un=async()=>{const n=await b.getContactsGroupData();return n.code!==200&&n.code!==401||b.addGroupMemberList(n.data),n},ps=async n=>{const r=await h.getChatMessageList(n);return r.code!==200&&r.code!==401||(console.log("\u52A0\u8F7D\u6B21\u8981\u6570\u636E--\u6700\u8FD1\u6D88\u606F-res",r),r.data&&r.data.length>0&&r.data.forEach(async C=>{if(C.chatType===J.GROUP_CHAT){const k={...C,parentId:`${C.chatType}_${n.groupId}`};await m(k,!1)}else{const k={...C,parentId:`${C.chatType}_${n.userId}`};await m(k,!1)}})),r},hs=async()=>{const n=await h.getChatConversationList();if(n.code!==200&&n.code!==401)return n;if(console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E--\u4F1A\u8BDD\u5217\u8868-api-res",n),n.data&&n.data.length>0){await n.data.forEach(async C=>{await d({...C,conversationId:`${C.chatType}_${C.targetId}`,status:1}),await ps({userId:C.targetId,pageNo:1,pageSize:C.unreadCount?C.unreadCount:10})});const r=await w();console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E--\u4F1A\u8BDD\u5217\u8868-db-conversationList",r),h.updateConversationList(r)}return n},ms=async()=>{const n={groupId:"",userId:""},r=await h.getChatOffLineMessageList(n);return r.code!==200&&r.code!==401||(console.log("\u52A0\u8F7D\u6B21\u8981\u6570\u636E--\u79BB\u7EBF\u6D88\u606F-res",r),r.data&&r.data.length>0&&await r.data.forEach(async C=>{const k={...C,parentId:`${C.chatType}_${C.chatType===J.GROUP_CHAT?C.recipientId:C.senderId}`};await m(k,!0)})),r},dn=()=>{console.log("\u8FDC\u7A0B\u534F\u52A9-Websocket\u8FDE\u63A5\u6253\u5F00:Th-im-open-success"),A.value.login()},fn=n=>{console.log("\u8FDC\u7A0B\u534F\u52A9Websocket\u767B\u5F55\u6210\u529F:Th-login-success",n.lastLoginTime),u.updateSocketStatus(3);const r=localStorage.getItem("meetingInfo");r&&(JSON.parse(r).selfUserId===I.userId?fs():localStorage.removeItem("meetingInfo"))},pn=n=>{console.log("Socket\u5F02\u5E38\u8FDE\u63A5\u5173\u95ED\u89E6\u53D1-\u91CD\u65B0\u8FDE\u63A5\u4E2D-layout...",n),_e.value=n.retryCount,_e.value===0&&(K.value=!0)},hn=n=>{K.value&&(K.value=!1),console.log("Socket\u5F02\u5E38\u8FDE\u63A5\u5173\u95ED-\u4E1A\u52A1\u903B\u8F91",n),de.value=!0,x==null||x.logout()},gs=()=>{de.value=!1,x.chatWssReconnect()},vs=()=>{j.on("ThAssistImWsOpen",dn),j.on("ThAssistLoginSuccess",fn),j.on("ThAssistInvited",ct),j.on("ThAssistInviteeBeBusy",Zt),j.on("ThAssistInviteeBeTimeout",Yt),j.on("ThAssistOtherClientAccepted",Xt),j.on("ThAssistOtherClientRejected",en),j.on("ThAssistClosed",tn),j.on("ThAssistAboutToBegin",sn),j.on("ThAssistPlanStatusUpdated",rn),j.on("ThAssistKickOut",cn)},_s=()=>{j.off("ThAssistImWsOpen",dn),j.off("ThAssistLoginSuccess",fn),j.off("ThAssistInvited",ct),j.off("ThAssistInviteeBeBusy",Zt),j.off("ThAssistInviteeBeTimeout",Yt),j.off("ThAssistOtherClientAccepted",Xt),j.off("ThAssistOtherClientRejected",en),j.off("ThAssistClosed",tn),j.off("ThAssistAboutToBegin",sn),j.off("ThAssistPlanStatusUpdated",rn),j.off("ThAssistKickOut",cn)};fa();const bs=async()=>{let n="";Ue()?n=`wss://${lt()}/socket`:n=`wss://${lt()}/socket`,A.value=new va({wssUrl:n,userId:I.userId,token:Mt()}),f.updateThImEvent(A.value),A.value.initWss(),vs()},mn=()=>{console.log("\u5373\u65F6\u901A\u8BAF-websocket-\u8FDE\u63A5\u6253\u5F00:handleChatWsOpen"),u.updateSocketStatus(2),x.login()},gn=async n=>{await be(),u.updateLastLoginTime(n.lastLoginTime),vt(),bs()},vn=n=>{console.log("\u63A5\u6536\u5230\u767B\u51FA\u6210\u529F\u4E8B\u4EF6-\u4E1A\u52A1\u903B\u8F91",n)},_n=n=>{D.value||(console.log("\u63A5\u6536\u5230\u88AB\u8E22\u4E0B\u7EBF\u4E8B\u4EF6-\u4E1A\u52A1\u903B\u8F91",n,Jn.DUPLICATE_LOGIN),n.reason===Jn.DUPLICATE_LOGIN?(s.value=Co,pe(a("error.logout.tips3"),a("error.logout.tips3")),W.value=!0):(pe(a("error.logout.title"),a("error.logout.tips5")),W.value=!0),D.value=!0,x==null||x.logout())},bn=()=>{u.updateSocketStatus(1)},Cn=async n=>{await d({conversationId:`${n.chatType}_${n.targetId}`,...n,status:1,unreadCount:0});const r=`${n.chatType}_${n.chatType===J.GROUP_CHAT?n.targetId:n.senderId}`;await m({chatType:n.chatType,recipientId:n.targetId,content:n.content,fingerPrint:n.fp,messageType:n.messageType,sendTime:n.sendTime,senderId:ve.SERVER,parentId:r,status:0,name:"",avatarUrl:""},!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==r);const C=await w();h.updateConversationList(C)},yn=async n=>{console.log("\u7FA4\u7EC4\u4FE1\u606F\u66F4\u65B0\u4E8B\u4EF6",n,h.conversationList);const r=h.conversationList.find(C=>C.conversationId===`${J.GROUP_CHAT}_${n.groupId}`);console.log("\u7FA4\u7EC4\u4FE1\u606F\u66F4\u65B0\u4E8B\u4EF6-conversation",r),h.updateConversations({...r,targetAvatarUrl:n.avatarUrl,targetName:n.groupName}),c.emit("group-info-change")},Cs=async n=>{const r=await b.filterMemberInfoByUserId(n.senderId);Ne(a("notification.title"),n.content,r==null?void 0:r.avatarUrl)},In=async n=>{let r;if(n.chatType===J.GROUP_CHAT)console.log("\u63A5\u6536\u804A\u5929\u4FE1\u606F-\u7FA4\u804A",n),r={...n,parentId:`${n.chatType}_${n.recipientId}`};else if(n.chatType===J.PRIVATE_CHAT){console.log("\u63A5\u6536\u804A\u5929\u4FE1\u606F-\u5355\u804A");const k=await b.filterMemberInfoByUserId(n.senderId);r={...n,parentId:`${n.chatType}_${n.senderId}`,sendId:n.senderId,name:k==null?void 0:k.name,avatarUrl:k==null?void 0:k.avatarUrl}}m(r,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==r.parentId);const C=await w();h.updateConversationList(C),c.emit("group-info-change"),Cs(n)},Tn=n=>{b.updateMemberStatus(n,!0)},wn=n=>{b.updateMemberStatus(n,!1)},En=()=>{ln(),un()},Sn=n=>{console.log("\u7FA4\u6210\u5458\u8E22\u51FA\u4E8B\u4EF6-handleChatGroupMemberRemoved",n),m(n,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==n.parentId),c.emit("group-info-change",n)},Mn=async n=>{console.log("\u7FA4\u6210\u5458\u9080\u8BF7\u4E8B\u4EF6\uFF1AhandleChatGroupMemberInvited",n),await m(n,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==n.parentId),c.emit("group-info-change",n)},$n=n=>{console.log("\u7FA4\u4E3B\u53D8\u66F4\u4E8B\u4EF6\uFF1AhandleChatGroupMasterChanged",n),m(n,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==n.parentId),c.emit("group-info-change",n)},An=n=>{console.log("\u7FA4\u5931\u6548\u4E8B\u4EF6\uFF1AhandleChatGroupDisbanded",n),m(n,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==n.parentId),c.emit("group-info-change",n)},kn=n=>{m(n,!h.curConversation||!h.curConversation.conversationId||h.curConversation.conversationId!==n.parentId),c.emit("group-info-change",n)},On=n=>{x.sendAckMessage(n)},Rn=n=>{console.log("\u53D1\u9001\u804A\u5929\u6D88\u606F",n),x.sendMessage(n)},Nn=n=>{x.sendChatReceivedMessageReadEvent({targetId:n.targetId,chatType:n.chatType})},Ln=()=>{u.updateSocketStatus(1)},It=()=>{u.notificationId&&Ie.remove(u.notificationId)},ys=async()=>{c.on("ChatWsOpen",mn),c.on("ChatLoginSuccess",gn),c.on("ChatWsClose",Ln),c.on("im-ws-reconnect-start",pn),c.on("im-ws-reconnect-failed",hn),c.on("ChatWsError",bn),c.on("ChatTokenExpirationDate",it),c.on("ChatLogoutSucceed",vn),c.on("ChatKickOut",_n),c.on("GroupCreatedEvent",Cn),c.on("GroupChatGroupInfoUpdated",yn),c.on("ChatImSendAckMessage",On),c.on("ChatSendMessage",Rn),c.on("ChatConversationRead",Nn),c.on("ChatMessageReceive",In),c.on("ChatGroupMemberRemoved",Sn),c.on("ChatGroupMemberInvited",Mn),c.on("ChatGroupMasterChanged",$n),c.on("ChatGroupDisbanded",An),c.on("ChatGroupMemberQuit",kn),c.on("ChatUserOnline",Tn),c.on("ChatUserOffline",wn),c.on("ChatContactUpdated",En),c.on("Chat-answer-agree",me),c.on("Chat-answer-hangup",me),c.on("Chat-Other-Client-Joined-Meeting",on),c.on("Chat-upcoming-meeting-join",an),c.on("navbar-show-ar-login-qr-code",rt),c.on("meeting-notification-close",It)},Is=async()=>{c.off("ChatWsOpen",mn),c.off("ChatLoginSuccess",gn),c.off("ChatWsClose",Ln),c.off("im-ws-reconnect-start",pn),c.off("im-ws-reconnect-failed",hn),c.off("ChatWsError",bn),c.off("ChatTokenExpirationDate",it),c.off("ChatLogoutSucceed",vn),c.off("ChatKickOut",_n),c.off("GroupCreatedEvent",Cn),c.off("GroupChatGroupInfoUpdated",yn),c.off("ChatImSendAckMessage",On),c.off("ChatSendMessage",Rn),c.off("ChatConversationRead",Nn),c.off("ChatMessageReceive",In),c.off("ChatGroupMemberRemoved",Sn),c.off("ChatGroupMemberInvited",Mn),c.off("ChatGroupMasterChanged",$n),c.off("ChatGroupDisbanded",An),c.off("ChatGroupMemberQuit",kn),c.off("ChatUserOnline",Tn),c.off("ChatUserOffline",wn),c.off("ChatContactUpdated",En),c.off("Chat-answer-agree",me),c.off("Chat-answer-hangup",me),c.off("Chat-Other-Client-Joined-Meeting",on),c.off("Chat-upcoming-meeting-join",an),c.off("navbar-show-ar-login-qr-code",rt),c.off("meeting-notification-close",It),c.off("invitation-join-meeting",yt)},Ts=async()=>{console.log("\u5373\u65F6\u901A\u8BAF-\u521D\u59CB\u5316\u5EFA-websocket"),u.updateSocketStatus(2);let n="";Ue()?n=`wss://${lt()}/chat-socket`:n=`wss://${lt()}/chat-socket`,x=new Cr({wssUrl:n,userId:I.userId,token:Mt()}),x.initChatWss(),ys()},ws=()=>{be(),at()};be=async()=>{_s(),A.value&&await A.value.logout(),f.updateThImEvent(null)},at=()=>{Is(),x&&x.logout(),h.updateChatImEvent(null)};const Tt=()=>{window.open("/assist/#/NoPermission","_self")},wt=async()=>{if(u.updateSocketStatus(2),O.value+=1,O.value>3){if(pe(a("error.logout.title1"),a("error.logout.tips4")),D.value)return;D.value=!0;return}const[n,r]=await Promise.all([await ln(),await un()]);if(console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E-memberRes&groupListRes",n,r),n.code===403||r.code===403){Tt();return}if(n.code===200&&r.code===200){const C=await hs();console.log("\u52A0\u8F7D\u91CD\u8981\u6570\u636E-conversationRes",C),C.code===200?(await ms(),Ts(),O.value=0):wt()}else(n.code!==401||r.code!==401)&&wt()},Et=()=>{console.log("handleNetworkStatusChange",navigator.onLine),u.updateNetworkStatus(navigator.onLine),b.updateMemberStatus({client:ve.PC,userId:I.userId},navigator.onLine)},Pn=()=>{Et()},Un=()=>{Et()},Es=()=>{window.addEventListener("online",Pn),window.addEventListener("offline",Un)},Ss=()=>{window.removeEventListener("online",Pn),window.removeEventListener("offline",Un)},Dn=async()=>{var n;if(console.log(sessionStorage.getItem("refreshTokenStatus")),sessionStorage.getItem("refreshTokenStatus")!=="1"){sessionStorage.setItem("refreshTokenStatus","1");const r=await I.userResetLogin({refresh_token:$t()?$t():""});sessionStorage.setItem("refreshTokenStatus","0"),r.code===200?(Wn(r.data.tokenType),qn(r.data.token),zn(r.data.refreshToken),x&&A.value?(x==null||x.refreshToken({token:r.data.token}),(n=A.value)==null||n.refreshToken({token:r.data.token})):window.location.reload()):(Io(),y.push({path:"/login"}))}},xn=()=>{D.value||(pe(a("error.logout.title1"),a("error.logout.tips6")),D.value=!0)},Ms=()=>{c.on("sys-user-reset-login",Dn),c.on("sys-application-disabled",xn),c.on("sys-no-permission-access",Tt)},$s=()=>{c.off("sys-user-reset-login",Dn),c.off("sys-application-disabled",xn),c.off("sys-no-permission-access",Tt)};window.addEventListener("storage",n=>{if(window.location.hash.includes("#/invitation"))return;const C=N(Mt()),k=pa(),X=ha();n.key==="token"&&(k!==X?y.push({name:"login"}):(C.value=n.newValue,window.location.reload())),n.key==="ASSIST_APP"&&k!==X&&y.push({name:"login"})});async function As(){const n=await f.getLanguageList(),r=await f.getIndustryList();n.code===200&&r.code===200&&(f.updateLanguageList(n.data),f.updateIndustryList(r.data))}return et(async()=>{t(),Ms(),Et(),Es(),c.on("invitation-join-meeting",yt),console.log("\u5DF2\u6CE8\u518C invitation-join-meeting \u4E8B\u4EF6\u76D1\u542C\u5668"),S.value||(console.log("\u9996\u6B21\u52A0\u8F7D\u91CD\u8981\u6570\u636E"),await _(),await wt()),S.value=!0,As()}),dt(()=>{$s(),ws(),It(),Ss(),c.off("invitation-join-meeting",yt),O.value=0,S.value=!1,W.value=!1}),ma(),(n,r)=>{const C=Fa,k=Va,X=Ha,Q=Wa,ge=De,ie=No;return E(),B(Q,{class:Bt({layout:!0,mobile:M(g).hideMenu,"remote-micro-app-layout":Ae.value})},{default:v(()=>[R.value&&!Ae.value?(E(),H("div",ef,[p(zu)])):z("",!0),p(Q,null,{default:v(()=>[p(Q,null,{default:v(()=>[V.value?Lo((E(),B(C,{key:0,class:"layout-sider",breakpoint:"xl",collapsed:mt.value,collapsible:!0,width:Ce.value,style:Kn({paddingTop:R.value?"60px":""}),"hide-trigger":!0,onCollapse:We},{default:v(()=>[i("div",tf,[p(Dt)])]),_:1},8,["collapsed","width","style"])),[[Po,!He.value]]):z("",!0),He.value?(E(),B(k,{key:1,visible:Oe.value,placement:"left",footer:!1,"mask-closable":"",closable:!1,onCancel:Re},{default:v(()=>[p(Dt)]),_:1},8,["visible"])):z("",!0),p(Q,{class:"layout-content",style:Kn(ke.value)},{default:v(()=>[M(g).tabBar?(E(),B(ud,{key:0})):z("",!0),p(X,null,{default:v(()=>[p(Xd)]),_:1})]),_:1},8,["style"])]),_:1})]),_:1}),p(ie,{visible:D.value,"onUpdate:visible":r[0]||(r[0]=Z=>D.value=Z),closable:!1,"esc-to-close":!1,"hide-cancel":!0,"mask-closable":!1,footer:!1},{default:v(()=>[i("div",nf,[i("div",of,[(E(),B(Ke(M(vr))))]),i("div",sf,[i("div",af,[i("span",null,$(ne.value),1)])]),i("div",rf,$($e.value),1),i("div",cf,[p(ge,{type:"primary",onClick:qe},{default:v(()=>[oe($(n.$t("error.logout.btn.label1")),1)]),_:1})])])]),_:1},8,["visible"]),p(ie,{visible:K.value,"onUpdate:visible":r[1]||(r[1]=Z=>K.value=Z),"modal-class":"custom-modal",width:"398px",closable:!1,"esc-to-close":!1,"hide-cancel":!0,"mask-closable":!1,footer:!1},{default:v(()=>[i("div",lf,[i("div",uf,[(E(),B(Ke(M(rr))))]),i("div",df,[i("div",ff,[i("span",null,$(n.$t("error.logout.tip10")),1)])]),i("div",pf,$(n.$t("error.logout.tip9"))+" ("+$(_e.value)+"/30)",1),i("div",hf,[i("div",mf,[p(ge,{type:"outline",onClick:_t},{default:v(()=>[oe($(n.$t("error.logout.btn.label2")),1)]),_:1})]),i("div",gf,[p(ge,{type:"primary",onClick:qe},{default:v(()=>[oe($(n.$t("error.logout.btn.label3")),1)]),_:1})])])])]),_:1},8,["visible"]),p(ie,{visible:de.value,"onUpdate:visible":r[2]||(r[2]=Z=>de.value=Z),"modal-class":"custom-modal",width:"398px",closable:!1,"esc-to-close":!1,"hide-cancel":!0,"mask-closable":!1,footer:!1},{default:v(()=>[i("div",vf,[i("div",_f,[(E(),B(Ke(M(dr))))]),i("div",bf,[i("div",Cf,[i("span",null,$(n.$t("error.logout.tip11")),1)])]),i("div",yf,[i("div",If,[p(ge,{type:"outline",onClick:gs},{default:v(()=>[oe($(n.$t("error.logout.btn.label4")),1)]),_:1})]),i("div",Tf,[p(ge,{type:"primary",onClick:qe},{default:v(()=>[oe($(n.$t("error.logout.btn.label3")),1)]),_:1})])])])]),_:1},8,["visible"]),fe.value?(E(),B(ie,{key:1,visible:fe.value,"onUpdate:visible":r[3]||(r[3]=Z=>fe.value=Z),footer:!1,closable:!1,class:"customModal"},{default:v(()=>[fe.value?(E(),B(_d,{key:0,onHandleClose:nn,onHandleJoinMeeting:ls})):z("",!0)]),_:1},8,["visible"])):z("",!0),M(f).upcomingMeetingVisible?(E(),H("div",wf,[M(f).upcomingMeetingVisible?(E(),B(Rd,{key:0,ref_key:"upcomingModalRef",ref:Ve},null,512)):z("",!0)])):z("",!0),ee.value?(E(),B(ie,{key:3,visible:ee.value,"onUpdate:visible":r[4]||(r[4]=Z=>ee.value=Z),footer:!1,closable:!1,class:"customModal"},{default:v(()=>[ee.value?(E(),B(Xa,{key:0,onHandleClose:bt,onHandleJoinMeeting:Ct})):z("",!0)]),_:1},8,["visible"])):z("",!0),he.value?(E(),B(ie,{key:4,visible:he.value,"onUpdate:visible":r[5]||(r[5]=Z=>he.value=Z),footer:!1,closable:!1,class:"customModal"},{default:v(()=>[he.value?(E(),B(Gd,{key:0,onHandleClose:gt})):z("",!0)]),_:1},8,["visible"])):z("",!0)]),_:1},8,["class"])}}});const xf=ce(Mf,[["__scopeId","data-v-04ba5360"]]);export{xf as default};
